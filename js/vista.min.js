function getUrlVars(e) {
    for (var t, i = [], a = window.location.href.slice(window.location.href.indexOf("?") + 1).split("&"), o = 0; o < a.length; o++)
        t = a[o].split("="), e ? (i.push(t[0].toLowerCase()), i[t[0].toLowerCase()] = t[1]) : (i.push(t[0]), i[t[0]] = t[1]);
    return i
}
function hideTooltipster(e) {
    e.inUpdate ? setTimeout(function() {
        hideTooltipster(e)
    }, 200) : e.tooltipster("hide")
}
botb = window.botb || {}, botb.mainScript = window.botb.mainScript || {}, botb.app = angular.module("botb", ["ngSanitize", "angular.filter", "pretty-checkable", "MassAutoComplete", "angular-clear-button", "infinite-scroll", "angular.chosen", "ngCookies"]), function(e) {
    e.Notify = function(t) {
        var i = e.extend({
                container: e("#notifications"),
                etype: "info",
                colour: "red",
                message: 'Sorry, it looks like we\'ve had some problems on this page. Please try again or <a href="/contact-us">get in touch.</a>'
            }, t),
            a = 5e3;
        switch (i.etype) {
        case "success":
            i.message = "Your ticket(s) has been added to the basket successfully.";
            break;
        case "persistenterror":
            a = 3e5;
            break;
        case "persistentcookie":
            a = 0
        }
        "persistentcookie" === i.etype ? e(i.container).append(e("<div />").addClass("notification__box notification__box--" + i.etype).append(e('<div class="notification__message" />').append(i.message).append(e('<button class="button persistentcookie-button-close" />').text("OK, GOT IT").click(function() {
            e(this).closest(".notification__box").dequeue(), botb.cookie.setCookie("cookiepolicy", "true", 365), e(this).closest(".notification__box").slideUp("fast", function() {
                e(this).remove()
            })
        })))) : e(i.container).append(e("<div />").addClass("notification__box notification__box--" + i.etype).append(e('<div class="notification__message" />').append(i.message).append(e('<button class="button button--close" />').text("Close").click(function() {
            e(this).closest(".notification__box").dequeue(), e(this).closest(".notification__box").slideUp("fast", function() {
                e(this).remove()
            })
        })))), a > 0 && e(i.container).find(".notification__box--" + i.etype).delay(a).slideUp(400, function() {
            e(i.container).removeClass("active")
        }), "red" == i.colour && e(".notification__message").show(), e("header").hasClass("hidden") && e("header").addClass("fixed visible").removeClass("hidden"), e(".sticky-filter-wrapper").hide()
    }, e.Notify.clear = function() {
        e("#notifications").html("")
    }
}(jQuery), botb.video = {
    remove: function(e) {
        var t = $(e).parent(),
            i = $(t).find("iframe[src*=youtube], video");
        i.length && (i.remove(), $(t).find(".play-button").show(), $(".caption").show(), e.hide())
    },
    play: function(e) {
        var t = $(e).closest(".winner-video"),
            i = t.find("iframe[src*=youtube], video");
        i.length > 0 && i.remove();
        var a = $(e).closest(".slider-container"),
            o = "true" == $(e).attr("data-iskiosk").toLowerCase(),
            i = $(e).attr("data-video"),
            r = botb.video.createPlayer(o, i);
        "true" == $(e).attr("data-isbanner").toLowerCase();
        $(".caption").show(), $(t).find(".play-button").hide(), $(t).append(r), $(a).find(".video-close").show(), $(t).find(".video-close").show()
    },
    createPlayer: function(e, t) {
        return e ? $('<video class="bvideo native" controls autoplay><source src="' + t + '" type="video/mp4">Your browser does not support the video tag.</video>') : $('<iframe class="bvideo youtube" src="https://www.youtube.com/embed/' + t + '?autoplay=1&enablejsapi=1" frameborder="0" allowfullscreen></iframe>')
    }
}, botb.videoPopup = {
    remove: function(e) {
        var t = $(".video-popup");
        $(t).hide().remove()
    },
    play: function(e) {
        var t = $(".video-popup");
        t.length > 0 && botb.videoPopup.remove();
        var i = $(e).attr("data-video"),
            a = $(e).attr("data-iskiosk");
        a = "True" == a || "true" == a;
        var o = botb.videoPopup.createPlayer(i, a);
        $("body").append(o)
    },
    createPlayer: function(e, t) {
        if (t) {
            var i = '<video width="100%" controls><source src="' + e + '" type="video/mp4">Your browser does not support the video tag</video>';
            return $('<div class="video-popup"><div class="video-container"><div class="close" onclick="botb.videoPopup.remove()" title="close">CLOSE</div>' + i + "</div></div>")
        }
        return $('<div class="video-popup"><div class="video-container"><div class="close" onclick="botb.videoPopup.remove()" title="close">CLOSE</div><iframe class="bvideo youtube" src="https://www.youtube.com/embed/' + e + '?autoplay=1&enablejsapi=1" frameborder="0" allowfullscreen></iframe></div></div>')
    }
}, botb.videoInElement = {
    remove: function(e) {
        var t = $(".video-in-element");
        $(t).hide().remove()
    },
    play: function(e, t, i) {
        var a = $(".video-in-element");
        a.length > 0 && botb.videoInElement.remove();
        var o = $(e).attr("data-video"),
            r = botb.videoInElement.createPlayer(o, i);
        $(t).append(r)
    },
    createPlayer: function(e, t) {
        return void 0 != t ? $('<div class="video-in-element" onclick="' + t + ' botb.videoInElement.remove();"><div class="video-container"><div class="close" onclick="' + t + 'botb.videoInElement.remove();" title="close">CLOSE</div><iframe class="bvideo youtube" src="https://www.youtube.com/embed/' + e + '?autoplay=1&enablejsapi=1" frameborder="0" allowfullscreen></iframe></div></div>') : $('<div class="video-in-element" onclick="botb.videoInElement.remove()"><div class="video-container"><div class="close" onclick="botb.videoInElement.remove()" title="close">CLOSE</div><iframe class="bvideo youtube" src="https://www.youtube.com/embed/' + e + '?autoplay=1&enablejsapi=1" frameborder="0" allowfullscreen></iframe></div></div>')
    }
}, botb.messagePopup = {
    show: function(e, t) {
        $(".botb-message-popup").remove();
        var i = botb.messagePopup.createPopup(e, t);
        $(i).insertBefore("body").find(".footer-trackers")
    },
    close: function() {
        $(".botb-message-popup").fadeOut("fast", function() {
            setTimeout(function() {
                $(".botb-message-popup").remove()
            }, 500)
        })
    },
    isShown: function() {
        return $(".botb-message-popup").is(":visible")
    },
    createPopup: function(e, t) {
        var i = "";
        void 0 !== t && null !== t && (i = t);
        var a = '<div class="botb-message-popup ' + i + '"> <div class="message-container">   <div class="close" onclick="botb.messagePopup.close()">CLOSE</div>   <div class="message">' + e + "</div> </div>";
        return $(a)
    }
}, botb.cookie = {
    setCookie: function(e, t, i) {
        var a = new Date;
        a.setTime(a.getTime() + 24 * i * 60 * 60 * 1e3);
        var o = "expires=" + a.toUTCString();
        document.cookie = e + "=" + t + "; " + o + "; Path=/ "
    },
    getCookie: function(e) {
        for (var t = e + "=", i = document.cookie.split(";"), a = 0; a < i.length; a++) {
            for (var o = i[a]; " " == o.charAt(0);)
                o = o.substring(1);
            if (0 == o.indexOf(t))
                return o.substring(t.length, o.length)
        }
        return ""
    },
    setCarPrizeCookie: function(e) {
        var t = botb.cookie.getCarPrizeCookie() || [],
            i = t.indexOf(e);
        i >= 0 && t.splice(i, 1), t.splice(20), t.unshift(e), botb.cookie.setCookie("BotB.RecentlyViewedPrizes", JSON.stringify(t), 365)
    },
    removeCarPrizeFromCookie: function(e, t) {
        return null == t ? t : (t.indexOf(e) >= 0 && t.splice(t.indexOf(e), 1), t)
    },
    getCarPrizeCookie: function() {
        var e = botb.cookie.getCookie("BotB.RecentlyViewedPrizes"),
            t = null;
        if (null != e)
            try {
                t = JSON.parse(e)
            } catch (i) {}
        return t
    }
}, botb.notification = {
    adjustPosition: function() {
        if ($("header").hasClass("visible")) {
            var e = $("header").height();
            $(".notifications").css("top", e + 1)
        } else
            $(".notifications").css("top", 0)
    }
}, $.fn.setCursorPosition = function(e) {
    return this.each(function(t, i) {
        if (i.setSelectionRange)
            i.setSelectionRange(e, e);
        else if (i.createTextRange) {
            var a = i.createTextRange();
            a.collapse(!0), a.moveEnd("character", e), a.moveStart("character", e), a.select()
        }
    }), this
};
var winnerSliderArray = [],
    homepageWinnerSlider = null,
    currentMaxSlideHomepageWinner = null,
    homepageCarCollectionSlider = null,
    currentMaxSlideCarCollection = null,
    navTimer = null,
    useMenuTimer = !1,
    wacFilterTimer = null,
    lastNavScrollTop = 0,
    lastFilterScrollTop = 0,
    plugins = {
        init: function() {
            plugins.eqHeight(), plugins.chbxInit(), plugins.chosenInit(), plugins.overlayInit(), plugins.winnerSlider(), plugins.carsCarousel(), plugins.tooltipInit(), plugins.videoSize(), plugins.scrollbar(), plugins.topNav(), plugins.stickyFilters(), plugins.kioskStickyStaffHeaders(), plugins.botbMultiSelect(), plugins.botbCustomDropdown()
        },
        loaded: function() {
            plugins.pinTooltips()
        },
        eqHeight: function() {
            $(".dashboard .tiles div.item").matchHeight(), $(".double form").matchHeight(), $(".faqs-new .item").matchHeight()
        },
        chbxInit: function() {
            $('input[type="checkbox"], input[type="radio"]').each(function() {
                var e = this;
                $(e).hasClass("no-pretty") || $(this).prettyCheckable()
            })
        },
        chosenInit: function() {
            $(".chosen-search").hide();
            var e = "ontouchstart" in window || window.DocumentTouch && document instanceof window.DocumentTouch || navigator.maxTouchPoints > 0 || window.navigator.msMaxTouchPoints > 0;
            e && $(".chosen-container .chosen-results").addClass("no-touch")
        },
        overlayInit: function() {
            $(".fancybox").fancybox({
                padding: 0,
                helpers: {
                    overlay: {
                        locked: !1
                    }
                }
            }), $(".fancybox-team, .fancybox-article").fancybox({
                padding: 0,
                wrapCSS: "members",
                helpers: {
                    overlay: {
                        locked: !1
                    }
                }
            })
        },
        winnerSlider: function() {
            var e = $(".winner-slider");
            0 != e.length && $(".winner-slider").each(function(e, t) {
                var i = this;
                if (!($(t).children().length <= 1)) {
                    var a = 4e3;
                    1 == $(i).closest(".car-details").length && (a = 8e3);
                    var o = $(t).bxSlider({
                        auto: !1,
                        autoDelay: 2e3,
                        pause: a,
                        touchEnabled: !0,
                        swipeThreshold: 50,
                        pager: !0,
                        controls: !0,
                        onSliderLoad: function() {},
                        onSlideAfter: function(e, t, i) {
                            var a = $(e).closest(".slider-container, .winner-slider-container").find(".video-close, .close");
                            botb.videoInElement.remove(a)
                        }
                    });
                    winnerSliderArray.push(o)
                }
            })
        },
        carsCarousel: function(e) {
            if (void 0 != e && !($(e).children().length <= 1)) {
                var t = {
                    minSlides: 1,
                    maxSlides: 4,
                    moveSlides: 1,
                    slideWidth: 240,
                    slideMargin: 50,
                    pager: !1,
                    controls: !0,
                    infiniteLoop: !1,
                    touchEnabled: !0,
                    swipeThreshold: 50
                };
                $(e).eq(0).bxSlider(t)
            }
        },
        tooltipInit: function() {
            $(".tooltip").tooltipster({
                position: "bottom",
                delay: 0
            }), $(".tooltip-top").tooltipster({
                position: "top",
                delay: 0,
                theme: "tooltip-cart"
            })
        },
        pinTooltips: function() {
            $(".qtipinfo").each(function() {
                var e = $(this),
                    t = e.position().left,
                    i = $(".pin-nest").width() / 2,
                    a = e.data("title");
                $(".qtipinfo").tooltipster({
                    theme: "tooltip-pin",
                    delay: 0,
                    content: $(a)
                }), t > i ? e.tooltipster("option", "position", "left") : e.tooltipster("option", "position", "right")
            })
        },
        videoSize: function() {
            $(".video").each(function() {
                var e = $(this);
                e.fitVids()
            })
        },
        scrollbar: function() {
            $(".mCustomScrollbar").mCustomScrollbar(), $(".cart div.scroll").mCustomScrollbar({
                axis: "y"
            }), $(".car-group").each(function() {
                var e = $(this);
                e.mCustomScrollbar({
                    axis: "y"
                })
            })
        },
        rangeSlider: function(e) {
            var t = $(".range-input");
            void 0 != e && (t = $(e).find(".range-input")), t.each(function() {
                var e = $(this),
                    t = e.data("from"),
                    i = e.data("to"),
                    a = e.data("step");
                e.attr("value", e.val()), $(e).jslider({
                    step: a,
                    from: t,
                    to: i,
                    onstatechange: function(t) {
                        $(e).val(t).change()
                    },
                    reset: function() {
                        $(e).jslider("value", this.from, this.to)
                    }
                })
            })
        },
        topNav: function() {
            $(document).mouseup(function(e) {
                var t = $("header");
                if (!t.is(e.target) && 0 === t.has(e.target).length) {
                    if (null != navTimer && (clearTimeout(navTimer), navTimer = null), !$(".menu-toggle").hasClass("active"))
                        return;
                    var i = $(".menu-toggle");
                    $(i).removeClass("active"), $(".icon-bar").removeClass("icon-bar-hover"), BOTBapp.showNavigation(!1)
                }
            }), $(window).scroll(function(e) {
                if (!$(".free-prize-container").is(":visible")) {
                    var t = $(this).scrollTop();
                    if (t <= 80)
                        $("header").removeClass("fixed hidden visible"), $(".faux-header").removeClass("active");
                    else if (t > lastNavScrollTop) {
                        var i = $("#TopMenuHeight").hasClass("active") || $(".user-details-header").hasClass("active") || $(".currency-menu").find(".currency-drop").is(":visible"),
                            a = $(".notifications").children().is(":visible");
                        i || a || t - 5 > lastNavScrollTop && ($("header").addClass("fixed hidden").removeClass("visible"), $(".faux-header").addClass("active"))
                    } else
                        t + 20 < lastNavScrollTop && $("header").addClass("fixed visible").removeClass("hidden");
                    lastNavScrollTop = t
                }
            })
        },
        stickyFilters: function() {
            var e = $(".sticky-filter-wrapper");
            0 !== e.length && setTimeout(function() {
                $(window).scroll(function(t) {
                    var i = $("header").height(),
                        a = $(".counter").height(),
                        o = $(".lifestyle-prize-category-tabs").height(),
                        r = $(".in-the-headlights-container.active").height(),
                        n = $(".lifestyle-prize-category-tabs"),
                        s = i + a - o,
                        l = a,
                        c = $(".notifications").children().is(":visible");
                    c ? $(e).hide() : $(e).show(), null !== r && (l = l + r - 100);
                    var d = $(this).scrollTop();
                    d <= s ? $(n).removeClass("sticky").attr("style", "") : d > lastFilterScrollTop ? d - 5 > lastFilterScrollTop && $(n).removeClass("sticky").attr("style", "") : d + 20 < lastFilterScrollTop && $(n).addClass("sticky").css("top", i), d <= l ? $(e).removeClass("sticky") : d > lastFilterScrollTop ? d - 5 > lastFilterScrollTop && $(e).removeClass("sticky") : d + 20 < lastFilterScrollTop && $(e).addClass("sticky").css("top", i + o), lastFilterScrollTop = d
                })
            }, 500)
        },
        kioskStickyStaffHeaders: function() {
            var e = $(".loggedInAsStyle");
            0 != e.length && $(window).scroll(function(t) {
                var i = $(this).scrollTop();
                i <= 80 ? $(e).removeClass("sticky") : $(e).addClass("sticky")
            })
        },
        botbMultiSelect: function() {
            $(".botb-multi-select-container").each(function() {
                var e = this,
                    t = $(window).width(),
                    i = $(e).find(".list-option-item").length,
                    a = 1;
                t >= 1100 ? a = 3 : t >= 767 && (a = 2);
                for (var o = Math.ceil(i / a), r = 0, n = '<div class="faux-block"></div>'; r < i;) {
                    var s = r + o;
                    $(e).find(".list-option-item").slice(r, s).wrapAll(n), r += o
                }
                var l = $(e).find(".faux-block").length;
                switch (l) {
                case 2:
                    $(e).find(".list-options-container").addClass("two-columns");
                    break;
                case 3:
                    $(e).find(".list-options-container").addClass("three-columns")
                }
                $(e).find(".list-option-item.all").find(".faux-checkbox").bind("cssClassChanged", function() {
                    var e = this,
                        t = $(e).closest(".botb-multi-select-container").find(".arrow"),
                        i = $(e).closest(".botb-multi-select-container").find(".remove");
                    $(e).hasClass("checked") ? ($(t).addClass("active"), $(i).removeClass("active")) : ($(t).addClass("active"), $(i).removeClass("active"))
                }), $(e).find(".default-item").click(function(t) {
                    var i = $(this).closest(".botb-multi-select-container"),
                        a = $(".botb-multi-select-container").not(e);
                    $(a).removeClass("active"), $(i).hasClass("active") ? $(i).removeClass("active") : $(i).addClass("active"), plugins.updateBotBMultiSelectPlaceholder(e)
                }), $(e).find(".list-options-container").find(".faux-checkbox").click(function(t) {
                    var i = this,
                        a = $(i).closest(".list-option-item.all").length > 0;
                    if ($(i).hasClass("checked") ? ($(i).removeClass("checked"), $(i).closest(".list-option-item").find(".checkbox-item").prop("checked", !1)) : ($(i).addClass("checked"), $(i).closest(".list-option-item").find(".checkbox-item").prop("checked", !0)), a) {
                        var o = $(i).closest(".list-option-item.all"),
                            r = $(e).find(".list-option-item").not(".all");
                        $(i).closest(".list-option-item").find(".checkbox-item").is(":checked") ? ($(o).find(".faux-checkbox").addClass("checked").trigger("cssClassChanged"), $(r).find(".faux-checkbox").removeClass("checked"), $(r).find(".checkbox-item").prop("checked", !1)) : ($(o).find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"), $(r).find(".faux-checkbox").addClass("checked"), $(r).find(".checkbox-item").prop("checked", !0))
                    } else if ($(i).hasClass("checked")) {
                        var n = $(e).find(".list-option-item.all");
                        $(n).find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"), $(n).find(".checkbox-item").prop("checked", !1)
                    }
                    plugins.updateBotBMultiSelectPlaceholder(e)
                }), $(e).find(".list-options-container").find(".checkbox-item").click(function(t) {
                    var i = this,
                        a = $(i).closest(".list-option-item").find(".faux-checkbox"),
                        o = $(i).closest(".list-option-item.all").length > 0;
                    if ($(a).hasClass("checked") ? $(a).removeClass("checked") : $(a).addClass("checked"), o) {
                        var r = $(i).closest(".list-option-item.all"),
                            n = $(e).find(".list-option-item").not(".all");
                        $(i).is(":checked") ? ($(r).find(".faux-checkbox").addClass("checked").trigger("cssClassChanged"), $(n).find(".faux-checkbox").removeClass("checked"), $(n).find(".checkbox-item").prop("checked", !1)) : ($(r).find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"), $(n).find(".faux-checkbox").addClass("checked"), $(n).find(".checkbox-item").prop("checked", !0))
                    } else if ($(i).is(":checked")) {
                        var s = $(e).find(".list-option-item.all");
                        $(s).find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"), $(s).find(".checkbox-item").prop("checked", !1)
                    }
                    plugins.updateBotBMultiSelectPlaceholder(e)
                }), $(e).find(".remove").click(function(e) {
                    var t = this;
                    $(t).closest(".botb-multi-select-container").find(".list-option-item.all").find(".checkbox-item").click()
                }), $(document).mouseup(function(e) {
                    var t = $(".botb-multi-select-container");
                    t.is(e.target) || 0 !== t.has(e.target).length || ($(t).removeClass("active"), null !== wacFilterTimer && (clearTimeout(wacFilterTimer), wacFilterTimer = null))
                }), $(e).mouseenter(function() {
                    null !== wacFilterTimer && (clearTimeout(wacFilterTimer), wacFilterTimer = null)
                }), $(e).mouseleave(function() {
                    $(e).hasClass("active") && (wacFilterTimer = setTimeout(function() {
                        $(e).find(".default-item").click(), clearTimeout(wacFilterTimer), wacFilterTimer = null
                    }, 500))
                });
                var c = $(e).find(".list-option-item.all");
                $(c).find(".faux-checkbox").addClass("checked").trigger("cssClassChanged"), $(c).find(".checkbox-item").prop("checked", !1), setTimeout(function() {
                    plugins.updateBotBMultiSelectPlaceholder(e)
                }, 600)
            }), $(".mobile-filter").each(function() {
                var e = this,
                    t = $(e).find("select");
                $(t).change(function(e) {
                    var t = this;
                    try {
                        var i = $(t).closest(".our-cars").length > 0;
                        if (i)
                            angular.element(document.getElementById("our-cars-controller-container")).scope().$apply();
                        else {
                            var a = $(".our-winners");
                            a.length > 0 && angular.element($(".our-winners").get(0)).scope().$apply()
                        }
                    } catch (o) {
                        alert(o)
                    }
                })
            })
        },
        updateBotBMultiSelectPlaceholder: function(e) {
            var t = $(e).closest(".botb-multi-select-container").find(".arrow"),
                i = $(e).closest(".botb-multi-select-container").find(".remove"),
                a = $(e).find(".default-item").find("span").attr("data-text"),
                o = $(e).find(".list-option-item:not(.all)").find(".checkbox-item:checked").length,
                r = 0 === o ? "" : a + " (" + o + ")";
            "" === r ? (r = "All " + a, $(t).addClass("active"), $(i).removeClass("active")) : ($(t).removeClass("active"), $(i).addClass("active")), $(e).find(".default-item").find("span").text(r)
        },
        botbCustomDropdown: function() {
            var e = $(".botb-custom-dropdown");
            if (0 !== e.length) {
                var t = '<img alt="" src="/assets/images/custom-dropdown-arrow.png" class="botb-custom-dropdown-arrow" />';
                $(e).each(function() {
                    var e = this,
                        i = $(e).find("option")[0],
                        a = "";
                    void 0 !== i && (a = i.text);
                    var o = '<span class="botb-custom-dropdown-faux-placeholder">{{label}}</span>';
                    o = o.replace("{{label}}", a), $(o).insertBefore(e), $(t).insertAfter(e), $(e).click(function(t) {
                        var i = $(e).next(".botb-custom-dropdown-arrow");
                        $(i).hasClass("active") ? $(i).removeClass("active") : $(i).addClass("active")
                    }), $(e).blur(function() {
                        var t = $(e).next(".botb-custom-dropdown-arrow");
                        $(t).hasClass("active") && $(t).removeClass("active")
                    })
                })
            }
        }
    },
    BOTBapp = {
        init: function() {
            BOTBapp.homePadding(), $(".cart-amount").on("click", function() {
                BOTBapp.showCart(!0)
            }), $(".cart-close").on("click", BOTBapp.hideCart), $(".tab-btn").on("click", BOTBapp.tabs), $(".method-btn").on("click", BOTBapp.methods), $(".accordion").delegate("h4", " click", BOTBapp.accordion), $(".menu-toggle").on("click", BOTBapp.toggleMenu);
            var e = navigator.userAgent.toLowerCase(),
                t = e.indexOf("android") > -1;
            t || ($(".menu-toggle").on("mouseenter", BOTBapp.openMenu), $(".menu-toggle").on("mouseleave", BOTBapp.closeMenu)), $("#TopMenuHeight").on("mouseenter", BOTBapp.openMenu), $("#TopMenuHeight").on("mouseleave", BOTBapp.closeMenu), $(".top-nav-heading-container").on("mouseenter", BOTBapp.openMenu), $(".top-nav-heading-container").on("mouseleave", BOTBapp.closeMenu), $(".drop-btn").on("click", BOTBapp.toggleDrop), $(".change").on("click", BOTBapp.quantity), $(".stats-btn").on("click", BOTBapp.showStats), $(".stats-close").on("click", BOTBapp.hideStats), $(".group-btn a").on("click", BOTBapp.showGroup), $(".add-form").delegate(".add-friend", "click", BOTBapp.addFriend), $(".faq-btn").on("click", BOTBapp.loadFaqs)
        },
        sizing: function() {
            BOTBapp.homePadding()
        },
        showNavigation: function(e) {
            e ? ($("nav").addClass("active"), $(".menu-toggle").addClass("active")) : ($("nav").removeClass("active"), $(".menu-toggle").removeClass("active")), BOTBapp.windowResize()
        },
        windowResize: function() {
            var e = $(window).width(),
                t = ($(window).height(), $(".cart"));
            if ($(t).is(":visible")) {
                var i = $("nav").width(),
                    e = $(window).width(),
                    a = 0;
                e > i && (a = (e - i) / 2, a -= 10), $(t).css("right", a)
            }
            if (e < 667 ? $(".banner-content .content").addClass("mobile") : $(".banner-content .content").removeClass("mobile"), e >= 755 ? BOTBapp.adjustTopNavWidth() : $(".top-nav-heading-container").removeClass("active"), e >= 1100 ? BOTBapp.fixTopNavSubMenuWidth() : BOTBapp.spreadTopNavSubMenuWidth(), $("#nav-burger").is(":visible")) {
                var o = $(".header-wrap").width(),
                    r = $(".header-wrap .right .user-menu").width(),
                    n = o - r;
                $(".header-wrap .alternate-cover-area").width(n).addClass("active")
            } else
                $(".header-wrap .alternate-cover-area").removeClass("active")
        },
        adjustTopNavWidth: function() {
            var e = $(".header-wrap").width(),
                t = $(".header-wrap .right").width(),
                i = 150,
                a = ($("nav .navigation__primary"), e - t - i);
            $(".top-nav-heading-container").width(a).addClass("active"), $(".top-nav-heading-container").css("max-width", a)
        },
        fixTopNavSubMenuWidth: function() {
            var e = $(".header-wrap").width(),
                t = $(".header-wrap .right").width(),
                i = 150,
                a = $("nav .navigation__primary"),
                o = e - t - i;
            $(a).attr("style", "").css("max-width", o)
        },
        spreadTopNavSubMenuWidth: function() {
            var e = $("nav .navigation__primary");
            $(e).attr("style", "").css("max-width", "100%").css("margin-left", "auto").css("margin-right", "auto")
        },
        hideCurrencyMenu: function() {
            var e = $(".currency-menu > li > .user-btn > a");
            $(".currency-drop").slideUp(400, "easeOutExpo"), e.removeClass("active")
        },
        closeMyAccountMenu: function() {
            $(".user-details-header").removeClass("active"), $(".user-details-header").find(".arrow-indicator").removeClass("active")
        },
        homePadding: function() {
            var e = $(".home-header"),
                t = $(window).height(),
                i = $("header").height(),
                a = t - i - 180;
            a < 200 && (a = 200), e.height(a)
        },
        showCart: function(e, t) {
            var i = $(".cart"),
                a = $(".cart-amount"),
                o = ($("nav"), $(".user-drop")),
                r = $(".menu-toggle"),
                n = ($(".basketIcon"), $(".user-details-header")),
                s = (i.width(), $("nav").width()),
                l = $(window).width(),
                c = 0;
            l > s && (c = (l - s) / 2, c -= 10), $(a).hasClass("active") ? ($(a).removeClass("active"), $(i).fadeOut("fast")) : ($(a).addClass("active"), r.removeClass("active"), $(i).css("right", c), $(i).fadeIn("slow", function() {
                if (void 0 != e && e && $("#cartId").animate({
                    scrollTop: $("#cartId").prop("scrollHeight")
                }, 1200), void 0 != t) {
                    var i = $(".cars-tiles").find('.ticket-slider-container .icon-plus[prizeid="' + t + '"]');
                    if (i.length > 0) {
                        var a = $(i).closest(".prize-style").find(".prize-model").text();
                        a = a.trim();
                        var o = $("#cartId").find('.prize-description-col a:contains("' + a + '")');
                        if (o.length > 0) {
                            var r = $(o).closest(".cars-tables").index(),
                                n = 60 * (r + 1);
                            $("#cartId").delay(1e3).animate({
                                scrollTop: n
                            }, 700)
                        }
                    }
                }
            }), $(n).removeClass("active"), o.slideUp())
        },
        hideCart: function() {
            var e = $(".cart-amount"),
                t = $(".cart");
            e.removeClass("active"), $(t).fadeOut("fast")
        },
        hideCartTotal: function() {
            $("#ShoppingCartController").hide(), BOTBapp.adjustTopNavWidth()
        },
        tabs: function() {
            var e = $(this),
                t = $(e.data("tab")),
                i = $(".tabs ul a"),
                a = $(".tabs .tab");
            e.hasClass("active") || (i.removeClass("active"), e.addClass("active"), a.hide(), t.show())
        },
        methods: function() {
            var e = $(this),
                t = $(e.data("tab")),
                i = e.parents(".box"),
                a = i.find(".tab");
            a.not(t).fadeOut(200), t.fadeIn(200)
        },
        accordion: function() {
            var e = $(this),
                t = e.parents(".item").find(".expand");
            e.hasClass("active") ? (e.removeClass("active"), t.slideUp(400)) : (e.addClass("active"), t.slideDown(400))
        },
        menuToggle: function() {
            var e = $(this),
                t = ($("nav"), $(".cart")),
                i = $(".cart-amount"),
                a = (t.width(), $(".user-drop"));
            e.hasClass("active") ? (e.removeClass("active"), $(".icon-bar").removeClass("icon-bar-hover"), BOTBapp.showNavigation(!1)) : (t.fadeOut("fast"), e.addClass("active"), BOTBapp.showNavigation(!0), i.removeClass("active"), a.slideUp())
        },
        toggleDrop: function() {
            var e = $(this),
                t = $(".cart"),
                i = ($("nav"), $(".cart-amount")),
                a = (t.width(), $(e.data("drop"))),
                o = $(".drop-btn").not(e),
                r = $(".user-btn > ul").not(a),
                n = $(".user-menu-credit").find(".arrow-indicator");
            $(e).hasClass("user-details-header") || ($(n).removeClass("active"), e.toggleClass("active"), i.removeClass("active"), t.fadeOut("fast"), a.slideToggle(400, "easeOutExpo", function() {
                var e = $(".filters-group-toggle");
                e.length && (e.addClass("active"), plugins.rangeSlider())
            }), o.removeClass("active"), r.slideUp(400, "easeOutExpo"))
        },
        quantity: function() {
            var e = $(this),
                t = e.parents(".quantity").find("input.quntity-input").val(),
                i = 0,
                a = $(e).hasClass("qtyplus");
            a ? (i = parseFloat(t) + 1, i >= 150 && (i = 150)) : (i = parseFloat(t) - 1, i <= 1 && (i = 1)), e.closest(".quantity").find("input.quntity-input").val(i).change()
        },
        showStats: function() {
            var e = $(this),
                t = $(".stats");
            e.addClass("remove"), t.addClass("active")
        },
        hideStats: function() {
            var e = $(".stats-btn"),
                t = $(".stats");
            e.removeClass("remove"), t.removeClass("active")
        },
        showGroup: function() {
            var e = $(this),
                t = $(e.data("group")),
                i = $(".group-btn a"),
                a = $(".car-group");
            i.not(e).removeClass("active"), a.not(t).slideUp(200), e.hasClass("active") ? (e.removeClass("active"), t.slideUp(200)) : (e.addClass("active"), t.slideDown(200))
        },
        addFriend: function() {
            if (emailList_currentEmails < emailList_maxEmails) {
                var e = $(".add-friend-input").length,
                    t = $(this),
                    i = t.parents(".add-form"),
                    a = i.find("fieldset:last"),
                    o = "<fieldset>";
                o += '<input type="text" onchange="$.botbBriteValidator.validateEmail(this);" oninput="$.botbBriteValidator.validateEmail(this);" name="Emails[' + e + ']" class="briteVerifyEmail add-friend-input" id="Emails_' + e + '_" placeholder="Friend Email">', o += '<div><span class="field-validation-error Errors_BriteValidator"></span></div >', emailList_maxEmails > emailList_currentEmails + 1 ? o += '<a class="add-friend"></a>' : $.Notify({
                    message: "The maximum number of users has been reached",
                    etype: "warning"
                }), o += "</fieldset>";
                var r = $(o);
                r.insertAfter(a), t.remove(), emailList_currentEmails++
            } else
                $.Notify({
                    message: "The maximum number of users has been reached",
                    etype: "warning"
                })
        },
        loadFaqs: function(e, t) {
            var i = $(e),
                a = i.data("faq"),
                o = i.parents("ul").find("li"),
                r = $(t);
            o.removeClass("active"), i.parents("li").addClass("active"), $.ajax({
                url: a,
                success: function(e) {
                    r.html(e)
                }
            })
        },
        toggleBanner: function(e, t, i) {
            setInterval(function() {
                $(e).toggleClass(t)
            }, i)
        },
        toggleMenu: function() {
            var e = $(".menu-toggle"),
                t = $("#TopMenuHeight"),
                i = $("body");
            $(e).hasClass("active") ? ($(e).removeClass("active"), $(t).removeClass("active"), $(i).removeClass("body-scroll")) : ($(e).addClass("active"), $(t).addClass("active"), $(i).addClass("body-scroll")), $(".user-details-header").find(".arrow-indicator").removeClass("active"), null != navTimer && (clearTimeout(navTimer), navTimer = null)
        },
        openMenu: function() {
            var e = $(".menu-toggle"),
                t = $(".cart"),
                i = $(".cart-amount"),
                a = $(".user-drop"),
                o = $(".user-details-header"),
                r = ($("#MenuBasket"), $(".currency-menu"));
            $(e).addClass("active"), BOTBapp.showNavigation(!0), $(t).fadeOut("fast"), $(i).removeClass("active"), $(a).slideUp(), $(o).removeClass("active"), $(o).find(".arrow-indicator").removeClass("active"), $(r).find(".drop-btn").removeClass("active"), $(r).find(".currency-drop").slideUp("fast"), null != navTimer && (clearTimeout(navTimer), navTimer = null)
        },
        closeMenu: function() {
            if (null != navTimer && (clearTimeout(navTimer), navTimer = null), $(".menu-toggle").hasClass("active"))
                if (useMenuTimer)
                    navTimer = setTimeout(function() {
                        var e = $(".menu-toggle");
                        $(e).removeClass("active"), $(".icon-bar").removeClass("icon-bar-hover"), BOTBapp.showNavigation(!1)
                    }, 2e3);
                else {
                    var e = $(".menu-toggle");
                    $(e).removeClass("active"), $(".icon-bar").removeClass("icon-bar-hover"), BOTBapp.showNavigation(!1)
                }
        },
        isTouchDevice: function() {
            return "ontouchstart" in window || navigator.msMaxTouchPoints
        }
    };
botb.mainScript = function(e) {
    function t() {
        i(), a(), n(), s(), d(), m(), h(), P(), R(), N(), V(), q(), U(), _(), j(), Y(), Q(), J(), K(), X(), Z(), ee(), te(), ie(), oe(), le(), ce(), se(), de(), pe(), fe(), me(), he(), ve(), ge()
    }
    function i() {
        var t = e(".alternate-page-title");
        0 != e(t).length && e(".page .heading h1").html(e(t).val())
    }
    function a() {
        !function(e, t, i) {
            var a,
                o = e.getElementsByTagName(t)[0];
            e.getElementById(i) || (a = e.createElement(t), a.id = i, a.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.4", a.defer = !0, a.async = !0, o.parentNode.insertBefore(a, o))
        }(document, "script", "facebook-jssdk")
    }
    function o() {
        var t = e(".twitter_screen_name");
        if (t.length > 0) {
            e('meta[property="og:title"]').attr("content");
            window.addthis_share.passthrough = {
                twitter: {
                    via: e(t).val(),
                    text: "Check out this dream car at BOTB"
                }
            }
        }
    }
    function r() {
        "undefined" != typeof addthis && "object" == typeof window.addthis_share && (clearInterval(botb.mainScript.addThisReadyInterval), botb.mainScript.addThisReadyInterval = null, o())
    }
    function n() {
        botb.mainScript.addThisReadyInterval = setInterval(function() {
            botb.mainScript.addThisReady()
        }, 1e3)
    }
    function s() {
        if ($e = e(".has-address-lookup"), 0 != $e.length) {
            if (void 0 == botb.addressLookup)
                return void console.log("Botb AddressLookup is undefined");
            var t = e($e).find(".lookup-button");
            return 0 == t.length ? void console.log(".lookup-button could not be found") : void e(t).click(function(t) {
                if (!Ce) {
                    var i = e($e).find(".postcode").val(),
                        a = e($e).find(".loader"),
                        o = e($e).find(".address-lookup-result-container");
                    0 != i.length && (we = null, e(o).html(""), e(a).addClass("active"), Ce = !0, botb.addressLookup.lookup({
                        postcode: i
                    }, l), t.preventDefault())
                }
            })
        }
    }
    function l(t) {
        we = t;
        var i = e($e).find(".loader"),
            a = e($e).find(".address-lookup-result-container");
        e(i).removeClass("active"), e(a).html("").removeClass("active").show();
        var o = "",
            r = "",
            n = !1;
        null == t || 0 == t.length ? o = '<span class="no-result text-danger">Sorry. No result found</span>' : (e(t).each(function(e) {
            var t = this;
            r += '<option data-index="' + e + '">' + t.DisplayAddress + "</option>"
        }), n = navigator.userAgent.indexOf("Safari") > -1 && navigator.userAgent.indexOf("iPhone") > -1, n ? (o = '<select size="5" class="address-lookup-result safari">' + r + "</select>", o = '<span class="help-text">Please select</span>' + o) : o = '<select size="5" class="address-lookup-result">' + r + "</select>", e(a).on("click keypress change", ".address-lookup-result", function(t) {
            var i = this,
                a = e(i).find("option:selected").attr("data-index");
            c(a), t.preventDefault()
        })), e(a).html(o).addClass("active"), Ce = !1
    }
    function c(t) {
        if (!(null == we || we.length < t)) {
            var i = e($e).find(".address-lookup-result-container"),
                a = we[t],
                o = null != a.Organisation ? a.Organisation : "",
                r = null != a.Locality ? a.Locality : "",
                n = null != a.SubBuilding ? a.SubBuilding + " " : "";
            null != a.BuildingName && (n += a.BuildingName);
            var s = null != a.BuildingNo ? a.BuildingNo + " " : "";
            null != a.Street && (s += a.Street);
            var l = [],
                t = 0;
            o.length > 0 && (l[t++] = o), n.length > 0 && (l[t++] = n), s.length > 0 && (l[t++] = s), r.length > 0 && (l[t++] = r);
            var c = "",
                d = "";
            t >= 2 && (d = 4 == t ? l[2] + ", " + l[3] : l[t - 1]), t >= 3 ? c = l[0] + ", " + l[1] : t >= 1 && (c = l[0]), e($e).find(".address-1").val(c).trigger("change"), e($e).find(".address-2").val(d).trigger("change"), e($e).find(".town").val(a.Town).trigger("change"), e($e).find(".county").val(a.County).trigger("change"), e($e).find(".postcode").val(a.Postcode).trigger("change"), e(i).hide()
        }
    }
    function d() {
        var t = e(".surprise-audio-container");
        0 != t.length && e(t).find(".listen-to-surprise-phone-call").click(function(t) {
            var i = this,
                a = e(".surprise-audio-control-container"),
                o = e(i).attr("data-audio_url");
            if (e(a).find("audio").length > 0)
                e(a).html("").removeClass("active");
            else {
                var r = e("<audio controls>Your browser does not support the audio element.</audio>").attr({
                    src: o,
                    volume: .7,
                    autoplay: "autoplay"
                });
                e(a).html(r).addClass("active")
            }
            t.preventDefault()
        })
    }
    function u(e) {
        var t = {
            visa: /^4/,
            mastercard: /^5[1-5]/,
            amex: /^(34|37)/,
            maestro: /^(5018|5020|5038|6304|6759|6761|6762|6763)/,
            jcb: /^(352[8-9]|35[3-8][0-9])/
        };
        for (var i in t)
            if (t[i].test(e))
                return i;
        return null
    }
    function p(e) {
        switch (e) {
        case "001":
            return "visa";
        case "002":
            return "mastercard";
        case "003":
            return "amex";
        case "042":
            return "maestro";
        case "007":
            return "jcb"
        }
        return ""
    }
    function f(e) {
        switch (e) {
        case "visa":
            return "001";
        case "mastercard":
            return "002";
        case "amex":
            return "003";
        case "maestro":
            return "042";
        case "jcb":
            return "007"
        }
        return ""
    }
    function m() {
        var t = e(".card-type-container").closest("#form-cardDetails,#paywithcardsection");
        if (0 != t.length) {
            var i = e(t).find(".card-type-code"),
                a = e(t).find(".card-number");
            e(i).change(function(i) {
                var a = this,
                    o = e(a).val(),
                    r = e(t).find(".security-code");
                switch (o) {
                case "003":
                    e(r).val("").attr("maxlength", "4");
                    break;
                default:
                    e(r).val("").attr("maxlength", "3")
                }
            }), e(a).blur(function(t) {
                var i = this;
                e(i).val().match(/[a-z]/i) || e(this).val(function(e, t) {
                    var t = t.replace(/[^\d]/g, "").match(/.{1,4}/g);
                    return t ? t.join(" ") : ""
                })
            }), e(t).find("#CardNumber, #CardModel_CardNumber").on("keyup input", function(i) {
                var a = e(this).val();
                a = a.replace(/ /g, "");
                var o = a.length,
                    r = e(i.target).hasClass("edit-mode"),
                    n = u(a);
                if (r) {
                    var s = e(t).find(".card-type-code").val(),
                        l = p(s);
                    e(t).find(".predicted-card-type").addClass(l).addClass("active"), null != n && n != l && alert("The credit card number is not of the correct card type, you must CANCEL and add this as a new card")
                } else if (null != n) {
                    e(t).find(".card-type-code").val("").removeClass("active"),
                    e(t).find(".predicted-card-type").removeClass("visa amex mastercard maestro"), e(".checkout").length > 0 && e(t).find(".checkout-card-type-container").removeClass("active"), e(t).find(".predicted-card-type").addClass(n).addClass("active");
                    var c = f(n);
                    e(t).find(".card-type-code").val(c), e("#cardTypesDisallowed").val().toLowerCase().indexOf(n.toLowerCase()) >= 0 ? e(".finish-and-pay").length ? (e("#cardfieldserror").text(Te), e("#cardfieldserror").addClass("field-validation-error"), e("#cardfieldserror").removeClass("field-validation-valid"), e(".finish-and-pay").prop("disabled", !0), e(t).find(".predicted-card-type").addClass(n).removeClass("active")) : (e("#card-validationMessage")[0].innerHTML = Te, e("#card-validationMessage").show(), e("#card-validationMessage").addClass("field-validation-error"), e("#card-validationMessage").removeClass("field-validation-valid"), e("#saveCardForm").hide()) : e(".finish-and-pay").length ? (e(".finish-and-pay").prop("disabled", !1), e("#cardfieldserror").text("")) : (e("#card-validationMessage")[0].innerHTML = "", e("#card-validationMessage").hide(), e("#card-validationMessage").removeClass("field-validation-error"), e("#card-validationMessage").addClass("field-validation-valid"), e("#saveCardForm").show())
                } else
                    e(t).find(".predicted-card-type").removeClass("active"), e(t).find(".card-type-code").val("").removeClass("active"), e(".checkout").length > 0 && e(t).find(".checkout-card-type-container").removeClass("active"), o >= 15 && (e(t).find(".card-type-code").addClass("active"), e(".checkout").length > 0 && e(t).find(".checkout-card-type-container").addClass("active"))
            })
        }
    }
    function h() {
        var t = e(".paymentMethods");
        0 != t.length && e(t).find(".confirmation-box .confirm").click(function(i) {
            var a = this,
                o = e(t).find(".to-be-deleted-card-id").val();
            b(o), e(a).parent().hide()
        })
    }
    function v(t) {
        var i = e(".paymentMethods");
        e(i).find(".to-be-deleted-card-id").val(t);
        var a = e(i).find("tr#row_" + t).find(".card-type-name").text(),
            o = "Are you sure you want to delete the card details for </br><strong>" + a + "</strong>?";
        e(i).find(".to-be-deleted-card-details").html(o), e(i).find(".confirmation-box").show()
    }
    function b(t) {
        for (var i = document.getElementById("row_" + t), a = i.parentNode; a && "TABLE" != a.tagName;)
            if (a = a.parentNode, !a)
                return;
        var o = e.ajax({
            type: "POST",
            url: "/umbraco/surface/AccountSurface/RemoveCard?paymentCardProfileId=" + t,
            dataType: "json",
            contentType: "application/json",
            async: !1,
            cache: !1,
            processData: !1
        });
        o.done(function(t) {
            e(".cardRowsValidation-box").css("display", ""), e(".cardRowsValidationMessage")[0].innerHTML = "", t.ErrorCode === -1 ? e(".cardRowsValidationMessage")[0].innerHTML = t.ErrorMessage : (e(".cardRowsValidationMessage")[0].innerHTML = t.Message, a.deleteRow(i.rowIndex))
        }), o.fail(function(t, i, a) {
            e(".cardRowsValidation-box").css("display", ""), e(".cardRowsValidationMessage")[0].innerHTML = "An error has occurred while processing your request. Please contact the administrator."
        })
    }
    function g() {
        var t = e(".checkout");
        if (0 !== t.length) {
            e('input[name="PaymentMethod"]').change(function(t) {
                var i = this,
                    a = e(i).attr("data-method");
                switch (botb.mainScript.switchPaymentMethod(a), a) {
                case "creditcard":
                    botb.mainScript.checkCardType()
                }
            }), e(t).find(".card-type-container .card-type-code").change(function(e) {
                botb.mainScript.checkCardType()
            });
            var i = 0 == e(".payment-methods-container").length;
            if (i && (e(".finish-and-pay").prop("value", "COMPLETE CHECKOUT Â»"), e("#paywithcardsection").hide()), e("#TermsAndConditionsAgreed").change(function() {
                w()
            }), e('input[name="PaymentMethod"]:checked').length > 0) {
                var a = e('input[name="PaymentMethod"]:checked').val();
                switch (botb.mainScript.switchPaymentMethod(a), a) {
                case "creditcard":
                    botb.mainScript.checkCardType()
                }
            }
            e(".payment-methods-container .backdrop").unbind("click").click(function(t) {
                e(this).closest(".item").find("a").click()
            }), w()
        }
    }
    function k() {
        var t = e(".checkout-complete");
        if (0 != t.length) {
            var i = 0;
            e(".social-row").find(".item").each(function() {
                var t = this;
                i < e(t).outerHeight() && (i = e(t).outerHeight())
            }), e(".social-row").find(".item").css("min-height", i + 20)
        }
    }
    function y() {
        var t = e(".blog-details");
        0 != t.length && (e(t).find(".gallery-icon a").click(function(e) {
            e.preventDefault()
        }), e(t).find(".gallery-icon .cboxElement").swipebox(), e(t).find(".excerpt").each(function(t) {
            var i = this;
            if (e(i).height() > 40) {
                var a = e(i).html();
                a.indexOf("...") > -1 && e(i).addClass("tbc")
            }
        }))
    }
    function $(t) {
        switch (t) {
        case "paypal":
            e("#paywithcardsection").hide(), e("#billingaddresssection").hide().removeClass("active"), e(".finish-and-pay").prop("value", "PROCEED TO PAYPAL Â»");
            break;
        case "creditcard":
            e("#paywithcardsection").show(), e("#billingaddresssection").show().addClass("active"), e(".finish-and-pay").prop("value", "FINISH AND PAY Â»");
            var i = e(".available-cards-table"),
                a = e(i).find('input[name="SelectedCardProfileId"]').not(":disabled:checked");
            a.length > 0 && e(a).eq(0).siblings("label").click()
        }
        e("#PaymentMethodValidationMessage").text(""), e("#CardValidationMessage").text("")
    }
    function w() {
        var t = e("#TermsAndConditionsAgreed").is(":checked");
        t ? e(".finish-and-pay").removeClass("invalid").addClass("valid") : e(".finish-and-pay").removeClass("valid").addClass("invalid")
    }
    function C() {
        var t = e("article"),
            i = angular.element(t).scope();
        i.checkingOut = !0;
        var a = !0,
            o = e("#paypal").is(":checked"),
            r = e("#creditcard").is(":checked"),
            n = e("#TermsAndConditionsAgreed").is(":checked"),
            s = e(".available-cards-table tr").length > 0,
            l = e(".payment-methods-container").length > 0 && e(".payment-methods-container").is(":visible"),
            c = e("#newCard").is(":visible"),
            d = e("#saveaddress").length > 0 && !e("#saveaddress").is(":hidden"),
            u = e(".checkout").find(".skip-prize-extension-check").val();
        if (!l || o || r ? e("#PaymentMethodValidationMessage").text("") : (e("#PaymentMethodValidationMessage").text("Please choose a payment method"), a = !1), n ? e("#TCValidationMessage").text("") : (e("#TCValidationMessage").text("You must agree to the Terms and Conditions"), a = !1), s) {
            var p = e('input[name="SelectedCardProfileId"]:checked');
            l && r && 0 == p.length && (e("#CardValidationMessage").text("Please select a card to use."), a = !1)
        }
        var f = e("input[name=SelectedCardProfileId]:checked").val(),
            m = e("#disallow_" + f).val();
        if ("True" == m && !c && r && (e("#submitsection").hide(), e("#termssection").hide(), e("#disallowchoice").show(), a = !1), d && e("#addressfieldserror").length > 0 && (e("#addressfieldserror  .field-validation-error").text("Please save or cancel any address changes before finishing your order."), a = !1, e("html, body").animate({
            scrollTop: e("#addressfieldserror").offset().top - 250
        }, 1e3)), a && void 0 == u && !T() && x()) {
            var h = botb.cookie.getCookie("botb-prize-extension-shown");
            if ("" == h)
                return S(), !1
        }
        a && "true" == u && e(".checkout").find(".checkout-prize-extension-popup").remove();
        var v = e("#submitcontrols");
        e(v).find(".finish-and-pay").prop("disabled", !0), setTimeout(function() {
            return a && e("#checkoutform").valid() ? (e(v).find(".finish-and-pay").hide(), e(v).find(".loader").addClass("active"), e("body").find("a").prop("onclick", null).off("click"), e("body").find("a").each(function() {
                e(this).prop("href", null)
            }), e("body").find("a").each(function() {
                e(this).click(function() {
                    return !1
                })
            }), e(".available-cards-table").find('input[type="button"]').prop("onclick", null).off("click"), e(".available-cards-table").find('input[type="button"]').click(function() {
                return !1
            }), e(".available-cards-table").find('input[type="button"]').prop("disabled", !0)) : (e(v).find(".finish-and-pay").show(), e(v).find(".loader").removeClass("active"), e(v).find(".finish-and-pay").prop("disabled", !1)), a
        }, 1e3)
    }
    function T() {
        var t = angular.element(e(".checkout").get(0)).scope().cart.CartItems,
            i = e.grep(t, function(e) {
                return "Plus20k" == e.SKU
            });
        return i.length >= 1
    }
    function x() {
        return e(".prize-extension-20k").length > 0
    }
    function S() {
        e(".checkout").find(".checkout-prize-extension-popup").remove();
        var t = e(".prize-extension-20k"),
            i = e(t).find(".button-text").text().trim(),
            a = e(t).find(".20k-content").html(),
            o = e(".prize-extension-20k").find(".prize-img").attr("src");
        e.get("/js/views/checkout-prize-extension.html", function(t) {
            t = t.replace("{{product-name}}", i), t = t.replace("{{description}}", a), t = t.replace("{{image}}", o), e(".checkout").append(t), e(".checkout").find(".checkout-prize-extension-popup").find(".no-btn").unbind("click").click(botb.mainScript.cancelCheckoutExtensionItem), e(".checkout").find(".checkout-prize-extension-popup").find(".yes-btn").unbind("click").click(botb.mainScript.addCheckoutExtensionItem), botb.cookie.setCookie("botb-prize-extension-shown", "true", .003)
        })
    }
    function z() {
        var t = angular.element(e(".checkout").get(0)).scope();
        t.AddProduct("Plus20k"), e(".checkout").find(".checkout-prize-extension-popup").remove(), e(window).scrollTop(0)
    }
    function M() {
        e(".checkout").find(".finish-and-pay").click(), e(".checkout").find(".checkout-prize-extension-popup").remove()
    }
    function I(t) {
        var i = e(t).closest("form");
        if (!e(i).valid())
            return !1;
        if (!e.botbBriteValidator.validateFormEmails())
            return !1;
        var a = e("#submitcontrols");
        e(a).find(".register-button").hide(), e(a).find(".loader").addClass("active")
    }
    function P() {
        var t = e(".has-address-lookup");
        0 != t.length && (e(t).find(".country").change(function(i) {
            var a = this,
                o = {
                    countryCode: e(a).val()
                },
                r = e.ajax({
                    type: "POST",
                    url: "/umbraco/surface/accountsurface/iscountryrequiredpostcode",
                    dataType: "json",
                    contentType: "application/json",
                    async: !0,
                    data: JSON.stringify(o),
                    cache: !1
                });
            r.done(function(i) {
                null != i && void 0 != i && (i.Required ? e(t).find(".lookup").show() : (e(t).find(".postcode").val(""), e(t).find(".lookup").hide()), i.Supported ? (e(t).find(".lookup-button").show(), e(t).find(".address-lookup-result").show()) : (e(t).find(".lookup-button").hide(), e(t).find(".address-lookup-result").hide()))
            })
        }), e(t).find(".country").change())
    }
    function A(t) {
        var i = "form-cardDetails";
        t && (i = "cardDetails"), e("#" + i + " #PaymentCardProfileId").val(""), e("#" + i + " #CardTypeCode").val(""), e("#" + i + " #ExpiryDateMonth").val(""), e("#" + i + " #ExpiryDateYear").val(""), e("#" + i + " #CardNumber").val(""), e("#" + i + " #CardNumber").removeClass("edit-mode"), e("#" + i).find(".predicted-card-type").removeClass("active visa amex mastercard maestro"), e("#" + i + " #CardTypeCode").val(""), e("#" + i + " #NameOnCard").val(""), e("#" + i + " #SecurityCode").val(""), e("#" + i + " #StartMonth").val(""), e("#" + i + " #StartYear").val(""), e("#" + i + " #IssueNumber").val(""), e(".field-validation-error").addClass("field-validation-valid"), e(".field-validation-error").removeClass("field-validation-error"), e(".field-validation-valid").empty(), e(".validation-summary-errors").addClass("validation-summary-valid"), e(".validation-summary-errors").removeClass("validation-summary-errors"), e(".validation-summary-valid").empty(), e("#" + i).find(".botb-placeholder-label").removeClass("active"), t ? e("#card-validationMessage")[0].innerHTML = "" : (e("#form-cardDetails .validationMessage")[0].innerHTML = "", e(".cardRowsValidationMessage")[0].innerHTML = "", e("#form-cardDetails").closest(".paymentMethods").addClass("adding-new-card"), e("#closeCardForm").click(function(t) {
            e("#form-cardDetails").closest(".paymentMethods").removeClass("adding-new-card")
        }), e("#saveCardForm").show()), e("#CardTypeCode").prop("disabled", !1), botb.mainScript.checkCardType()
    }
    function F(e, t) {
        e ? t.addClass("card-updating") : t.removeClass("card-updating")
    }
    function B(t, i, a) {
        var o = {};
        e("#" + t).find("input[name],select[name]").each(function(e, t) {
            var i = t.name.replace("card.", "");
            o[i] = t.value
        });
        var r = e("#" + t);
        r.validate(), r.valid() ? (F(!0, r), e.ajax({
            type: "POST",
            url: i,
            dataType: "json",
            contentType: "application/json",
            async: !0,
            data: JSON.stringify(o),
            cache: !1,
            processData: !1,
            success: function(i) {
                if (F(!1, r), e("#" + t + " .validationMessage")[0].innerHTML = "", i.ErrorCode === -1)
                    e("#" + t + " .validation-box").css("display", ""), e("#" + t + " .validationMessage")[0].innerHTML = i.ErrorMessage;
                else {
                    e("#" + t + " .validationMessage")[0].innerHTML = i.Message;
                    var a = i.paymentId,
                        o = i.cardType,
                        n = i.last4Digits,
                        s = i.formattedExpiry;
                    if (0 == e("#cardPaymentsTable #row_" + a).length) {
                        var l = document.getElementById("cardPaymentsTable"),
                            c = l.insertRow(-1);
                        c.id = "row_" + a;
                        var d = c.insertCell(0);
                        d.classList = "has-pretty-child", d.innerHTML = '<div class="clearfix prettycheckbox labelright blue card-type-name">' + o + " (ending " + n + "; exp " + s + ")</div>";
                        var u = c.insertCell(1);
                        u.innerHTML = '<a class="icon delete" onclick="botb.mainScript.preDeleteCard(\'' + i.paymentId + "')\"></a>", u.innerHTML = u.innerHTML + '<a class="icon edit method-btn" data-tab=".carddetails" onclick="botb.mainScript.getCardData(\'/umbraco/surface/AccountSurface/GetCreditCardDetails?PaymentCardProfileId=' + i.paymentId + "')\"></a>", e(".method-btn").on("click", BOTBapp.methods)
                    } else
                        e("#cardPaymentsTable #row_" + a + " td:first > div")[0].innerHTML = o + " (ending " + n + "; exp " + s + ")";
                    e("#closeCardForm").click()
                }
            },
            error: function(i, a, o) {
                F(!1, r), e("#" + t + " .validation-box").css("display", ""), e("#" + t + " .validationMessage")[0].innerHTML = "An error has occurred while processing your request. Please contact the administrator."
            }
        })) : e(".paymentMethods").height("800px")
    }
    function L(t, i, a) {
        var o = {};
        e("#" + t).find("input[name], textarea[name], select[name]").each(function(e, t) {
            var i = t.name.replace("card.", "");
            "radio" == t.type ? t.checked && (o[i] = t.value) : o[i] = t.value
        });
        var r = e("#" + t);
        r.valid() && e.ajax({
            type: "POST",
            url: i,
            dataType: "json",
            contentType: "application/json",
            async: !1,
            data: JSON.stringify(o),
            cache: !1,
            processData: !1,
            success: function(i) {
                if (e("#" + t + " .validation-box").css("display", ""), e("#" + t + " .validationMessage")[0].innerHTML = "", e("#" + t + " .validationMessage").removeClass("text-danger"), i.ErrorCode === -1)
                    e("#" + t + " .validationMessage")[0].innerHTML = i.ErrorMessage, e("#" + t + " .validationMessage").addClass("text-danger");
                else {
                    "form-billingDetails" === t ? e(".address-lookup-result-container").each(function() {
                        this.innerHTML = ""
                    }) : "form-changePassword" === t && e("#form-changePassword input[type=password]").each(function() {
                        this.value = ""
                    });
                    var a = '<img class="account-save-icon" alt="" src="/assets/images/tick-save-icon.png" />',
                        o = a + i.Message;
                    e("#" + t + " .validationMessage")[0].innerHTML = o, null != i.CardTypesDisallowed && e("#cardTypesDisallowed").val(i.CardTypesDisallowed)
                }
            },
            error: function(i, a, o) {
                e("#" + t + " .validation-box").css("display", ""), e("#" + t + " .validationMessage")[0].innerHTML = "An error has occurred while processing your request. Please contact the administrator."
            }
        })
    }
    function O(t, i, a, o, r) {
        var n = {};
        a && e("#" + a).wrap('<form id="' + t + '"></form>'), e("#" + t).find("input[name],select[name]").each(function(e, t) {
            var i = t.name.replace("card.", "");
            n[i] = t.value
        }), n.CardType = e("#CardTypeCode option:selected").text();
        var s = e("#" + t);
        s.validate(), s.valid() ? (a && e("#" + a).unwrap(), e.ajax({
            type: "POST",
            url: i,
            dataType: "json",
            contentType: "application/json",
            async: !1,
            data: JSON.stringify(n),
            cache: !1,
            processData: !1,
            success: function(t) {
                if (e("#" + o).show(), e("#" + o)[0].innerHTML = "", t.ErrorCode === -1)
                    e("#" + o)[0].innerHTML = t.ErrorMessage, e("#" + o).eq(0).addClass("field-validation-error"), e("#" + o).eq(0).removeClass("field-validation-valid");
                else if (e("#" + o)[0].innerHTML = "Your details been updated.", e("#" + o).hide(), e("#div-" + a).hide(), e("#" + r).show(), n.BillingAddressLine1 && (e("#editExistingBillingLine")[0].innerHTML = n.BillingAddressLine1 + ", " + n.BillingAddressLine2 + ", " + n.BillingAddressTown + ", " + n.BillingAddressPostcode + ", " + n.BillingAddressCountry), e("#cardTypesDisallowed").val(t.CardTypesDisallowed), n.CardNumber) {
                    var i = e('label[for="' + n.PaymentCardProfileId + '"]')[0],
                        s = n.CardNumber.slice(-4),
                        l = n.ExpiryDateYear.slice(-2),
                        c = String("00" + n.ExpiryDateMonth).slice(-2);
                    i.innerHTML = n.CardType + " (ending " + s + "; exp " + c + "/" + l + ")"
                }
            },
            error: function(t, i, a) {
                e("#" + o)[0].innerHTML = "An error has occurred while processing your request. Please contact the administrator."
            }
        })) : a && e("#" + a).unwrap()
    }
    function E(t, i) {
        var a = "form-cardDetails";
        A(i), i && (a = "cardDetails", e("#div-cardDetails").show()), e("#CardTypeCode").prop("disabled", !0), e.ajax({
            type: "GET",
            url: t,
            dataType: "json",
            contentType: "application/json",
            async: !1,
            cache: !1,
            processData: !1,
            success: function(t) {
                var i = !1;
                1 == t.IsDisallowed ? (e("#card-validationMessage")[0].innerHTML = t.ErrorMessage, e("#card-validationMessage").show(), e("#card-validationMessage").addClass("field-validation-error"), e("#card-validationMessage").removeClass("field-validation-valid"), e("#saveCardButton") && e("#saveCardButton").hide(), e("#saveCardForm") && e("#saveCardForm").hide()) : (e("#saveCardButton") && e("#saveCardButton").show(), e("#saveCardForm") && e("#saveCardForm").show()), e("#" + a + " #ExpiryDateYear option[value='" + t.ExpiryDateYear + "']").length > 0 && (i = !0), 0 == i && e("#" + a + " #ExpiryDateYear").prepend(e("<option></option>").val(t.ExpiryDateYear).html(t.ExpiryDateYear)), e("#" + a + " #PaymentCardProfileId").val(t.PaymentCardProfileId), e("#" + a + " #CardTypeCode").val(t.CardTypeCode), e("#" + a + " #ExpiryDateMonth").val(t.ExpiryDateMonth), e("#" + a + " #ExpiryDateYear").val(t.ExpiryDateYear), e("#" + a + " #CardNumber").addClass("edit-mode");
                var o = e("#" + a + " #CardTypeCode").val(),
                    r = p(o);
                e("#" + a).find(".predicted-card-type").addClass(r).addClass("active"), e("#" + a + " #NameOnCard").val(t.NameOnCard), e("#" + a + " #StartMonth").val(t.StartMonth), e("#" + a + " #StartYear").val(t.StartYear), e("#" + a + " #IssueNumber").val(t.IssueNumber), botb.mainScript.checkCardType(), e("#" + a).find('input[type="text"],input[type="email"],input[type="tel"],input[type="password"]').each(function() {
                    var t = this;
                    e(t).val().length > 0 && e(t).siblings(".botb-placeholder-label").addClass("active")
                })
            },
            error: function(t, o, r) {
                i ? e("#cardvalidationMessage")[0].innerHTML = t.responseJSON.ErrorMessage : (e("#" + a + " .validation-box").css("display", ""), e("#" + a + " .validationMessage")[0].innerHTML = t.responseJSON.ErrorMessage)
            }
        })
    }
    function D() {
        if (e(".card-type-code").length > 0) {
            var t = e(".card-type-code").eq(0).val();
            if ("" == t)
                var t = e(".card-type-code").eq(1).val();
            var i = e("#maestro-card-types").val(),
                a = i.split(";");
            a.indexOf(t) !== -1 ? (e(".maestroCards").show(), e(".paymentMethods").height("610px")) : a.indexOf(t) == -1 && e(".maestroCards").hide()
        }
    }
    function R() {
        var t = e(".checkout");
        0 != t.length && (e(".loader").hide(), e(t).find(".payment-type-dropdown").change(function(i) {
            var a = this,
                o = e(a).find("option:selected").attr("data-paytype"),
                r = e(a).find("option:selected").attr("data-amount"),
                n = parseFloat(r, 10);
            "Cash" == o || 0 == n ? (e(t).find(".txn-row").hide(), e(t).find(".txn-textbox").val("")) : e(t).find(".txn-row").show()
        }), e(".confirmAndFinish").click(function(t) {
            var i = this;
            return e("#ManualTransactionReference").is(":visible") && "" == e("#ManualTransactionReference").val() ? (e("#ManualTransactionReference").siblings(".text-danger").html("<span>Invalid TXN Ref format</span>"), e("html,body").animate({
                scrollTop: e("body").offset().top
            }, 300), void t.preventDefault()) : void (e(".field-validation-error") && "block" == e(".field-validation-error").css("display") || (e(".loader").show(), e(i).hide()))
        }))
    }
    function N() {
        e(".have-an-account").click(function(t) {
            e(".login-options-container").addClass("active"), e(".login-form-options").removeClass("active"), t.preventDefault()
        })
    }
    function V() {
        var t = e(".faqs");
        0 != t.length && (e(t).find(".faq-topic").click(function(t) {
            var i = this,
                a = e(i).nextUntil(".faq-topic");
            e(a).hasClass("active") ? (e(a).removeClass("active"), e(i).removeClass("active")) : (e(i).siblings(".faq-topic.active").removeClass("active"), e(i).siblings(".faq-category-container.active").removeClass("active"), e(a).addClass("active"), e(i).addClass("active"))
        }), e(t).find(".faq-category").click(function(t) {
            var i = this,
                a = e(i).closest(".faq-category-container"),
                o = e(a).find(".faq-answer");
            e(i).hasClass("active") ? (e(i).removeClass("active"), e(o).removeClass("active")) : (e(i).addClass("active"), e(o).addClass("active"), e(a).siblings(".faq-category-container").find(".faq-category.active").each(function() {
                var t = this;
                e(t).removeClass("active"), e(t).siblings(".faq-answer").removeClass("active")
            }))
        }), e(".faq-topic").eq(0).click())
    }
    function q() {
        var t = e("#accordion");
        0 != t.length && e(t).find(".accordion-toggle").click(function() {
            e(this).next().slideToggle("fast"), e(".accordion-content").not(e(this).next()).slideUp("fast")
        })
    }
    function H() {
        e("#email-option-login").toggle(), e("#social-option-login").toggle(), e("#email-option-login").is(":visible") && e(".login-heading").hide()
    }
    function U() {
        var t = e(".free-competition");
        if (0 != t.length) {
            var i = '<a class="btn orange to-play-superdrives-link-hero" href="">ENTER FOR FREE NOW &rsaquo;&rsaquo;</a>';
            e(".competition-images").find(".holder").prepend(i);
            var a = e(".link-to-superdrives-comp").val();
            void 0 != a && (e(".to-play-superdrives-link").attr("href", a), e(".to-play-superdrives-link-hero").attr("href", a));
            var o = e(".text-to-superdrives-comp").val();
            void 0 != o && (e(".to-play-superdrives-link").text(o), e(".to-play-superdrives-link-hero").text(o))
        }
    }
    function _() {
        var t = e(".car-details .car-viewed-id");
        0 != t.length && botb.cookie.setCarPrizeCookie(e(t).val())
    }
    function j() {
        var t = e("#cartId");
        0 != t.length && e(t).find(".add-more").click(function(i) {
            "/prizes/cars" == window.location.pathname && e(t).find(".cart-close").click()
        })
    }
    function G() {
        var t = e(".advent-container");
        0 != t.length && e(t).find(".video-container .play").click(function(e) {
            var t = this;
            botb.videoPopup.play(t)
        })
    }
    function W() {
        var t = e(".welcome-to-new-site-popup-container");
        if (0 != t.length) {
            var i = botb.cookie.getCookie("botb-welcome-popup");
            if ("" != i)
                return void e(".welcome-to-new-site-popup-container").remove();
            botb.cookie.setCookie("botb-welcome-popup", "true", 365), e(".welcome-to-new-site-popup-container .close").click(function(i) {
                e(t).fadeOut("fast", function() {
                    e(".welcome-to-new-site-popup-container").remove()
                }), i.preventDefault()
            }), e(".welcome-to-new-site-popup-container").click(function(t) {
                e(t.target).is(".welcome-to-new-site-popup-container") && e(".welcome-to-new-site-popup-container").fadeOut("fast", function() {
                    e(".welcome-to-new-site-popup-container").remove()
                })
            })
        }
    }
    function Y() {
        var t = e(".supercharged-club");
        0 != t.length && e(t).find(".view-all-supercharged-prizes").click(function(i) {
            var a = e(this),
                o = e(a).closest(".item"),
                r = "";
            e(o).hasClass("bronze") ? r = ".bronze-prizes" : e(o).hasClass("silver") ? r = ".silver-prizes" : e(o).hasClass("gold") && (r = ".gold-prizes");
            var n = e(".loyalty-club-prizes-for-popup").find(r);
            e(t).find(".supercharged-prize-container").remove();
            var s = '<div class="supercharged-prize-container"><div class="supercharged-prize-modal"><div class="close-container"><span class="close"></span></div><div class="cars-tiles">{{list}}</div></div></div>',
                l = "";
            e.get("/js/views/supercharged-prizes-unit.html", function(i) {
                var a = i;
                e(n).find(".unit").each(function() {
                    var t = e(this),
                        i = e(t).find("img").attr("src"),
                        o = e(t).find("span").attr("data-prize-make"),
                        r = e(t).find("span").attr("data-prize-model");
                    l += a, l = l.replace("{{img-src}}", i), l = l.replace("{{prize-make}}", o), l = l.replace("{{prize-model}}", r)
                }), s = s.replace("{{list}}", l), e(t).append(s), e(t).find(".close").click(function(t) {
                    e(".supercharged-prize-container").remove()
                })
            })
        })
    }
    function Q() {
        e(".supercharged-status-video").click(function(t) {
            var i = t.target,
                a = e(i).attr("data-video");
            void 0 != a && "" != a && botb.videoPopup.play(e(i))
        })
    }
    function J() {
        var t = e(".wac-previous-winners-container");
        0 != t.length && e(window).scroll(function() {
            var t = e(window).scrollTop();
            if (t > 385) {
                var i = t - 460;
                e(".wac-previous-winners").css("top", i)
            } else
                e(".wac-previous-winners").attr("style", "")
        })
    }
    function K() {
        var t = e(".league-edit");
        0 != t.length && (window.onbeforeunload = function() {
            var t = !1;
            return e("#league_basicProperties").find(".add-form input").each(function() {
                var i = this;
                e(i).val().trim().length > 0 && (t = !0)
            }), t ? "Changes you have made to this League have not been saved. Are you sure you want to navigate away from this page?" : null
        })
    }
    function X() {
        var t = e(".our-winners");
        0 != t.length && e(".our-winners").find(".more-filters a").click()
    }
    function Z() {
        var t = e(".car-collections.home-section");
        0 != t.length && e(t).find(".video-trigger").click(function(t) {
            var i = this,
                a = e(i).closest(".has-video").attr("data-video");
            if (void 0 != a && "" != a) {
                var o = e(i).closest(".has-video");
                botb.videoInElement.play(o, o)
            }
        })
    }
    function ee() {
        var t = e(".judging-heatmap");
        if (0 !== t.length) {
            var i = new Image;
            i.onload = function() {
                var t = e(".judging_coordinates_x").val(),
                    i = e(".judging_coordinates_y").val(),
                    a = e(".heatmap_thumbnail"),
                    o = '<img alt="" src="/assets/images/marker.png" class="judging_marker" />';
                e(".heat-map-container").append(o);
                var r = e(a)[0].naturalWidth,
                    n = e(a)[0].naturalHeight,
                    s = e(a).width(),
                    l = e(a).height(),
                    c = n / l,
                    d = r / s,
                    u = 10,
                    p = 10,
                    f = i / c - u,
                    m = t / d - p,
                    h = e(".heat-map-container").find(".judging_marker");
                e(h).css("top", f + "px"), e(h).css("left", m + "px")
            }, i.src = e(t).find(".heatmap_thumbnail").attr("src")
        }
    }
    function te() {
        e(".home").find(".unit-container").find(".unit").on("mouseenter", function() {
            var t = this;
            e(t).find("img").addClass("colour")
        }), e(".home").find(".unit-container").find(".unit").on("mouseleave", function() {
            var t = this;
            e(t).find("img").removeClass("colour")
        })
    }
    function ie() {
        var t = e(".winner-slider-homepage");
        e(t).removeClass("static");
        var i = 434;
        ae(i), e(window).resize(function() {
            ae(i)
        })
    }
    function ae(t) {
        var i = e(window).width(),
            a = e(".winner-slider-homepage");
        if (0 != a.length) {
            var o = 2 * t,
                r = 3 * t,
                n = !0;
            if (i >= r) {
                if (3 == currentMaxSlideHomepageWinner)
                    return;
                currentMaxSlideHomepageWinner = 3, n = !0
            } else if (i >= o && i < r) {
                if (2 == currentMaxSlideHomepageWinner)
                    return;
                currentMaxSlideHomepageWinner = 2, n = !0
            } else {
                if (1 == currentMaxSlideHomepageWinner)
                    return;
                currentMaxSlideHomepageWinner = 1, t = 0, n = !1
            }
            null != homepageWinnerSlider && homepageWinnerSlider.destroySlider();
            var s = e(a).bxSlider({
                speed: 1e3,
                slideWidth: t,
                minSlides: 1,
                maxSlides: currentMaxSlideHomepageWinner,
                infiniteLoop: n,
                slideMargin: 10,
                auto: !1,
                pause: 6e3,
                touchEnabled: !0,
                pager: !1,
                controls: !0,
                onSlideAfter: function(t, i, a) {
                    var o = e(t).closest(".slider-container").find(".video-close");
                    botb.videoInElement.remove(o)
                }
            });
            homepageWinnerSlider = s
        }
    }
    function oe() {
        var t = e(".car-collection-slider-homepage");
        e(t).removeClass("static");
        var i = 434;
        re(i), e(window).resize(function() {
            re(i)
        })
    }
    function re(t) {
        var i = e(window).width(),
            a = e(".car-collection-slider-homepage");
        if (0 != a.length) {
            var o = 2 * t,
                r = 3 * t,
                n = !0;
            if (i >= r) {
                if (3 == currentMaxSlideCarCollection)
                    return;
                currentMaxSlideCarCollection = 3, n = !0
            } else if (i >= o && i < r) {
                if (2 == currentMaxSlideCarCollection)
                    return;
                currentMaxSlideCarCollection = 2, n = !0
            } else {
                if (1 == currentMaxSlideCarCollection)
                    return;
                currentMaxSlideCarCollection = 1, t = 0, n = !1
            }
            null != homepageCarCollectionSlider && homepageCarCollectionSlider.destroySlider();
            var s = e(a).bxSlider({
                speed: 1e3,
                slideWidth: t,
                minSlides: 1,
                maxSlides: currentMaxSlideCarCollection,
                infiniteLoop: n,
                slideMargin: 10,
                auto: !1,
                pause: 6e3,
                touchEnabled: !0,
                pager: !1,
                controls: !0,
                onSlideAfter: function(t, i, a) {
                    var o = e(t).closest(".slider-container").find(".video-close");
                    botb.videoInElement.remove(o)
                }
            });
            homepageCarCollectionSlider = s
        }
    }
    function ne(t) {
        e(t).closest(".slider-container").find(".bx-controls-direction").show()
    }
    function se() {
        var t = e(".nov-landing-page-container");
        if (0 != e(t).length) {
            e("body").addClass("nov-landing-page");
            var i = e(t).find(".nov-landing-version").val();
            void 0 != i && e("body").addClass(i)
        }
    }
    function le() {
        var t = e(".in-the-headlights-container");
        if (0 !== e(t).length) {
            var i = "our-cars-controller-container";
            e(t).parent().find(".our-lifestyle-prizes").length > 0 && (i = "our-lifestyle-prizes-controller-container"), e(t).find(".prize-style").mouseenter(function() {
                var t = this,
                    i = e(window).width();
                i > 768 && e(t).find(".prize-multibuy").length > 1 && (e(t).find(".prize-make").removeClass("active"), e(t).find(".prize-multibuy").addClass("active"), e(t).find(".prize-model").addClass("active"))
            }), e(t).find(".prize-style").mouseleave(function() {
                var t = this,
                    i = e(window).width();
                i > 768 && (e(t).find(".prize-make").addClass("active"), e(t).find(".prize-multibuy").removeClass("active"), e(t).find(".prize-model").removeClass("active"))
            });
            var a = null,
                o = {};
            e(t).find(".icon-plus").unbind("mouseenter").mouseenter(function() {
                a = Date.now();
                var t = this,
                    i = t.getAttribute("prizeid");
                o[i] && (clearTimeout(o[i]), o[i] = null);
                var r = e(t).siblings(".ticket-slider"),
                    n = e(t).closest(".prize-style"),
                    s = e(n).find(".img-nest > .icon-wheel:not(.ng-hide)"),
                    l = e(t).closest(".prize-style").find(".is-valid-to-add").val(),
                    c = e(n).find(".prize-multibuy"),
                    d = e(n).find(".prize-make");
                "false" == l ? e(s).tooltipster("show") : (e(r).show(), e(c).addClass("active"), e(d).removeClass("active")), e(n).unbind("mouseleave").mouseleave(function() {
                    var t = e(n).find(".icon-plus"),
                        i = e(t).siblings(".ticket-slider"),
                        a = t[0].getAttribute("prizeid"),
                        r = e(t).closest(".prize-style").find(".prize-multibuy"),
                        s = e(n).find(".prize-make");
                    e(r).removeClass("active"), e(s).addClass("active"), o[a] = setTimeout(function() {
                        i.hide(), e(r).removeClass("active"), e(s).addClass("active")
                    }, 1e3)
                }), e(n).unbind("mouseenter").mouseenter(function() {
                    var t = e(n).find(".icon-plus"),
                        i = (e(t).siblings(".ticket-slider"), t[0].getAttribute("prizeid")),
                        a = e(n).find(".prize-multibuy"),
                        r = e(n).find(".prize-make");
                    e(r).removeClass("active"), e(a).addClass("active"), o[i] && (clearTimeout(o[i]), o[i] = null)
                })
            }), e(t).find(".icon-plus").unbind("mouseleave").mouseleave(function() {
                a = null, e(".icon-wheel").tooltipster("hide")
            }), e(t).find(".icon-plus").unbind("click").click(function(t) {
                if (!(null != a && Date.now() - a < 500)) {
                    var i = this,
                        o = e(i).siblings(".ticket-slider"),
                        r = e(i).closest(".prize-style"),
                        n = e(r).find(".img-nest > .icon-wheel:not(.ng-hide)");
                    o.hasClass("ng-hide") && n.tooltipster("show"), e(o).is(":visible") ? e(o).hide() : e(o).show()
                }
            }), e(t).find(".prize-multi-buy-price").click(function(t) {
                var a = this,
                    o = e(a).attr("data-content-node-id"),
                    r = e(a).attr("data-quantity"),
                    n = e(a).closest(".in-the-headlights-container");
                e(n).hasClass("cash") ? i = "our-lifestyle-prizes-controller-container-cash" : e(n).hasClass("bikes") ? i = "our-lifestyle-prizes-controller-container-bikes" : e(n).hasClass("holidays") ? i = "our-lifestyle-prizes-controller-container-holidays" : e(n).hasClass("watches") ? i = "our-lifestyle-prizes-controller-container-watches" : e(n).hasClass("other") && (i = "our-lifestyle-prizes-controller-container-other"), angular.element(document.getElementById(i)).scope().addTickets(o, r)
            }), e(t).find(".ticket-slider").find("a").unbind("click").click(function(t) {
                var a = this,
                    o = e(a).attr("data-content-node-id"),
                    r = e(a).attr("data-quantity"),
                    n = e(a).closest(".in-the-headlights-container");
                e(n).hasClass("cash") ? i = "our-lifestyle-prizes-controller-container-cash" : e(n).hasClass("bikes") ? i = "our-lifestyle-prizes-controller-container-bikes" : e(n).hasClass("holidays") ? i = "our-lifestyle-prizes-controller-container-holidays" : e(n).hasClass("watches") ? i = "our-lifestyle-prizes-controller-container-watches" : e(n).hasClass("other") && (i = "our-lifestyle-prizes-controller-container-other"), angular.element(document.getElementById(i)).scope().addTickets(o, r)
            }), e(t).find(".quick-view").unbind("click").click(function(t) {
                var a = this,
                    o = e(a).parent().find(".car-prize-serialized").val(),
                    r = JSON.parse(o),
                    n = e(a).parent().find(".car-prize-serialized").attr("data-prize-category"),
                    s = e(a).closest(".in-the-headlights-container");
                e(s).hasClass("cash") ? i = "our-lifestyle-prizes-controller-container-cash" : e(s).hasClass("bikes") ? i = "our-lifestyle-prizes-controller-container-bikes" : e(s).hasClass("holidays") ? i = "our-lifestyle-prizes-controller-container-holidays" : e(s).hasClass("watches") ? i = "our-lifestyle-prizes-controller-container-watches" : e(s).hasClass("other") && (i = "our-lifestyle-prizes-controller-container-other"), angular.element(document.getElementById(i)).scope().showQuickView(r, n), angular.element(document.getElementById(i)).scope().$apply()
            })
        }
    }
    function ce() {
        e(".navigation__list--secondary").find("a").on("click touchend", function(t) {
            var i = e(this),
                a = e(i).attr("href");
            window.location = a
        })
    }
    function de() {
        var t = e(".botb-custom-placeholder");
        0 !== t.length && (e(t).on("change paste keyup input", 'input[type="text"],input[type="email"],input[type="tel"],input[type="password"]', function() {
            var t = this;
            0 === e(t).val().length ? e(t).siblings(".botb-placeholder-label").removeClass("active") : e(t).siblings(".botb-placeholder-label").addClass("active")
        }), e(t).find('input[type="text"],input[type="email"],input[type="tel"],input[type="password"]').each(function() {
            var t = this;
            e(t).val().length > 0 && e(t).siblings(".botb-placeholder-label").addClass("active")
        }))
    }
    function ue() {
        var t = botb.cookie.getCookie("cookiepolicy");
        void 0 != t && null != t && t.length > 0 || e.Notify({
            message: 'We use cookies on this site to provide the best possible user experience. <br>To find out more or to adjust your settings see our <a href="/cookies">Cookie Policy</a>. <br> Otherwise, if you agree to our use of cookies, please continue to browse.',
            etype: "persistentcookie"
        })
    }
    function pe() {
        var t = e(".external-registration");
        0 != e(t).length && e.Notify({
            message: "We have pre-filled your registration information from your social media account. Please review your details so we are able to contact you when you win.",
            etype: "info"
        })
    }
    function fe() {
        var t = e(".lifestyle-banner-content");
        if (0 !== t.length) {
            var i = e(".lifestyle-banner-image").attr("src"),
                a = e(".lifestyle-banner-image").attr("data-mobile_src");
            void 0 !== a && (e(t).click(function(t) {
                var i = this,
                    a = e(i).find(".btn").attr("href");
                window.location.href = a
            }), e(window).resize(function() {
                var t = e(".lifestyle-banner-caption").find("ul");
                e(t).is(":visible") ? e(".lifestyle-banner-image").attr("src", i) : e(".lifestyle-banner-image").attr("src", a)
            }), e(window).resize())
        }
    }
    function me() {
        var t = e(".home-header");
        0 !== t.length && e(t).click(function(t) {
            var i = this,
                a = e(i).find(".container").find(".btn").attr("href");
            e(t.target).is(".winner-slider-inner-circles") || (window.location.href = a)
        })
    }
    function he() {
        var t = e(".testimonials-container");
        0 != t.length && e(t).find(".details-container").find(".play-video").click(function(t) {
            var i = this;
            botb.videoPopup.play(e(i), e(i).closest(".unit"))
        })
    }
    function ve() {
        var t = e(".lifestyle-poll-buttons-container");
        0 !== t.length && (e(t).find(".suggest-a-prize").click(function(t) {
            var i = e("body").hasClass("pp-authenticated");
            if (i)
                botb.mainScript.showSuggestAPrizeForm();
            else if (confirm("You must log-in before using prize suggestion and voting. Do you want to login now?")) {
                var a = "/login?ReturnUrl=/prizes/lifestyle";
                window.location.href = a
            }
        }), e(t).find(".vote").click(function(t) {
            var i = this;
            if (e(i).hasClass("disabled"))
                return void alert("You have already voted this week");
            var a = e("body").hasClass("pp-authenticated");
            if (a)
                e(".lifestyle-vote-container").addClass("active"), angular.element(e(".vote-popup-container").get(0)).scope().showPrizes();
            else if (confirm("You must log-in before using prize suggestion and voting. Do you want to login now?")) {
                var o = "/login?ReturnUrl=/prizes/lifestyle";
                window.location.href = o
            }
        }))
    }
    function be() {
        e.get("/umbraco/surface/pollandsurveysurface/GetSuggestAPrizePopup", function(t) {
            botb.messagePopup.show(t, "poll-suggest-a-prize-form"), botb.mainScript.customPlaceholder(), e(".poll-suggest-a-prize-form").find(".close-btn").click(function(e) {
                botb.messagePopup.close()
            }), e(".poll-suggest-a-prize-form").find(".submit").click(function(t) {
                var i = ".suggest-a-prize-form",
                    a = e(i).find(".make").val(),
                    o = e(i).find(".model").val(),
                    r = e(i).find(".additional-info").val();
                a = a.replace(/[\/\\*]/g, ""), o = o.replace(/[\/\\*]/g, ""), r = r.replace(/[\/\\*]/g, "");
                var n = e.ajax({
                    type: "POST",
                    url: "/umbraco/surface/pollandsurveysurface/submitsuggestaprize",
                    data: {
                        make: a,
                        model: o,
                        additionalInfo: r
                    },
                    cache: !1
                });
                n.done(function(t) {
                    if (void 0 !== t && null !== t) {
                        var i = '<div class="thankyou-message">' + t.ThankYouMessage + "</div>";
                        i += '<div class="buttons-container clearfix"><span class="btn blue close-btn">CLOSE</span><span class="btn orange suggest-another-prize"> SUGGEST ANOTHER PRIZE</span> </div>', e(".suggest-a-prize-form").html(i), e(".suggest-a-prize-form").find(".close-btn").click(function(e) {
                            botb.messagePopup.close()
                        }), e(".suggest-a-prize-form").find(".suggest-another-prize").click(function(e) {
                            botb.mainScript.showSuggestAPrizeForm()
                        })
                    }
                }), n.fail(function(e) {})
            })
        })
    }
    function ge() {
        var t = e(".marketing-landing-2018-container");
        0 !== t.length && ke()
    }
    function ke() {
        var t = e(".countdown-clock-container");
        if (0 !== t.length) {
            var i = e(t).attr("data-comp-type"),
                a = e.ajax({
                    type: "GET",
                    url: "/umbraco/api/Prize/GetActiveCompetitionByType?compType=" + i,
                    dataType: "json",
                    contentType: "application/json",
                    async: !0,
                    cache: !1
                });
            a.done(function(t) {
                setInterval(function() {
                    var i = new Date,
                        a = new Date(t.EndDateYear, t.EndDateMonth - 1, t.EndDateDay, t.EndDateHour, t.EndDateMinute, t.EndDateSecond),
                        o = (a - i) / 1e3;
                    if (o > 0) {
                        var r = Math.floor(o / 86400);
                        o -= 86400 * r;
                        var n = Math.floor(o / 3600) % 24;
                        o -= 3600 * n;
                        var s = Math.floor(o / 60) % 60;
                        o -= 60 * s;
                        var l = Math.floor(o);
                        r < 10 && (r = "0" + r), n < 10 && (n = "0" + n), s < 10 && (s = "0" + s), l < 10 && (l = "0" + l), e(".countdown-clock-container").html("                 <div class='clockDigits'>                     <span class='flip-clock-label'>Days</span>                     <div class='clockDigitFrame'>                         <span class='countdown-back'>" + r.toString().split("")[0] + "</span>                         <span class='countdown-back'>" + r.toString().split("")[1] + "</span>                     </div>                 </div>                 <div class='clockDigits'>                     <span class='flip-clock-label'>Hrs</span>                     <div class='clockDigitFrame'>                         <span class='countdown-back'>" + n.toString().split("")[0] + "</span>                         <span class='countdown-back'>" + n.toString().split("")[1] + "</span>                     </div>                 </div>                 <div class='clockDigits'>                     <span class='flip-clock-label'>Mins</span>                     <div class='clockDigitFrame'>                         <span class='countdown-back'>" + s.toString().split("")[0] + "</span>                         <span class='countdown-back'>" + s.toString().split("")[1] + "</span>                     </div>                 </div>                 <div class='clockDigits'>                     <span class='flip-clock-label'>Secs</span>                     <div class='clockDigitFrame'>                         <span class='countdown-back'>" + l.toString().split("")[0] + "</span>                         <span class='countdown-back'>" + l.toString().split("")[1] + "</span>                     </div>                 </div>")
                    }
                }, 1e3)
            }), a.fail(function(i, a, o) {
                e(t).closest(".countdown-clock-width-wac").remove()
            })
        }
    }
    var ye = null,
        $e = null,
        we = null,
        Ce = !1,
        Te = "Please accept our apologies. We cannot currently process your Mastercard on our systems. Please use a different card type e.g. Visa or American Express, or proceed with your MasterCard via PayPal. Thank you and apologies again for the inconvenience.";
    return {
        init: t,
        adventCalendar: G,
        addThisReadyInterval: ye,
        addThisReady: r,
        alternatePageTitle: i,
        checkCardType: D,
        checkoutEvents: g,
        checkoutCompleteEvents: k,
        customPlaceholder: de,
        blogEvents: y,
        switchPaymentMethod: $,
        preDeleteCard: v,
        saveData: L,
        saveCardData: B,
        getCardData: E,
        resetCardForm: A,
        saveCheckoutData: O,
        isCheckoutFormValid: C,
        addCheckoutExtensionItem: z,
        cancelCheckoutExtensionItem: M,
        isRegistrationFormValid: I,
        loginToggle: H,
        welcomePopup: W,
        homepageSliderCloseVideo: ne,
        showSuggestAPrizeForm: be
    }
}(jQuery), $(window).resize(function() {
    BOTBapp.windowResize(), BOTBapp.sizing()
}), $(document).ready(function() {
    BOTBapp.init(), plugins.init(), botb.mainScript.init(), botb.cookie.getCarPrizeCookie(), botb.mainScript.checkoutEvents(), botb.mainScript.checkoutCompleteEvents(), botb.mainScript.blogEvents(), botb.mainScript.adventCalendar(), botb.mainScript.welcomePopup(), setTimeout(function() {
        BOTBapp.adjustTopNavWidth()
    }, 500), $(".currency-menu").click(function() {
        BOTBapp.showNavigation(!1)
    }), $("nav").click(function() {
        BOTBapp.showNavigation(!$(this).hasClass("active")), BOTBapp.hideCart(), BOTBapp.hideCurrencyMenu()
    }), $(".user-menu-credit").click(function() {
        var e = $(".user-menu-credit").find(".arrow-indicator"),
            t = $(".user-menu-credit").find(".drop-btn");
        if ($(".menu-toggle").removeClass("active"), $(e).hasClass("active"))
            $(".user-drop").slideUp("fast"), $(e).removeClass("active"), $(".user-details-header").removeClass("active");
        else {
            $(".user-drop").slideDown("fast"), $(e).addClass("active"), $(".user-details-header").addClass("active");
            var i = $(".cart"),
                a = $(".cart-amount"),
                o = (i.width(), $(".drop-btn").not(t)),
                r = $(".user-btn > ul").not($(".user-menu-credit").find("ul"));
            a.removeClass("active"), i.fadeOut("fast"), o.removeClass("active"), r.slideUp(400, "easeOutExpo")
        }
    }), $("#ShoppingCartController").click(function() {
        BOTBapp.showNavigation(!1), BOTBapp.hideCurrencyMenu(), BOTBapp.closeMyAccountMenu()
    }), $(".menu-toggle").click(function() {
        BOTBapp.hideCurrencyMenu()
    }), $(".content").click(function(e) {
        var t = !1;
        e.target && (t = $(e.target).closest(".ticket-slider-container").length > 0);
        var i = $(".cart-amount"),
            a = $(".cart"),
            o = ($("nav"), $(".menu-toggle"));
        a.width();
        o.removeClass("active"), i.removeClass("active"), t || BOTBapp.hideCart(), BOTBapp.showNavigation(!1), $(".currency-drop").is(":visible") && $(".currency-drop").slideUp(400, "easeOutExpo"), $(".user-drop").is(":visible") && $(".user-drop").slideUp(400, "easeOutExpo")
    }), $(".play-button").click(function(e) {
        var t = this,
            i = $(t).closest(".winner-video"),
            a = "true" == $(t).attr("data-iskiosk");
        if (a)
            botb.videoPopup.play($(t));
        else {
            botb.videoInElement.play($(t), i, "botb.mainScript.homepageSliderCloseVideo(this);"), $(t).closest(".slider-container").find(".bx-controls-direction").hide();
            for (var o = 0; o < winnerSliderArray.length; o++) {
                var r = winnerSliderArray[o],
                    n = $(r).find(e.target);
                n.length > 0 && r.stopAuto()
            }
        }
    }), $(".video-close").click(function(e) {
        botb.video.remove($(this)), e.preventDefault()
    }), $(".read-more-content").addClass("hide").before('<a class="read-more-show" href="#">Read More</a>').append('<a class="read-more-hide" href="#">Read Less</a>'), $(".read-more-show").on("click", function(e) {
        $(this).next(".read-more-content").removeClass("hide"), $(this).addClass("hide"), e.preventDefault()
    }), $(".fancybox-team > img").hover(function() {
        $(this).toggleClass("desaturate")
    }), $(".read-more-hide").on("click", function(e) {
        $(this).parent(".read-more-content").addClass("hide").parent().children(".read-more-show").removeClass("hide"), e.preventDefault()
    }), $("#filterKeywordsButton").click(function() {
        $("html, body").animate({
            scrollTop: $(".tiles").offset().top
        }, 1e3)
    });
    var e = $(".winner-slider-two").children(),
        t = e.length;
    2 != t && $(".winner-slider-one").css("margin", "0 auto").css("float", "none"), $(".PrizeStyle_NewAdditions").click(function() {
        var e = this.children(".icon-liked");
        e.show()
    }), $(".home:first-child").css("padding-top", "0"), $(".PrizeStyle_NewAdditions").hover(function() {
        $(".icon-like").toggleClass("icon-like-hover")
    });
    var i = window.location.href;
    i.contains("winners") && $(".filters-group-toggle > p").hide(), $(".backToTop").click(function(e) {
        e.preventDefault(), $("html,body").animate({
            scrollTop: 0
        }, 700)
    });
    var a = $(".empty .our-cars-link");
    if (a.length > 0) {
        var o = $(a).attr("href");
        o += "?dt=" + (new Date).getTime(), $(a).attr("href", o)
    }
    BOTBapp.windowResize()
}), botb.app.controller("BotB.CashPrizeController", ["$scope", "$location", "$filter", "CashPrizeRepository", "CarPrizeRepository", "$sce", "$q", "$http", "$cookies", "$window", "orderByFilter", function(e, t, i, a, o, r, n, s, l, c, d) {
    var u = -1;
    e.prizes = [], e.repeatLimit = 12, e.timeoutHandle = {}, e.initialLoadFinished = !1, e.addTickets = function(e, t) {
        o.addTickets(u, e, t, function(e) {})
    }, e.init = function(t, i) {
        function o(i) {
            e.prizes = i.Results, e.prizes = d(e.prizes, ["Ordering"]), e.initialLoadFinished = !0;
            var a = 4,
                o = t > 0 ? t : 3 * a;
            e.loadMore = function() {
                o += a, e.repeatLimit += a
            }, e.isHidden = function(e) {
                if (e >= o)
                    return !0
            }
        }
        function r() {
            var t = null;
            $(".icon-plus").unbind("mouseenter").mouseenter(function() {
                t = Date.now();
                var i = this,
                    a = i.getAttribute("prizeid");
                e.timeoutHandle[a] && (clearTimeout(e.timeoutHandle[a]), e.timeoutHandle[a] = null);
                var o = $(i).siblings(".ticket-slider"),
                    r = $(i).closest(".prize-style");
                o.show();
                var n = $(r).find(".img-nest > .icon-wheel:not(.ng-hide)");
                o.hasClass("ng-hide") && n.tooltipster("show"), $(r).unbind("mouseleave").mouseleave(function() {
                    var t = $(r).find(".icon-plus"),
                        i = $(t).siblings(".ticket-slider"),
                        a = t[0].getAttribute("prizeid");
                    e.timeoutHandle[a] = setTimeout(function() {
                        i.hide()
                    }, 1e3)
                }), $(r).unbind("mouseenter").mouseenter(function() {
                    var t = $(r).find(".icon-plus"),
                        i = ($(t).siblings(".ticket-slider"), t[0].getAttribute("prizeid"));
                    e.timeoutHandle[i] && (clearTimeout(e.timeoutHandle[i]), e.timeoutHandle[i] = null)
                })
            }), $(".icon-plus").unbind("mouseleave").mouseleave(function() {
                t = null, $(".icon-wheel").tooltipster("hide")
            }), $(".icon-plus").unbind("click").click(function(e) {
                if (!(null != t && Date.now() - t < 500)) {
                    var i = this,
                        a = $(i).siblings(".ticket-slider"),
                        o = $(i).closest(".prize-style"),
                        r = $(o).find(".img-nest > .icon-wheel:not(.ng-hide)");
                    a.hasClass("ng-hide") && r.tooltipster("show"), $(a).is(":visible") ? $(a).hide() : $(a).show()
                }
            })
        }
        u = i, u !== -1 ? a.prizeSearch(2, t, o) : o({
            Results: ""
        }), e.$on("prizeRepeatFinished", function(e) {
            r()
        })
    }
}]), botb.app.controller("BotB.LifestylePrizeController", ["$scope", "$location", "$filter", "LifestylePrizeRepository", "CarPrizeRepository", "$sce", "$q", "$http", "$cookies", "$window", "orderByFilter", function(e, t, i, a, o, r, n, s, l, d, u) {
    function p(e) {
        return angular.element('input[ng-model="' + e + '"]').attr("value")
    }
    function f(e, t, i, a) {
        angular.element('input[ng-model="' + e + '"]').attr("data-from", t.toString()), angular.element('input[ng-model="' + e + '"]').attr("data-to", i.toString()), angular.element('input[ng-model="' + e + '"]').attr("value", t.toString() + ";" + i.toString()), void 0 != a && null != a && angular.element('input[ng-model="' + e + '"]').attr("data-step", a.toString())
    }
    function m(e, t) {
        var i = null;
        if (t.indexOf(".") != -1 && (i = t.split(".")[1], t = t.split(".")[0]), !e || 0 == e.length)
            return 0;
        for (var a, o = 0; o < e.length; o++)
            null == i ? (!a || parseFloat(e[o][t]) > parseFloat(a[t])) && (a = e[o]) : (!a || parseFloat(e[o][t][i]) > parseFloat(a[t][i])) && (a = e[o]);
        return null == i ? a[t] : a[t][i]
    }
    function h(e, t) {
        var i = null;
        if (t.indexOf(".") != -1 && (i = t.split(".")[1], t = t.split(".")[0]), !e || 0 == e.length)
            return 0;
        for (var a, o = 0; o < e.length; o++)
            null == i ? (!a || parseFloat(e[o][t]) < parseFloat(a[t])) && (a = e[o]) : (!a || parseFloat(e[o][t][i]) < parseFloat(a[t][i])) && (a = e[o]);
        return null == i ? a[t] : a[t][i]
    }
    function v(e, t) {
        var i = e.split(";"),
            a = parseFloat(i[0]),
            o = parseFloat(i[1]);
        return t >= a && t <= o
    }
    var b = -1,
        g = null,
        k = getUrlVars(!0);
    e.prizeCategory = null, e.prizes = [], e.masterPrizes = [], e.repeatLimit = 12, e.timeoutHandle = {}, e.initialLoadFinished = !1, e.showQuickViewModal = !1, e.quickViewPrize = null, e.hasQuickViewModal = !1, e.showFilters = !1, e.quickViewSlider = null, e.selectedTab = null, e.filter = {
        acmake: "",
        acmodel: "",
        sortType: "",
        styles: [],
        make: [],
        myfavourites: !1,
        currencySymbol: null,
        retailprice: p("filter.retailprice"),
        ticketprice: p("filter.ticketprice"),
        enginesize: p("filter.enginesize")
    }, e.addTickets = function(e, t) {
        o.addTickets(b, e, t, function(e) {})
    }, e.init = function(t, i, o, n) {
        function s(a) {
            function o(e) {
                var t = [],
                    i = [];
                for (var a in e)
                    i.indexOf(e[a].Make) === -1 && (i.push(e[a].Make), t.push({
                        type: "make",
                        make: e[a].Make,
                        model: ""
                    }));
                for (var a in e)
                    i.indexOf(e[a].Make + " " + e[a].Model) === -1 && (i.push(e[a].Make + " " + e[a].Model), t.push({
                        type: "makemodel",
                        make: e[a].Make,
                        model: e[a].Model
                    }));
                return t
            }
            function n(e, t) {
                var i = new RegExp("(" + t + ")", "gi");
                return e.replace(i, '<span class="highlight">$1</span>')
            }
            function s(e) {
                for (var t = e.toLowerCase().trim(), i = [], a = 0; a < L.length; a++) {
                    var o = L[a];
                    if ("make" === o.type)
                        o.make.toLowerCase().indexOf(t) !== -1 && i.push({
                            value: o.make,
                            obj: o,
                            label: r.trustAsHtml("<div>" + n(o.make, e) + "</div>")
                        });
                    else if ("makemodel" === o.type) {
                        var s = !1,
                            l = e;
                        o.make.toLowerCase().indexOf(l) === -1 && o.model.toLowerCase().indexOf(l) === -1 || (i.push({
                            value: o.make + " " + o.model,
                            obj: o,
                            label: r.trustAsHtml("<div>" + n(o.make, e) + " " + n(o.model, e) + "</div>")
                        }), s = !0);
                        var c = e.split(" ")[0],
                            d = e.split(" ")[1];
                        void 0 == d ? s || o.make.toLowerCase().indexOf(t) === -1 && o.model.toLowerCase().indexOf(t) === -1 || i.push({
                            value: o.make + " " + o.model,
                            obj: o,
                            label: r.trustAsHtml("<div>" + n(o.make, e) + " " + n(o.model, e) + "</div>")
                        }) : s || o.make.toLowerCase().indexOf(c) !== -1 && o.model.toLowerCase().indexOf(d) !== -1 && i.push({
                            value: o.make + " " + o.model,
                            obj: o,
                            label: r.trustAsHtml("<div>" + n(o.make + " " + o.model, e) + "</div>")
                        })
                    }
                }
                return i
            }
            function c() {
                var t = "." + e.prizeCategory + "-search-field";
                $(t).keypress(function(i) {
                    var a = (i.currentTarget, i.which);
                    if (13 === a) {
                        var o = $(t).val(),
                            r = s(o);
                        return void 0 !== r && r.length > 0 && ($(t).val(r[0].value), e.autocomplete_options.on_select(r[0]), e.$apply()), !1
                    }
                })
            }
            e.prizes = a.Results, e.masterPrizes = angular.copy(e.prizes), e.prizes = u(e.prizes, ["Ordering"]), e.initialLoadFinished = !0, e.showFilters = i <= 0;
            var d = 4,
                b = i > 0 ? i : 3 * d;
            e.loadMore = function() {
                b += d, e.repeatLimit += d
            }, e.isHidden = function(e) {
                if (e >= b)
                    return !0
            }, angular.element(document).ready(function() {
                e.getPrizeCategoryTabs()
            });
            var g = h(a.Results, "RetailPriceGbp"),
                y = m(a.Results, "RetailPriceGbp");
            g = 1e3 * parseInt(Math.floor(parseFloat(g / 1e3)), 10), y = 1e3 * parseInt(Math.ceil(parseFloat(y / 1e3)), 10);
            var w = h(a.Results, "ActiveTicket.Price"),
                C = m(a.Results, "ActiveTicket.Price");
            w = 1 * parseInt(Math.floor(parseFloat(w / 1)), 10), C = 1 * parseInt(Math.ceil(parseFloat(C / 1)), 10);
            var T = h(a.Results, "EngineSizeCC"),
                x = m(a.Results, "EngineSizeCC");
            T = 10 * parseInt(Math.floor(parseFloat(T / 10)), 10), x = 10 * parseInt(Math.ceil(parseFloat(x / 10)), 10), f("filter.retailprice", g, y), C - w > 500 ? (C = 1 * parseInt(100 * Math.ceil(parseFloat(C / 100)), 10), f("filter.ticketprice", w, C, 100)) : f("filter.ticketprice", w, C), f("filter.enginesize", T, x), e.filter.styles = ["All Styles"], e.filter.make = ["All Makes"], e.filter.retailprice = p("filter.retailprice"), e.filter.ticketprice = p("filter.ticketprice"), e.filter.enginesize = p("filter.enginesize");
            var S = $(".our-lifestyle-prizes." + t);
            if (plugins.rangeSlider(S), setTimeout(function() {
                $(window).resize()
            }, 100), $(S).find(".more-filters").click(function(e) {
                $(window).resize()
            }), e.master = angular.copy(e.filter), k.length > 0) {
                for (var z = null, M = 0; M < k.length; M++) {
                    var I = k[M],
                        P = k[I];
                    "prize" === I && ("bikes" !== P && "cash" !== P && "holidays" !== P && "other" !== P && "watches" !== P || (z = P, e.updateTabCookies(P)))
                }
                if (null !== z && t === z)
                    for (var A = $("." + z + "-filter"), M = 0; M < k.length; M++) {
                        var I = k[M],
                            P = k[I];
                        switch (I) {
                        case "styles":
                            var F = [];
                            $(A).find(".filter-styles-container").find(".checkbox-item").each(function() {
                                var e = this,
                                    t = $(e).val(),
                                    i = P.split(",");
                                $(i).each(function() {
                                    var e = this;
                                    t.toLowerCase() === decodeURIComponent(e.toLowerCase()) && F.push(t)
                                })
                            }), F.length > 0 && (e.filter.styles = F);
                            break;
                        case "make":
                            var F = [];
                            $(A).find(".filter-makes-container").find(".checkbox-item").each(function() {
                                var e = this,
                                    t = $(e).val(),
                                    i = P.split(",");
                                $(i).each(function() {
                                    var e = this;
                                    t.toLowerCase() === decodeURIComponent(e.toLowerCase()) && F.push(t)
                                })
                            }), F.length > 0 && (e.filter.make = F);
                            break;
                        case "sort":
                            var B = null;
                            $(A).find(".filter-sort-container").find("select").find("option").each(function() {
                                var e = this,
                                    t = $(e).val();
                                t.toLowerCase() == decodeURIComponent(P.toLowerCase()) && (B = t)
                            }), null !== B && (e.filter.sortType = B)
                        }
                    }
                k.length > 1 && e.UpdateLifestyleCookies()
            }
            e.prizeFilter = function(t) {
                return e.filterResults = !1, (!e.filter.acmake || !t.Make || t.Make.toLowerCase().indexOf(e.filter.acmake.toLowerCase()) !== -1) && ((!e.filter.acmodel || !t.Model || t.Model.toLowerCase().indexOf(e.filter.acmodel.toLowerCase()) !== -1) && (!(e.filter.make && t.Make && e.filter.make.toString().toLowerCase().indexOf(t.Make.toLowerCase()) === -1 && !e.isItemInArray(e.filter.make, "All Makes")) && (!(e.filter.styles && "? undefined:undefined ?" !== e.filter.styles && !e.isItemInArray(e.filter.styles, "All Styles") && !e.arrayMatch(e.filter.styles, t.Styles)) && (!(e.filter.retailprice && !v(e.filter.retailprice, t.RetailPriceGbp)) && (!(e.filter.ticketprice && !v(e.filter.ticketprice, t.ActiveTicket.Price)) && (!(e.filter.enginesize && !v(e.filter.enginesize, t.EngineSizeCC)) && (!(e.filter.myfavourites && !t.UserFavourite) && (e.filterResults = !0, !0))))))))
            }, setTimeout(function() {
                e.setFiltersFromCookies()
            }, 150), $(".searchbar").find(".searchclear").click(function(t) {
                e.clearFilters()
            });
            var L = o(e.prizes);
            e.autocomplete_options = {
                suggest: s,
                on_select: function(t) {
                    if (e.filter.acmake = t.obj.make, e.filter.acmodel = t.obj.model, e.filter.keywordSearch = "", e.filter.make = t.obj.make, e.selected_term = t, "cash" !== e.prizeCategory && "other" !== e.prizeCategory)
                        switch (e.prizeCategory) {
                        case "bikes":
                            l.put("botb-lifestyle-bike-search", t.value), l.put("botb-lifestyle-bike-search-make", t.obj.model);
                            break;
                        case "watches":
                            l.put("botb-lifestyle-watch-search", t.value), l.put("botb-lifestyle-watch-search-make", t.obj.model);
                            break;
                        case "holidays":
                            l.put("botb-lifestyle-holiday-search", t.value), l.put("botb-lifestyle-holiday-search-make", t.obj.model)
                        }
                    var i = $(".cars-tiles").find(".ng-scope.ng-hide");
                    if ("undefined" != typeof dataLayer) {
                        var a = e.prizeCategory + "Search";
                        dataLayer.push({
                            event: a,
                            promo_id: 7,
                            search_term: t.value
                        })
                    }
                    i.length > 0 && $(i).removeClass("ng-hide")
                }
            }, e.setTabFromCookies();
            var O = "",
                E = "",
                D = "";
            switch (e.prizeCategory) {
            case "bikes":
                O = "botb-lifestyle-bike-search", E = "botb-lifestyle-bike-search-make", D = "bikes-search-field";
                break;
            case "watches":
                O = "botb-lifestyle-watch-search", E = "botb-lifestyle-watch-search-make", D = "watches-search-field"
            }
            var R = l.get(O),
                N = l.get(E);
            if (R && N) {
                var V = e.autocomplete_options.suggest(N);
                for (var q in V) {
                    var H = V[q];
                    H.value === wacSearch && ($(D).val(H.value), $(D).trigger("change"), e.autocomplete_options.on_select(H))
                }
            }
            c(), $(".filter-styles-container").find(".arrow").addClass("active"), $(".filter-makes-container").find(".arrow").addClass("active")
        }
        function c() {
            var t = null;
            $(".icon-plus").unbind("mouseenter").mouseenter(function() {
                t = Date.now();
                var i = this,
                    a = i.getAttribute("prizeid");
                e.timeoutHandle[a] && (clearTimeout(e.timeoutHandle[a]), e.timeoutHandle[a] = null);
                var o = $(i).siblings(".ticket-slider"),
                    r = $(i).closest(".prize-style");
                o.show();
                var n = $(r).find(".img-nest > .icon-wheel:not(.ng-hide)");
                o.hasClass("ng-hide") && n.tooltipster("show"), $(r).unbind("mouseleave").mouseleave(function() {
                    var t = $(r).find(".icon-plus"),
                        i = $(t).siblings(".ticket-slider"),
                        a = t[0].getAttribute("prizeid");
                    e.timeoutHandle[a] = setTimeout(function() {
                        i.hide()
                    }, 1e3)
                }), $(r).unbind("mouseenter").mouseenter(function() {
                    var t = $(r).find(".icon-plus"),
                        i = ($(t).siblings(".ticket-slider"), t[0].getAttribute("prizeid"));
                    e.timeoutHandle[i] && (clearTimeout(e.timeoutHandle[i]), e.timeoutHandle[i] = null)
                })
            }), $(".icon-plus").unbind("mouseleave").mouseleave(function() {
                t = null, $(".icon-wheel").tooltipster("hide")
            }), $(".icon-plus").unbind("click").click(function(e) {
                if (!(null != t && Date.now() - t < 500)) {
                    var i = this,
                        a = $(i).siblings(".ticket-slider"),
                        o = $(i).closest(".prize-style"),
                        r = $(o).find(".img-nest > .icon-wheel:not(.ng-hide)");
                    a.hasClass("ng-hide") && r.tooltipster("show"), $(a).is(":visible") ? $(a).hide() : $(a).show()
                }
            })
        }
        b = o, e.prizeCategory = t, "undefined" !== n && (e.filter.currencySymbol = n), b !== -1 ? a.prizeSearch(e.prizeCategory, 0, i, s) : s({
            Results: ""
        }), e.$on("prizeRepeatFinished", function(e) {
            c()
        })
    }, e.getPrizeCategoryTabs = function() {
        var t = $(".lifestyle-prize-category-tabs");
        if (!(t.length > 0)) {
            var i = '<div class="lifestyle-prize-category-tabs-container">   <div class="lifestyle-prize-category-tabs clearfix">       <div data-category="bikes" class="item bikes">            <h3>Bikes</h3>            <img alt="" src="/assets/images/lifestyle/bikes-tab-image.png" />       </div>       <div data-category="cash" class="item cash">           <h3>Cash</h3>           <img alt="" src="/assets/images/lifestyle/cash-tab-image.png" />       </div>       <div data-category="holidays" class="item holidays">           <h3>Holidays</h3>           <img alt="" src="/assets/images/lifestyle/holiday-tab-image.png" />       </div>       <div data-category="other" class="item other">            <h3>Other</h3>            <img alt="" src="/assets/images/lifestyle/tech-tab-image.png" />       </div>       <div data-category="watches" class="item watches">           <h3>Watches</h3>           <img alt="" src="/assets/images/lifestyle/watches-tab-image.png" />       </div>   </div></div>';
            $(".in-the-headlights-container").length > 0 ? $(i).insertBefore($(".in-the-headlights-container")[0]) : $(i).insertBefore($(".our-lifestyle-prizes")[0]), t = $(".lifestyle-prize-category-tabs"), $(".our-lifestyle-prizes.active").hasClass("bikes") ? $(t).find(".item.bikes").addClass("active") : $(".our-lifestyle-prizes.active").hasClass("cash") ? $(t).find(".item.cash").addClass("active") : $(".our-lifestyle-prizes.active").hasClass("holiday") ? $(t).find(".item.holiday").addClass("active") : $(".our-lifestyle-prizes.active").hasClass("other") ? $(t).find(".item.other").addClass("active") : $(".our-lifestyle-prizes.active").hasClass("watches") && $(t).find(".item.watches").addClass("active"), $(t).find(".item").click(function(i) {
                var a = this,
                    o = $(a).closest(".item").attr("data-category");
                $(t).find(".item.active").removeClass("active"), $(a).closest(".item").addClass("active"), $(".in-the-headlights-container").removeClass("active"), $(".in-the-headlights-container." + o).addClass("active"), $(".our-lifestyle-prizes").removeClass("active"), $(".our-lifestyle-prizes." + o).addClass("active"), e.updateTabCookies(o), $(window).resize(), $("html, body").animate({
                    scrollTop: 0
                }, "fast")
            })
        }
    }, e.quickViewMouseOver = function(e) {
        var t = $(window).width()
    }, e.quickViewMouseLeave = function(e) {
        var t = $(window).width()
    }, e.showCarFullDetails = function(e) {
        window.location.href = e
    }, e.playQuickViewVideo = function(e) {
        var t = e.target,
            i = $(t).closest("li");
        botb.videoInElement.play($(t), i)
    }, e.showQuickView = function(t, i) {
        $("." + i).find(".quick-view-container").find(".quntity-input").val("1"), null != e.quickViewSlider && (e.quickViewSlider.destroySlider(), e.quickViewSlider = null), e.quickViewPrize = t, e.showQuickViewModal = !0, $("." + i).find(".quick-view-container").addClass("active"), null != g && (clearTimeout(g), g = null);
        var a = $("." + i).find(".quick-view-container").find("#quick-view-thumbnail-images");
        g = setTimeout(function() {
            e.quickViewSlider = $("." + i).find(".quick-view-container").find(".quick-view-gallery-container .large-images").bxSlider({
                pagerCustom: a,
                auto: !1,
                autoDelay: 2e3,
                pause: 8e3,
                touchEnabled: !0,
                swipeThreshold: 50,
                pager: !0,
                controls: !0,
                infiniteLoop: !0,
                onSlideAfter: function(e, t, i) {
                    var a = $(e).closest(".quick-view-container").find(".close");
                    botb.videoInElement.remove(a)
                }
            })
        }, 1e3), $("." + i).find(".quick-view-container").find(".change").unbind("click"), $("." + i).find(".quick-view-container").find(".change").on("click", BOTBapp.quantity)
    }, e.closeQuickViewModal = function() {
        e.quickViewPrize = null, e.showQuickViewModal = !1, $(".quick-view-container").removeClass("active")
    }, e.quickViewAddToBasket = function(t) {
        var i = $(".quick-view-container").find(".quntity-input").val();
        e.addTickets(t, i), e.closeQuickViewModal()
    }, e.overViewShowPrevious = function(t) {
        var i = findPrizeInArray(t);
        i > 0 && e.showQuickView(e.filteredItems[i - 1])
    }, e.overViewShowNext = function(t) {
        var i = findPrizeInArray(t);
        i != -1 && i < e.filteredItems.length - 1 && e.showQuickView(e.filteredItems[i + 1])
    }, e.updateStylesFilter = function(t, i) {
        setTimeout(function() {
            $("." + t).find("." + i).find(".checkbox-item").each(function() {
                var t = this,
                    i = $(t).val(),
                    a = $(t).is(":checked");
                if (a) {
                    if ("All Styles" == i)
                        return void (e.filter.styles = ["All Styles"]);
                    e.filter.styles = e.addItemToArray(e.filter.styles, i)
                } else
                    e.filter.styles = e.removeItemFromArray(e.filter.styles, i)
            }), e.UpdateLifestyleCookies(), t = "." + t;
            var a = $(t).closest(".controller-container"),
                o = $(a).attr("id");
            $(window).scroll(), angular.element(document.getElementById(o)).scope().$apply()
        }, 150)
    }, e.updateMakesFilter = function(t, i) {
        setTimeout(function() {
            $("." + t).find("." + i).find(".checkbox-item").each(function() {
                var t = this,
                    i = $(t).val(),
                    a = $(t).is(":checked");
                if (a) {
                    if ("All Makes" == i)
                        return void (e.filter.make = ["All Makes"]);
                    e.filter.make = e.addItemToArray(e.filter.make, i)
                } else
                    e.filter.make = e.removeItemFromArray(e.filter.make, i)
            }), e.UpdateLifestyleCookies(), t = "." + t;
            var a = $(t).closest(".controller-container"),
                o = $(a).attr("id");
            $(window).scroll(), angular.element(document.getElementById(o)).scope().$apply()
        }, 150)
    }, e.updateMobileStylesFilter = function(t, i) {
        setTimeout(function() {
            t = "." + t;
            var i = $(t).closest(".controller-container"),
                a = $(i).attr("id");
            e.filter.styles = $(i).find(".styles-filter-dropdown").val(), e.ensureFiltersDataType(), e.UpdateLifestyleCookies(), $(t).find(".filter-styles-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filter.styles, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(t).find(".filter-styles-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(t).find(".filter-styles-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element(document.getElementById(a)).scope().$apply()
        }, 750)
    }, e.updateMobileMakesFilter = function(t, i) {
        setTimeout(function() {
            t = "." + t;
            var i = $(t).closest(".controller-container"),
                a = $(i).attr("id");
            e.filter.make = $(i).find(".makes-filter-dropdown").val(), e.ensureFiltersDataType(), e.UpdateLifestyleCookies(), $(t).find(".filter-makes-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filter.make, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(t).find(".filter-makes-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(t).find(".filter-makes-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element(document.getElementById(a)).scope().$apply()
        }, 750)
    }, e.clearFilters = function() {
        e.dirty = {}, e.filter = angular.copy(e.master), e.prizes = u(e.prizes, ["Ordering"]), $(".range-input").each(function() {
            var e = this;
            $(e).jslider("prc", 0, 100)
        }), t.url(t.path()), $("." + e.prizeCategory + "-filter").find(".botb-multi-select-container").each(function() {
            var e = this,
                t = $(e).find(".list-option-item.all"),
                i = $(e).find(".list-option-item").not(".all");
            $(t).find(".faux-checkbox").addClass("checked").trigger("cssClassChanged"), $(i).find(".faux-checkbox").removeClass("checked"), $(i).find(".checkbox-item").prop("checked", !1)
        }), $(".mobile-filter").each(function() {
            var e = this;
            $(e).find("option").prop("selected", !1)
        });
        var i = "." + e.prizeCategory + "-filter";
        $(i).find(".chosen-select").val("").trigger("chosen:updated"), $(i).find(".filter-sort-container").find(".chosen-single").find("div").removeClass("hide"), $(i).find(".filter-sort-container").find(".remove").remove(), e.UpdateLifestyleCookies(), e.updateBotBMultiSelectPlaceholder(), setTimeout(function() {
            $(window).resize()
        }, 100)
    }, e.updateBotBMultiSelectPlaceholder = function() {
        var t = $("." + e.prizeCategory + "-filter").find(".botb-multi-select-container");
        $(t).each(function() {
            var e = this;
            plugins.updateBotBMultiSelectPlaceholder(e)
        })
    }, e.addItemToArray = function(t, i) {
        return e.isItemInArray(t, i) || t.push(i), t
    }, e.removeItemFromArray = function(e, t) {
        return jQuery.grep(e, function(e) {
            return e != t
        })
    }, e.isItemInArray = function(e, t) {
        var i = !1;
        if (e.constructor === String)
            t.toLowerCase() == e.toLowerCase() && (i = !0);
        else
            for (var a = 0; a < e.length; a++)
                if (e[a].toLowerCase() === t.toLowerCase()) {
                    i = !0;
                    break
                }
        return i
    }, e.arrayMatch = function(e, t) {
        for (var i in e)
            if (t.toString().toLowerCase().indexOf(e[i].toString().toLowerCase()) > -1)
                return !0;
        return !1
    }, e.updateTabCookies = function(e) {
        void 0 != e && e.length > 0 && l.put("botb-lifestyle-selected-tab", e)
    }, e.UpdateLifestyleCookies = function() {
        if ("cash" !== e.prizeCategory) {
            switch (e.filter.styles = null === e.filter.styles || "" == e.filter.styles.toString() ? "All Styles" : e.filter.styles, e.filter.make = null === e.filter.make || "" == e.filter.make.toString() ? "All Makes" : e.filter.make, e.ensureFiltersDataType(), e.prizeCategory) {
            case "cash":
                break;
            case "holidays":
                l.put("botb-lifestyle-holiday-styles", e.filter.styles.toString()), l.put("botb-lifestyle-holiday-ticketprice", e.filter.ticketprice), l.put("botb-lifestyle-holiday-sort-type", e.filter.sortType);
                break;
            case "other":
                l.put("botb-lifestyle-other-styles", e.filter.styles.toString()), l.put("botb-lifestyle-other-ticketprice", e.filter.ticketprice), l.put("botb-lifestyle-other-sort-type", e.filter.sortType);
                break;
            case "bikes":
                l.put("botb-lifestyle-bike-styles", e.filter.styles.toString()), l.put("botb-lifestyle-bike-make", e.filter.make.toString()), l.put("botb-lifestyle-bike-ticketprice", e.filter.ticketprice), l.put("botb-lifestyle-bike-retailprice", e.filter.retailprice), l.put("botb-lifestyle-bike-enginesize", e.filter.enginesize), l.put("botb-lifestyle-bike-sort-type", e.filter.sortType);
                break;
            case "watches":
                l.put("botb-lifestyle-watch-styles", e.filter.styles.toString()), l.put("botb-lifestyle-watch-make", e.filter.make.toString()), l.put("botb-lifestyle-watch-ticketprice", e.filter.ticketprice), l.put("botb-lifestyle-watch-sort-type", e.filter.sortType)
            }
            var t = $(".lifestyle-tiles").find(".ng-scope.ng-hide");
            t.length > 0 && $(t).removeClass("ng-hide")
        }
    }, e.ClearLifestyleCookies = function() {
        switch (e.prizeCategory) {
        case "cash":
            break;
        case "holidays":
            l.remove("botb-lifestyle-holiday-styles"), l.remove("botb-lifestyle-holiday-ticketprice"),
            l.remove("botb-lifestyle-holiday-sort-type");
            break;
        case "other":
            l.remove("botb-lifestyle-other-styles"), l.remove("botb-lifestyle-other-ticketprice"), l.remove("botb-lifestyle-other-sort-type");
            break;
        case "bikes":
            l.remove("botb-lifestyle-bike-styles"), l.remove("botb-lifestyle-bike-make"), l.remove("botb-lifestyle-bike-ticketprice"), l.remove("botb-lifestyle-bike-retailprice"), l.remove("botb-lifestyle-bike-enginesize"), l.remove("botb-lifestyle-bike-search"), l.remove("botb-lifestyle-bike-search-make"), l.remove("botb-lifestyle-bike-sort-type");
            break;
        case "watches":
            l.remove("botb-lifestyle-watch-styles"), l.remove("botb-lifestyle-watch-make"), l.remove("botb-lifestyle-watch-ticketprice"), l.remove("botb-lifestyle-watch-search"), l.remove("botb-lifestyle-watch-search-make"), l.remove("botb-lifestyle-watch-sort-type")
        }
    }, e.setTabFromCookies = function() {
        e.selectedTab = l.get("botb-lifestyle-selected-tab"), void 0 != e.selectedTab && e.selectedTab.length > 0 && (c = $(".lifestyle-prize-category-tabs"), $(c).find(".item.active").removeClass("active"), $(c).find(".item." + e.selectedTab).addClass("active"), $(".in-the-headlights-container").removeClass("active"), $(".in-the-headlights-container." + e.selectedTab).addClass("active"), $(".our-lifestyle-prizes").removeClass("active"), $(".our-lifestyle-prizes." + e.selectedTab).addClass("active"))
    }, e.setFiltersFromCookies = function() {
        switch (e.prizeCategory) {
        case "cash":
            break;
        case "holidays":
            var t = $(".holidays-filter"),
                i = l.get("botb-lifestyle-holiday-styles");
            i ? ($(t).find(".filter-styles-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(i.split(","), $(t).val().toLowerCase()) ? (e.filter.styles = i.split(","), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
            }), e.filter.styles = i) : l.remove("botb-lifestyle-bike-styles");
            var a = l.get("botb-lifestyle-holiday-sort-type");
            a && (e.filter.sortType = a, e.applySortReset());
            break;
        case "other":
            var o = l.get("botb-lifestyle-other-sort-type");
            o && (e.filter.sortType = o, e.applySortReset());
            break;
        case "bikes":
            var r = $(".bikes-filter"),
                n = l.get("botb-lifestyle-bike-styles");
            n ? ($(r).find(".filter-styles-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(n.split(","), $(t).val().toLowerCase()) ? (e.filter.styles = n.split(","), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
            }), e.filter.styles = n) : l.remove("botb-lifestyle-bike-styles");
            var s = l.get("botb-lifestyle-bike-make");
            s ? ($(r).find(".filter-makes-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(s.split(","), $(t).val().toLowerCase()) ? (e.filter.make = s.split(","), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
            }), e.filter.make = s) : l.remove("botb-lifestyle-bike-make");
            var c = l.get("botb-lifestyle-bike-ticketprice");
            c && (e.filter.ticketprice = c, $(r).find('input[ng-model="filter.ticketprice"]').jslider("value", c.split(";")[0], c.split(";")[1]));
            var d = l.get("botb-lifestyle-bike-retailprice");
            d && (e.filter.retailprice = d, $(r).find('input[ng-model="filter.retailprice"]').jslider("value", d.split(";")[0], d.split(";")[1]));
            var u = l.get("botb-lifestyle-bike-enginesize");
            u && (e.filter.enginesize = u, $(r).find('input[ng-model="filter.enginesize"]').jslider("value", u.split(";")[0], u.split(";")[1]));
            var p = l.get("botb-lifestyle-bike-sort-type");
            p && (e.filter.sortType = p, e.applySortReset());
            break;
        case "watches":
            var f = $(".watches-filter"),
                m = l.get("botb-lifestyle-watch-styles");
            m ? ($(f).find(".filter-styles-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(m.split(","), $(t).val().toLowerCase()) ? (e.filter.styles = m.split(","), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
            }), e.filter.styles = m) : l.remove("botb-lifestyle-watch-styles");
            var h = l.get("botb-lifestyle-watch-make");
            h ? ($(f).find(".filter-makes-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(h.split(","), $(t).val().toLowerCase()) ? (e.filter.make = h.split(","), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
            }), e.filter.make = h) : l.remove("botb-lifestyle-watch-make");
            var v = l.get("botb-lifestyle-watch-ticketprice");
            v && (e.filter.ticketprice = v, $(f).find('input[ng-model="filter.ticketprice"]').jslider("value", v.split(";")[0], v.split(";")[1]));
            var b = l.get("botb-lifestyle-watch-sort-type");
            b && (e.filter.sortType = b, e.applySortReset())
        }
        e.ensureFiltersDataType()
    }, e.toggleFavourites = function() {
        e.filter.myfavourites ? e.filter.myfavourites = !1 : e.filter.myfavourites = !0
    }, e.sortResult = function() {
        switch (e.filter.sortType) {
        case "recommended":
            e.prizes = u(e.prizes, [e.getAvailableSortGroup, "-ActiveTicket.Price", "Make", "Model"]);
            break;
        case "price-high-to-low":
            e.prizes = u(e.prizes, ["-ActiveTicket.Price", "Make", "Model"]);
            break;
        case "price-low-to-high":
            e.prizes = u(e.prizes, ["ActiveTicket.Price", "Make", "Model"]);
            break;
        case "a-to-z":
            e.prizes = u(e.prizes, ["Make", "Model"]);
            break;
        case "z-to-a":
            e.prizes = u(e.prizes, ["-Make", "-Model"])
        }
        e.UpdateLifestyleCookies(), e.applySortReset()
    }, e.applySortReset = function() {
        var t = "." + e.prizeCategory + "-filter",
            i = '<div class="remove active"><b></b></div>';
        $(i).insertBefore($(t).find(".filter-sort-container").find(".chosen-drop")), $(t).find(".filter-sort-container").find(".chosen-single").find("div").addClass("hide"), $(t).find(".filter-sort-container").find(".remove").unbind("click").click(function(t) {
            var i = "." + e.prizeCategory + "-filter";
            $(i).find(".chosen-select").val("").trigger("chosen:updated"), $(i).find(".filter-sort-container").find(".chosen-single").find("div").removeClass("hide"), $(i).find(".filter-sort-container").find(".remove").remove(), e.filter.sortType = "", e.prizes = e.masterPrizes, l.remove("botb-lifestyle-sort-type"), e.$apply()
        })
    }, e.getAvailableSortGroup = function(e) {
        return null === e.SortGroup ? 1e4 : e.SortGroup
    }, e.ensureFiltersDataType = function() {
        var t = [];
        e.filter.styles.constructor !== Array && (t.push(e.filter.styles.toString()), e.filter.styles = t);
        var i = [];
        e.filter.make.constructor !== Array && (i.push(e.filter.make.toString()), e.filter.make = i)
    }
}]), botb.app.controller("BotB.LifestyleVoteController", ["$scope", "$location", "$filter", "$sce", "$q", "$http", "$cookies", "$window", "orderByFilter", "LifestylePrizeRepository", function(e, t, i, a, o, r, n, s, l, c) {
    e.prizes = [], e.lazyPrizes = [], e.userVoted = !1, e.init = function(t) {
        e.lazyPrizes = t, e.$on("prizeRepeatFinished", function(t) {
            e.addVoteEvents()
        })
    }, e.closeVotePopup = function() {
        $(".lifestyle-vote-container").removeClass("active"), e.userVoted && $(".lifestyle-poll-buttons-container").find(".vote").addClass("disabled")
    }, e.showPrizes = function() {
        e.prizes = e.lazyPrizes, e.$apply()
    }, e.addVoteEvents = function() {}, e.registerVote = function(t, i) {
        var a = t.currentTarget;
        if (!$(a).hasClass("disabled")) {
            c.registerVote(i, e.registerVoteCallback);
            var o = $(a).closest(".unit").find(".vote-now");
            $(o).addClass("disabled").text("SELECTED"), $(".vote-popup-container").find(".vote-now").not(o).remove(), $(".vote-popup-container").find(".done").addClass("active"), e.userVoted = !0
        }
    }, e.registerVoteCallback = function(e) {}
}]), botb.app.controller("BotB.PrizeController", ["$scope", "$location", "$filter", "CarPrizeRepository", "$sce", "$q", "$http", "$cookies", "$window", "orderByFilter", function(e, t, i, a, o, r, n, s, l, c) {
    function d(t) {
        for (var i = 0; i < e.filteredItems.length; i++)
            if (e.filteredItems[i].ContentNodeId == t)
                return i;
        return -1
    }
    function u(e) {
        return angular.element('input[ng-model="' + e + '"]').attr("value")
    }
    function p(e, t, i, a) {
        angular.element('input[ng-model="' + e + '"]').attr("data-from", t.toString()), angular.element('input[ng-model="' + e + '"]').attr("data-to", i.toString()), angular.element('input[ng-model="' + e + '"]').attr("value", t.toString() + ";" + i.toString()), void 0 != a && null != a && angular.element('input[ng-model="' + e + '"]').attr("data-step", a.toString())
    }
    function f(e, t) {
        var i = null;
        if (t.indexOf(".") != -1 && (i = t.split(".")[1], t = t.split(".")[0]), !e || 0 == e.length)
            return 0;
        for (var a, o = 0; o < e.length; o++)
            null == i ? (!a || parseInt(e[o][t]) > parseInt(a[t])) && (a = e[o]) : (!a || parseInt(e[o][t][i]) > parseInt(a[t][i])) && (a = e[o]);
        return null == i ? a[t] : a[t][i]
    }
    function m(e, t) {
        var i = null;
        if (t.indexOf(".") != -1 && (i = t.split(".")[1], t = t.split(".")[0]), !e || 0 == e.length)
            return 0;
        for (var a, o = 0; o < e.length; o++)
            null == i ? (!a || parseInt(e[o][t]) < parseInt(a[t])) && (a = e[o]) : (!a || parseInt(e[o][t][i]) < parseInt(a[t][i])) && (a = e[o]);
        return null == i ? a[t] : a[t][i]
    }
    function h() {
        $(window).resize(function() {
            $(".mobile-filter:visible").length > 0 && (e.updateMobileMakesFilter(), e.updateMobileStylesFilter())
        })
    }
    var v = -1,
        b = getUrlVars(!0),
        g = null;
    e.prizes = [], e.masterPrizes = [], e.initCompleted = !1, e.repeatLimit = 12, e.timeoutHandle = {}, e.kioskPopupTimer = null, e.showQuickViewModal = !1, e.quickViewPrize = null, e.enableMultibuy = !1, e.initialLoadFinished = !1, e.quickViewSlider = null, e.itemLimit = null, e.showFilters = !1, e.filter = {
        sortType: "",
        acmake: "",
        acmodel: "",
        styles: [],
        make: [],
        myfavourites: !1,
        currencySymbol: null,
        retailprice: u("filter.retailprice"),
        ticketprice: u("filter.ticketprice"),
        topspeed: u("filter.topspeed"),
        zero60: u("filter.zero60"),
        power: u("filter.power"),
        keywordSearch: ""
    }, e.addTickets = function(e, t) {
        a.addTickets(v, e, t, function(e) {})
    }, e.updateStylesFilter = function(t) {
        setTimeout(function() {
            $("." + t).find(".checkbox-item").each(function() {
                var t = this,
                    i = $(t).val(),
                    a = $(t).is(":checked");
                a ? e.filter.styles = e.addItemToArray(e.filter.styles, i) : e.filter.styles = e.removeItemFromArray(e.filter.styles, i)
            }), e.UpdateWACCookies(), $(window).scroll(), angular.element(document.getElementById("our-cars-controller-container")).scope().$apply()
        }, 150)
    }, e.updateMakesFilter = function(t) {
        setTimeout(function() {
            $("." + t).find(".checkbox-item").each(function() {
                var t = this,
                    i = $(t).val(),
                    a = $(t).is(":checked");
                a ? e.filter.make = e.addItemToArray(e.filter.make, i) : e.filter.make = e.removeItemFromArray(e.filter.make, i)
            }), e.UpdateWACCookies(), $(window).scroll(), angular.element(document.getElementById("our-cars-controller-container")).scope().$apply()
        }, 150)
    }, e.updateMobileStylesFilter = function() {
        setTimeout(function() {
            if (e.filter.styles = $(".styles-filter-dropdown").val(), e.UpdateWACCookies(), $(".filter-styles-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filter.styles, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-styles-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-styles-container").find(".arrow").addClass("active"), $(".sticky-filter-wrapper").hasClass("sticky")) {
                $(".counter").height(), $(".in-the-headlights-container").height()
            }
            $(window).scroll(), angular.element(document.getElementById("our-cars-controller-container")).scope().$apply()
        }, 750)
    }, e.updateMobileMakesFilter = function() {
        setTimeout(function() {
            if (e.filter.make = $(".makes-filter-dropdown").val(), e.UpdateWACCookies(), $(".filter-makes-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filter.make, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-makes-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-makes-container").find(".arrow").addClass("active"), $(".sticky-filter-wrapper").hasClass("sticky")) {
                $(".counter").height(), $(".in-the-headlights-container").height()
            }
            $(window).scroll(), angular.element(document.getElementById("our-cars-controller-container")).scope().$apply()
        }, 750)
    }, e.addItemToArray = function(t, i) {
        return e.isItemInArray(t, i) || t.push(i), t
    }, e.removeItemFromArray = function(e, t) {
        return jQuery.grep(e, function(e) {
            return e != t
        })
    }, e.isItemInArray = function(e, t) {
        var i = !1;
        if (e.constructor === String)
            t.toLowerCase() == e.toLowerCase() && (i = !0);
        else
            for (var a = 0; a < e.length; a++)
                if (e[a].toLowerCase() === t.toLowerCase()) {
                    i = !0;
                    break
                }
        return i
    }, e.UpdateWACCookies = function() {
        e.filter.styles = e.filter.styles = "" == e.filter.styles.toString() ? "All Styles" : e.filter.styles, e.filter.make = null == e.filter.make || "" == e.filter.make.toString() ? "All Makes" : e.filter.make;
        var t = [];
        e.filter.styles.constructor !== Array && (t.push(e.filter.styles.toString()), e.filter.styles = t);
        var i = [];
        e.filter.make.constructor !== Array && (i.push(e.filter.make.toString()), e.filter.make = i), s.put("botb-wac-styles", e.filter.styles.toString()), s.put("botb-wac-make", e.filter.make.toString()), s.put("botb-wac-myfavourites", e.filter.myfavourites), s.put("botb-wac-retailprice", e.filter.retailprice), s.put("botb-wac-ticketprice", e.filter.ticketprice), s.put("botb-wac-topspeed", e.filter.topspeed), s.put("botb-wac-zero60", e.filter.zero60), s.put("botb-wac-power", e.filter.power), s.put("botb-wac-sort-type", e.filter.sortType);
        var a = $(".cars-tiles").find(".ng-scope.ng-hide");
        a.length > 0 && $(a).removeClass("ng-hide"), "undefined" != typeof dataLayer && dataLayer.push({
            event: "makeSelected",
            promo_id: 3,
            make: e.filter.make
        })
    }, e.ClearWACCookies = function() {
        s.remove("botb-wac-styles"), s.remove("botb-wac-make"), s.remove("botb-wac-myfavourites"), s.remove("botb-wac-retailprice"), s.remove("botb-wac-ticketprice"), s.remove("botb-wac-topspeed"), s.remove("botb-wac-zero60"), s.remove("botb-wac-power"), s.remove("botb-wac-search"), s.remove("botb-wac-search-make"), s.remove("botb-wac-scroll"), s.remove("botb-wac-sort-type")
    }, e.showKioskPopupConfirmation = function() {
        if ($("body").hasClass("pp-kiosk")) {
            var t = !1,
                i = Date.now() / 1e3;
            if (null == e.kioskPopupTimer ? (t = !0, e.kioskPopupTimer = i) : i - e.kioskPopupTimer >= 90 && (t = !0, e.kioskPopupTimer = i), t) {
                botb.messagePopup.isShown() && botb.messagePopup.close();
                var a = "",
                    o = $(".loggedInAsStyle"),
                    r = $(o).find(".customer-text").attr("data-customer-name"),
                    n = $(o).find(".staff-text").attr("data-staff-name");
                void 0 != r ? a = "Hello " + r + "<br /><br /> You are being served by " + n : void 0 != n && (a = "You are being served by " + n), "" != a && botb.messagePopup.show(a)
            }
        }
    }, e.quickViewMouseOver = function(e) {
        var t = $(window).width();
        if (!(t <= 768)) {
            var i = e.currentTarget;
            $(i).find(".prize-make").removeClass("active"), $(i).find(".prize-multibuy").addClass("active"), $(i).find(".prize-model").addClass("active")
        }
    }, e.quickViewMouseLeave = function(e) {
        var t = $(window).width();
        if (!(t <= 768)) {
            var i = e.currentTarget;
            $(i).find(".prize-make").addClass("active"), $(i).find(".prize-multibuy").removeClass("active"), $(i).find(".prize-model").removeClass("active")
        }
    }, e.showCarFullDetails = function(e) {
        window.location.href = e
    }, e.playQuickViewVideo = function(e) {
        var t = e.target,
            i = $(t).closest("li");
        botb.videoInElement.play($(t), i)
    }, e.showQuickView = function(t) {
        $(".quick-view-container").find(".quntity-input").val("1"), null !== e.quickViewSlider && (e.quickViewSlider.destroySlider(), e.quickViewSlider = null), e.quickViewPrize = t, e.showQuickViewModal = !0, $(".quick-view-container").addClass("active"), null !== g && (clearTimeout(g), g = null), $(".quick-view-gallery-container").addClass("loading"), g = setTimeout(function() {
            e.quickViewSlider = $(".quick-view-container").find(".quick-view-gallery-container .large-images").bxSlider({
                pagerCustom: "#quick-view-thumbnail-images",
                auto: !1,
                autoDelay: 2e3,
                pause: 8e3,
                touchEnabled: !0,
                swipeThreshold: 50,
                pager: !0,
                controls: !0,
                infiniteLoop: !0,
                onSliderLoad: function(e) {
                    $(".quick-view-gallery-container").removeClass("loading"), $(window).resize()
                },
                onSlideAfter: function(e, t, i) {
                    var a = $(e).closest(".quick-view-container").find(".close");
                    botb.videoInElement.remove(a)
                }
            })
        }, 700), $(".quick-view-container").find(".change").unbind("click"), $(".quick-view-container").find(".change").on("click", BOTBapp.quantity)
    }, e.closeQuickViewModal = function() {
        e.quickViewPrize = null, e.showQuickViewModal = !1, $(".quick-view-container").removeClass("active")
    }, e.quickViewAddToBasket = function(t) {
        var i = $(".quick-view-container").find(".quntity-input").val();
        e.addTickets(t, i), e.closeQuickViewModal()
    }, e.overViewShowPrevious = function(t) {
        var i = d(t);
        i > 0 && e.showQuickView(e.filteredItems[i - 1])
    }, e.overViewShowNext = function(t) {
        var i = d(t);
        i != -1 && i < e.filteredItems.length - 1 && e.showQuickView(e.filteredItems[i + 1])
    }, e.toggleFavourites = function() {
        e.filter.myfavourites ? e.filter.myfavourites = !1 : e.filter.myfavourites = !0, e.UpdateWACCookies()
    }, e.getAvailableSortGroup = function(e) {
        return null == e.SortGroup ? 1e4 : e.SortGroup
    }, e.sortResult = function() {
        switch (e.filter.sortType) {
        case "recommended":
            e.prizes = c(e.prizes, [e.getAvailableSortGroup, "-ActiveTicket.Price", "Make", "Model"]);
            break;
        case "price-high-to-low":
            e.prizes = c(e.prizes, ["-ActiveTicket.Price", "Make", "Model"]);
            break;
        case "price-low-to-high":
            e.prizes = c(e.prizes, ["ActiveTicket.Price", "Make", "Model"]);
            break;
        case "a-to-z":
            e.prizes = c(e.prizes, ["Make", "Model"]);
            break;
        case "z-to-a":
            e.prizes = c(e.prizes, ["-Make", "-Model"])
        }
        e.UpdateWACCookies(), e.applySortReset()
    }, e.applySortReset = function() {
        var t = '<div class="remove active"><b></b></div>';
        $(t).insertBefore($(".filter-sort-container").find(".chosen-drop")), $(".filter-sort-container").find(".chosen-single").find("div").addClass("hide"), $(".filter-sort-container").find(".remove").unbind("click").click(function(t) {
            $(".chosen-select").val("").trigger("chosen:updated"), $(".filter-sort-container").find(".chosen-single").find("div").removeClass("hide"), $(".filter-sort-container").find(".remove").remove(), e.filter.sortType = "", e.prizes = e.masterPrizes, s.remove("botb-wac-sort-type"), e.$apply()
        })
    };
    var k = function(e) {
        var t,
            i,
            a = e.substring(1).split("&"),
            o = {};
        for (i in a)
            "" !== a[i] && (t = a[i].split("="), o[decodeURIComponent(t[0])] = decodeURIComponent(t[1]));
        return o
    };
    e.init = function(i, r, n, l, d) {
        function g(t) {
            function a(e, t) {
                var i = e.split(";"),
                    a = parseInt(i[0]),
                    o = parseInt(i[1]);
                return t >= a && t <= o
            }
            function r(e) {
                var t = [],
                    i = [];
                for (var a in e)
                    i.indexOf(e[a].Make) == -1 && (i.push(e[a].Make), t.push({
                        type: "make",
                        make: e[a].Make,
                        model: ""
                    }));
                for (var a in e)
                    i.indexOf(e[a].Make + " " + e[a].Model) == -1 && (i.push(e[a].Make + " " + e[a].Model), t.push({
                        type: "makemodel",
                        make: e[a].Make,
                        model: e[a].Model
                    }));
                return t
            }
            function n(e, t) {
                var i = new RegExp("(" + t + ")", "gi");
                return e.replace(i, '<span class="highlight">$1</span>')
            }
            function l(e) {
                for (var t = e.toLowerCase().trim(), i = [], a = 0; a < F.length; a++) {
                    var r = F[a];
                    if ("make" === r.type)
                        r.make.toLowerCase().indexOf(t) !== -1 && i.push({
                            value: r.make,
                            obj: r,
                            label: o.trustAsHtml("<div>" + n(r.make, e) + "</div>")
                        });
                    else if ("makemodel" === r.type) {
                        var s = !1,
                            l = e;
                        r.make.toLowerCase().indexOf(l) === -1 && r.model.toLowerCase().indexOf(l) === -1 || (i.push({
                            value: r.make + " " + r.model,
                            obj: r,
                            label: o.trustAsHtml("<div>" + n(r.make, e) + " " + n(r.model, e) + "</div>")
                        }), s = !0);
                        var c = e.split(" ")[0],
                            d = e.split(" ")[1];
                        void 0 == d ? s || r.make.toLowerCase().indexOf(t) === -1 && r.model.toLowerCase().indexOf(t) === -1 || i.push({
                            value: r.make + " " + r.model,
                            obj: r,
                            label: o.trustAsHtml("<div>" + n(r.make, e) + " " + n(r.model, e) + "</div>")
                        }) : s || r.make.toLowerCase().indexOf(c) !== -1 && r.model.toLowerCase().indexOf(d) !== -1 && i.push({
                            value: r.make + " " + r.model,
                            obj: r,
                            label: o.trustAsHtml("<div>" + n(r.make + " " + r.model, e) + "</div>")
                        })
                    }
                }
                return i
            }
            function d() {
                var t = k(window.location.search),
                    i = t.styles,
                    a = t.make,
                    o = t.ticketprice;
                (i || a || o) && (e.filter.make = [], e.filter.ticketprice = "", e.filter.styles = [], s.put("botb-wac-make", e.filter.make.toString()), s.put("botb-wac-ticketprice", e.filter.ticketprice), s.put("botb-wac-styles", e.filter.styles.toString()), e.clearFilters()), a && $(".filter-makes-container").find(".checkbox-item").each(function() {
                    var t = this;
                    e.isItemInArray(a.split(","), $(t).val().toLowerCase()) ? (e.filter.make = a, s.put("botb-wac-make", e.filter.make.toString()), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
                }), o && (e.filter.ticketprice = o, s.put("botb-wac-ticketprice", e.filter.ticketprice), $('input[ng-model="filter.ticketprice"]').jslider("value", o.split(";")[0], o.split(";")[1])), i && $(".filter-styles-container").find(".checkbox-item").each(function() {
                    var t = this;
                    e.isItemInArray(i.split(","), $(t).val().toLowerCase()) ? (e.filter.styles = i.split(","), s.put("botb-wac-styles", e.filter.styles.toString()), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
                })
            }
            function v() {
                var t = s.get("botb-wac-styles");
                t ? $(".filter-styles-container").find(".checkbox-item").each(function() {
                    var i = this;
                    e.isItemInArray(t.split(","), $(i).val().toLowerCase()) ? (e.filter.styles = t.split(","), $(i).prop("checked", !0), $(i).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(i).prop("checked", !1), $(i).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
                }) : s.remove("botb-wac-styles");
                var i = s.get("botb-wac-make");
                i ? $(".filter-makes-container").find(".checkbox-item").each(function() {
                    var t = this;
                    e.isItemInArray(i.split(","), $(t).val().toLowerCase()) ? (e.filter.make = i.split(","), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
                }) : s.remove("botb-wac-make");
                var a = s.get("botb-wac-myfavourites");
                a && (e.filter.myfavourites = "true" == a);
                var o = s.get("botb-wac-retailprice");
                o && (e.filter.retailprice = o, $('input[ng-model="filter.retailprice"]').jslider("value", o.split(";")[0], o.split(";")[1]));
                var r = s.get("botb-wac-ticketprice");
                r && (e.filter.ticketprice = r, $('input[ng-model="filter.ticketprice"]').jslider("value", r.split(";")[0], r.split(";")[1]));
                var n = s.get("botb-wac-topspeed");
                n && (e.filter.topspeed = n, $('input[ng-model="filter.topspeed"]').jslider("value", n.split(";")[0], n.split(";")[1]));
                var l = s.get("botb-wac-zero60");
                l && (e.filter.zero60 = l, $('input[ng-model="filter.zero60"]').jslider("value", l.split(";")[0], l.split(";")[1]));
                var c = s.get("botb-wac-power");
                c && (e.filter.power = c, $('input[ng-model="filter.power"]').jslider("value", c.split(";")[0], c.split(";")[1]));
                var d = s.get("botb-wac-search"),
                    u = s.get("botb-wac-search-make");
                if (d && u) {
                    var p = e.autocomplete_options.suggest(u);
                    for (var f in p) {
                        var m = p[f];
                        m.value === d && ($(".wac-searchField").val(m.value), $(".wac-searchField").trigger("change"), e.autocomplete_options.on_select(m))
                    }
                }
                var h = s.get("botb-wac-scroll");
                if (h)
                    var v = setInterval(function() {
                        e.loadMore(), e.$apply(), $(document).height() >= h && (e.loadMore(), e.$apply(), e.loadMore(), e.$apply(), $(document).scrollTop(h), clearInterval(v))
                    }, 100);
                var b = s.get("botb-wac-sort-type");
                b && (e.filter.sortType = b, e.applySortReset()), $(window).scroll(function() {
                    s.put("botb-wac-scroll", $(document).scrollTop())
                })
            }
            function b() {
                $(".wac-searchField").keyup(function(t) {
                    var i = (t.currentTarget, t.which),
                        a = $(".wac-searchField").val(),
                        o = l(a);
                    if (13 === i)
                        return void 0 !== o && o.length > 0 && ($(".wac-searchField").val(o[0].value), e.autocomplete_options.on_select(o[0]), e.$apply()), !1;
                    e.filter.keywordSearch = a, e.$apply();
                    var r = $(".cars-tiles").find(".ng-scope.ng-hide");
                    r.length > 0 && $(r).removeClass("ng-hide")
                })
            }
            e.prizes = t.Results, e.masterPrizes = angular.copy(e.prizes), e.prizes = c(e.prizes, ["Ordering"]), e.filterResults = !1, e.dirty = {};
            var g = m(t.Results, "RetailPriceGbp"),
                y = f(t.Results, "RetailPriceGbp");
            g = 1e3 * parseInt(Math.floor(parseFloat(g / 1e3)), 10), y = 1e3 * parseInt(Math.ceil(parseFloat(y / 1e3)), 10);
            var w = m(t.Results, "ActiveTicket.Price"),
                C = f(t.Results, "ActiveTicket.Price");
            w = 1 * parseInt(Math.floor(parseFloat(w / 1)), 10), C = 1 * parseInt(Math.ceil(parseFloat(C / 1)), 10);
            var T = m(t.Results, "TopSpeed"),
                x = f(t.Results, "TopSpeed");
            T = 10 * parseInt(Math.floor(parseFloat(T / 10)), 10), x = 10 * parseInt(Math.ceil(parseFloat(x / 10)), 10);
            var S = m(t.Results, "MphTime"),
                z = f(t.Results, "MphTime");
            S = 1 * parseInt(Math.floor(parseFloat(S / 1)), 10), z = 1 * parseInt(Math.ceil(parseFloat(z / 1)), 10);
            var M = m(t.Results, "Power"),
                I = f(t.Results, "Power");
            M = 10 * parseInt(Math.floor(parseFloat(M / 10)), 10), I = 10 * parseInt(Math.ceil(parseFloat(I / 10)), 10), p("filter.retailprice", g, y), C - w > 500 ? (C = 1 * parseInt(100 * Math.ceil(parseFloat(C / 100)), 10), p("filter.ticketprice", w, C, 100)) : p("filter.ticketprice", w, C), p("filter.topspeed", T, x), p("filter.zero60", S, z), p("filter.power", M, I), e.filter.styles = ["All Styles"], e.filter.make = ["All Makes"], e.filter.retailprice = u("filter.retailprice"), e.filter.ticketprice = u("filter.ticketprice"), e.filter.topspeed = u("filter.topspeed"), e.filter.zero60 = u("filter.zero60"), e.filter.power = u("filter.power"), 0 === t.Results.length && $(".filters-group").hide(), plugins.rangeSlider(), setTimeout(function() {
                $(window).resize()
            }, 100), e.master = angular.copy(e.filter), e.showFilters = i <= 0, e.initialLoadFinished = !0;
            var P = 4,
                A = i > 0 ? i : 3 * P;
            if (e.loadMore = function() {
                A += P, e.repeatLimit += P
            }, e.isHidden = function(e) {
                if (e >= A)
                    return !0
            }, e.showFilters) {
                e.prizeFilter = function(t) {
                    if (e.filterResults = !1, "" != e.filter.keywordSearch) {
                        var i = e.filter.keywordSearch.split(" ")[0],
                            o = e.filter.keywordSearch.split(" ")[1];
                        if (void 0 == o) {
                            if (t.Make.toLowerCase().indexOf(e.filter.keywordSearch) !== -1 || t.Model.toLowerCase().indexOf(e.filter.keywordSearch) !== -1)
                                return !0
                        } else if (t.Make.toLowerCase().indexOf(i) !== -1 && t.Model.toLowerCase().indexOf(o) !== -1)
                            return !0;
                        return !1
                    }
                    return (!e.filter.acmake || !t.Make || t.Make.toLowerCase().indexOf(e.filter.acmake.toLowerCase()) !== -1) && ((!e.filter.acmodel || !t.Model || t.Model.toLowerCase().indexOf(e.filter.acmodel.toLowerCase()) !== -1) && (!(e.filter.make && t.Make && e.filter.make.toString().toLowerCase().indexOf(t.Make.toLowerCase()) === -1 && !e.isItemInArray(e.filter.make, "All Makes")) && (!(e.filter.myfavourites && !t.UserFavourite) && (!(e.filter.styles && "? undefined:undefined ?" !== e.filter.styles && !e.isItemInArray(e.filter.styles, "All Styles") && !e.arrayMatch(e.filter.styles, t.Styles)) && (!(e.filter.retailprice && !a(e.filter.retailprice, t.RetailPriceGbp)) && (!(e.filter.ticketprice && !a(e.filter.ticketprice, t.ActiveTicket.Price)) && (!(e.filter.topspeed && !a(e.filter.topspeed, t.TopSpeed)) && (!(e.filter.zero60 && !a(e.filter.zero60, t.MphTime)) && (!(e.filter.power && !a(e.filter.power, t.Power)) && (e.filterResults = !0, !0))))))))))
                }, e.arrayMatch = function(e, t) {
                    for (var i in e)
                        if (t.indexOf(e[i]) > -1)
                            return !0;
                    return !1
                };
                var F = r(e.prizes);
                e.autocomplete_options = {
                    suggest: l,
                    on_select: function(t) {
                        e.filter.keywordSearch = "", e.filter.acmake = t.obj.make, e.filter.acmodel = t.obj.model, e.selected_term = t, s.put("botb-wac-search", t.value), s.put("botb-wac-search-make", t.obj.model);
                        var i = $(".cars-tiles").find(".ng-scope.ng-hide");
                        "undefined" != typeof dataLayer && dataLayer.push({
                            event: "wacSearch",
                            promo_id: 7,
                            search_term: t.value
                        }), i.length > 0 && $(i).removeClass("ng-hide")
                    }
                }, d(), v(), b(), $(".filter-styles-container").find(".arrow").addClass("active"), $(".filter-makes-container").find(".arrow").addClass("active")
            }
            $(".cars-filter").find(".searchclear").click(function(t) {
                e.clearFilters()
            }), $(".more-filters .drop-btn").click(function(e) {
                $(window).resize()
            }), h()
        }
        function y() {
            var t = null;
            $(".our-cars .wac-row .icon-plus").unbind("mouseenter").mouseenter(function() {
                t = Date.now();
                var i = this,
                    a = i.getAttribute("prizeid");
                e.timeoutHandle[a] && (clearTimeout(e.timeoutHandle[a]), e.timeoutHandle[a] = null);
                var o = $(i).siblings(".ticket-slider"),
                    r = $(i).closest(".prize-style"),
                    n = $(r).find(".prize-multibuy"),
                    s = $(r).find(".prize-make");
                o.show();
                var l = $(r).find(".img-nest > .icon-wheel:not(.ng-hide)");
                o.hasClass("ng-hide") ? l.tooltipster("show") : ($(n).addClass("active"), $(s).removeClass("active")), $(r).unbind("mouseleave").mouseleave(function() {
                    var t = $(r).find(".icon-plus"),
                        i = $(t).siblings(".ticket-slider"),
                        a = t[0].getAttribute("prizeid"),
                        o = $(t).closest(".prize-style").find(".prize-multibuy"),
                        n = $(r).find(".prize-make");
                    e.timeoutHandle[a] = setTimeout(function() {
                        i.hide(), $(o).removeClass("active"), $(n).addClass("active")
                    }, 1e3)
                }), $(r).unbind("mouseenter").mouseenter(function() {
                    var t = $(r).find(".icon-plus"),
                        i = ($(t).siblings(".ticket-slider"), t[0].getAttribute("prizeid"));
                    e.timeoutHandle[i] && (clearTimeout(e.timeoutHandle[i]), e.timeoutHandle[i] = null)
                })
            }), $(".our-cars .icon-plus").unbind("mouseleave").mouseleave(function() {
                t = null, $(".icon-wheel").tooltipster("hide")
            }), $(".our-cars .icon-plus").unbind("click").click(function(e) {
                if (!(null != t && Date.now() - t < 500)) {
                    var i = this,
                        a = $(i).siblings(".ticket-slider"),
                        o = $(i).closest(".prize-style"),
                        r = $(o).find(".img-nest > .icon-wheel:not(.ng-hide)");
                    a.hasClass("ng-hide") && r.tooltipster("show"), $(a).is(":visible") ? $(a).hide() : $(a).show()
                }
            })
        }
        if (v = r, e.enableMultibuy = d, e.itemLimit = i, "undefined" !== n && 1 != n) {
            var w = angular.element('input[ng-model="filter.ticketprice"]'),
                C = w.attr("data-to"),
                T = (w.attr("value"), C * n);
            w.attr("data-to", T), w.attr("value", "0;" + T), e.filter.ticketprice = w.attr("value")
        }
        if ("undefined" !== l && (e.filter.currencySymbol = l), 0 !== b.length)
            for (var x = 0; x < b.length; x++) {
                var S = b[x],
                    z = b[S];
                if ("boolean" == typeof e.filter[S])
                    e.filter[S] = "true" == b[S];
                else if ("sort" === S) {
                    var M = null;
                    $(".filter-sort-container").find("select").find("option").each(function() {
                        var e = this,
                            t = $(e).val();
                        t.toLowerCase() == decodeURIComponent(z.toLowerCase()) && (M = t)
                    }), null !== M && (console.log(M), e.filter.sortType = M)
                } else
                    e.filter[S] = b[S]
            }
        if (e.clearFilters = function() {
            var i = $(".our-cars").find(".clear-filters");
            $(i).find(".text").removeClass("active"), $(i).find(".loader").addClass("active"), e.dirty = {}, e.filter = angular.copy(e.master), e.prizes = c(e.prizes, ["Ordering"]), $(".range-input").each(function() {
                var e = this;
                $(e).jslider("prc", 0, 100)
            }), t.url(t.path()), e.ClearWACCookies(), $(".botb-multi-select-container").each(function() {
                var e = this,
                    t = $(e).find(".list-option-item.all"),
                    i = $(e).find(".list-option-item").not(".all");
                $(t).find(".faux-checkbox").addClass("checked").trigger("cssClassChanged"), $(i).find(".faux-checkbox").removeClass("checked"), $(i).find(".checkbox-item").prop("checked", !1)
            }), $(".mobile-filter").each(function() {
                var e = this;
                $(e).find("option").prop("selected", !1)
            });
            var a = ".filter-sort-container";
            $(a).find(".chosen-select").val("").trigger("chosen:updated"), $(a).find(".chosen-single").find("div").removeClass("hide"), $(a).find(".remove").remove(), setTimeout(function() {
                $(window).resize();
                var e = $(".our-cars").find(".clear-filters");
                $(e).find(".text").addClass("active"), $(e).find(".loader").removeClass("active")
            }, 100)
        }, v !== -1) {
            var I = 0;
            0 === $(".filter-sort-container").find("select").find('option[value="recommended"]').length && (I = 1), a.prizeSearch(I, i, g)
        } else
            g({
                Results: ""
            });
        e.$on("prizeRepeatFinished", function(e) {
            y()
        })
    }
}]), botb.app.controller("BotB.MidweekPrizeController", ["$scope", "$location", "$filter", "MidweekPrizeRepository", "$sce", "$q", "$http", "$cookies", "$window", "orderByFilter", function(e, t, i, a, o, r, n, s, l, c) {
    function d(t) {
        for (var i = 0; i < e.filteredItems.length; i++)
            if (e.filteredItems[i].ContentNodeId == t)
                return i;
        return -1
    }
    function u(e) {
        return angular.element('input[ng-model="' + e + '"]').attr("value")
    }
    function p(e, t, i, a) {
        angular.element('input[ng-model="' + e + '"]').attr("data-from", t.toString()), angular.element('input[ng-model="' + e + '"]').attr("data-to", i.toString()), angular.element('input[ng-model="' + e + '"]').attr("value", t.toString() + ";" + i.toString()), void 0 != a && null != a && angular.element('input[ng-model="' + e + '"]').attr("data-step", a.toString())
    }
    function f(e, t) {
        var i = null;
        if (t.indexOf(".") != -1 && (i = t.split(".")[1], t = t.split(".")[0]), !e || 0 == e.length)
            return 0;
        for (var a, o = 0; o < e.length; o++)
            null == i ? (!a || parseInt(e[o][t]) > parseInt(a[t])) && (a = e[o]) : (!a || parseInt(e[o][t][i]) > parseInt(a[t][i])) && (a = e[o]);
        return null == i ? a[t] : a[t][i]
    }
    function m(e, t) {
        var i = null;
        if (t.indexOf(".") != -1 && (i = t.split(".")[1], t = t.split(".")[0]), !e || 0 == e.length)
            return 0;
        for (var a, o = 0; o < e.length; o++)
            null == i ? (!a || parseInt(e[o][t]) < parseInt(a[t])) && (a = e[o]) : (!a || parseInt(e[o][t][i]) < parseInt(a[t][i])) && (a = e[o]);
        return null == i ? a[t] : a[t][i]
    }
    function h() {
        $(window).resize(function() {
            $(".mobile-filter:visible").length > 0 && (e.updateMobileMakesFilter(), e.updateMobileStylesFilter())
        })
    }
    var v = -1,
        b = t.search(),
        g = null;
    e.prizes = [], e.initCompleted = !1, e.repeatLimit = 12, e.timeoutHandle = {}, e.kioskPopupTimer = null, e.showQuickViewModal = !1, e.quickViewPrize = null, e.enableMultibuy = !1, e.initialLoadFinished = !1, e.quickViewSlider = null, e.showFilters = !1, e.filter = {
        acmake: "",
        acmodel: "",
        styles: [],
        make: [],
        myfavourites: !1,
        currencySymbol: null,
        retailprice: u("filter.retailprice"),
        ticketprice: u("filter.ticketprice"),
        topspeed: u("filter.topspeed"),
        zero60: u("filter.zero60"),
        power: u("filter.power"),
        keywordSearch: ""
    }, e.addTickets = function(e, t) {
        a.addTickets(v, e, t, function(e) {})
    }, e.updateStylesFilter = function(t) {
        setTimeout(function() {
            $("." + t).find(".checkbox-item").each(function() {
                var t = this,
                    i = $(t).val(),
                    a = $(t).is(":checked");
                a ? e.filter.styles = e.addItemToArray(e.filter.styles, i) : e.filter.styles = e.removeItemFromArray(e.filter.styles, i)
            }), e.UpdateWACCookies(), $(window).scroll(), angular.element(document.getElementById("our-cars-controller-container")).scope().$apply()
        }, 150)
    }, e.updateMakesFilter = function(t) {
        setTimeout(function() {
            $("." + t).find(".checkbox-item").each(function() {
                var t = this,
                    i = $(t).val(),
                    a = $(t).is(":checked");
                a ? e.filter.make = e.addItemToArray(e.filter.make, i) : e.filter.make = e.removeItemFromArray(e.filter.make, i)
            }), e.UpdateWACCookies(), $(window).scroll(), angular.element(document.getElementById("our-cars-controller-container")).scope().$apply()
        }, 150)
    }, e.updateMobileStylesFilter = function() {
        setTimeout(function() {
            e.filter.styles = $(".styles-filter-dropdown").val(), e.UpdateWACCookies(), $(".filter-styles-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filter.styles, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-styles-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-styles-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element(document.getElementById("our-cars-controller-container")).scope().$apply()
        }, 750)
    }, e.updateMobileMakesFilter = function() {
        setTimeout(function() {
            e.filter.make = $(".makes-filter-dropdown").val(), e.UpdateWACCookies(), $(".filter-makes-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filter.make, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-makes-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-makes-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element(document.getElementById("our-cars-controller-container")).scope().$apply()
        }, 750)
    }, e.addItemToArray = function(t, i) {
        return e.isItemInArray(t, i) || t.push(i), t
    }, e.removeItemFromArray = function(e, t) {
        return jQuery.grep(e, function(e) {
            return e != t
        })
    }, e.isItemInArray = function(e, t) {
        var i = !1;
        if (e.constructor === String)
            t.toLowerCase() == e.toLowerCase() && (i = !0);
        else
            for (var a = 0; a < e.length; a++)
                if (e[a].toLowerCase() === t.toLowerCase()) {
                    i = !0;
                    break
                }
        return i
    }, e.UpdateWACCookies = function() {
        var t = $(".favourites-checkbox-container").find("a");
        void 0 != t && (e.filter.myfavourites ? $(t).addClass("checked") : $(t).removeClass("checked")), e.filter.styles = e.filter.styles = "" == e.filter.styles.toString() ? "All Styles" : e.filter.styles, e.filter.make = null == e.filter.make || "" == e.filter.make.toString() ? "All Makes" : e.filter.make;
        var i = [];
        e.filter.styles.constructor !== Array && (i.push(e.filter.styles.toString()), e.filter.styles = i);
        var a = [];
        e.filter.make.constructor !== Array && (a.push(e.filter.make.toString()), e.filter.make = a), s.put("botb-wac-styles", e.filter.styles.toString()), s.put("botb-wac-make", e.filter.make.toString()), s.put("botb-wac-myfavourites", e.filter.myfavourites), s.put("botb-wac-retailprice", e.filter.retailprice), s.put("botb-wac-ticketprice", e.filter.ticketprice), s.put("botb-wac-topspeed", e.filter.topspeed), s.put("botb-wac-zero60", e.filter.zero60), s.put("botb-wac-power", e.filter.power);
        var o = $(".cars-tiles").find(".ng-scope.ng-hide");
        if (o.length > 0 && $(o).removeClass("ng-hide"), $(".sticky-filter-wrapper").hasClass("sticky")) {
            var r = $(".counter").height(),
                n = $(".in-the-headlights-container").height(),
                l = r + n;
            $("html,body").animate({
                scrollTop: l
            })
        }
        "undefined" != typeof dataLayer && dataLayer.push({
            event: "makeSelected",
            promo_id: 3,
            make: e.filter.make
        })
    }, e.ClearWACCookies = function() {
        s.remove("botb-wac-styles"), s.remove("botb-wac-make"), s.remove("botb-wac-myfavourites"), s.remove("botb-wac-retailprice"), s.remove("botb-wac-ticketprice"), s.remove("botb-wac-topspeed"), s.remove("botb-wac-zero60"), s.remove("botb-wac-power"), s.remove("botb-wac-search"), s.remove("botb-wac-search-make"), s.remove("botb-wac-scroll")
    }, e.showKioskPopupConfirmation = function() {
        if ($("body").hasClass("pp-kiosk")) {
            var t = !1,
                i = Date.now() / 1e3;
            if (null == e.kioskPopupTimer ? (t = !0, e.kioskPopupTimer = i) : i - e.kioskPopupTimer >= 90 && (t = !0, e.kioskPopupTimer = i), t) {
                botb.messagePopup.isShown() && botb.messagePopup.close();
                var a = "",
                    o = $(".loggedInAsStyle"),
                    r = $(o).find(".customer-text").attr("data-customer-name"),
                    n = $(o).find(".staff-text").attr("data-staff-name");
                void 0 != r ? a = "Hello " + r + "<br /><br /> You are being served by " + n : void 0 != n && (a = "You are being served by " + n), "" != a && botb.messagePopup.show(a)
            }
        }
    }, e.quickViewMouseOver = function(e) {
        var t = $(window).width();
        if (!(t <= 768)) {
            var i = e.currentTarget;
            $(i).find(".prize-make").removeClass("active"), $(i).find(".prize-multibuy").addClass("active"), $(i).find(".prize-model").addClass("active")
        }
    }, e.quickViewMouseLeave = function(e) {
        var t = $(window).width();
        if (!(t <= 768)) {
            var i = e.currentTarget;
            $(i).find(".prize-make").addClass("active"), $(i).find(".prize-multibuy").removeClass("active"), $(i).find(".prize-model").removeClass("active")
        }
    }, e.showCarFullDetails = function(e) {
        window.location.href = e
    }, e.playQuickViewVideo = function(e) {
        var t = e.target,
            i = $(t).closest("li");
        botb.videoInElement.play($(t), i)
    }, e.showQuickView = function(t) {
        $(".quick-view-container").find(".quntity-input").val("1"), null != e.quickViewSlider && (e.quickViewSlider.destroySlider(), e.quickViewSlider = null), e.quickViewPrize = t, e.showQuickViewModal = !0, $(".quick-view-container").addClass("active"), null != g && (clearTimeout(g), g = null), g = setTimeout(function() {
            e.quickViewSlider = $(".quick-view-container").find(".quick-view-gallery-container .large-images").bxSlider({
                pagerCustom: "#quick-view-thumbnail-images",
                auto: !1,
                autoDelay: 2e3,
                pause: 8e3,
                touchEnabled: !0,
                swipeThreshold: 50,
                pager: !0,
                controls: !0,
                infiniteLoop: !0,
                onSlideAfter: function(e, t, i) {
                    var a = $(e).closest(".quick-view-container").find(".close");
                    botb.videoInElement.remove(a)
                }
            })
        }, 700), $(".quick-view-container").find(".change").unbind("click"), $(".quick-view-container").find(".change").on("click", BOTBapp.quantity)
    }, e.closeQuickViewModal = function() {
        e.quickViewPrize = null, e.showQuickViewModal = !1, $(".quick-view-container").removeClass("active")
    }, e.quickViewAddToBasket = function(t) {
        var i = $(".quick-view-container").find(".quntity-input").val();
        e.addTickets(t, i), e.closeQuickViewModal()
    }, e.overViewShowPrevious = function(t) {
        var i = d(t);
        i > 0 && e.showQuickView(e.filteredItems[i - 1])
    }, e.overViewShowNext = function(t) {
        var i = d(t);
        i != -1 && i < e.filteredItems.length - 1 && e.showQuickView(e.filteredItems[i + 1])
    };
    var k = function(e) {
        var t,
            i,
            a = e.substring(1).split("&"),
            o = {};
        for (i in a)
            "" !== a[i] && (t = a[i].split("="), o[decodeURIComponent(t[0])] = decodeURIComponent(t[1]));
        return o
    };
    e.init = function(i, r, n, l, d) {
        function g(t) {
            function a(e, t) {
                var i = e.split(";"),
                    a = parseInt(i[0]),
                    o = parseInt(i[1]);
                return t >= a && t <= o
            }
            function r(e) {
                var t = [],
                    i = [];
                for (var a in e)
                    i.indexOf(e[a].Make) == -1 && (i.push(e[a].Make), t.push({
                        type: "make",
                        make: e[a].Make,
                        model: ""
                    }));
                for (var a in e)
                    i.indexOf(e[a].Make + " " + e[a].Model) == -1 && (i.push(e[a].Make + " " + e[a].Model), t.push({
                        type: "makemodel",
                        make: e[a].Make,
                        model: e[a].Model
                    }));
                return t
            }
            function n(e, t) {
                var i = new RegExp("(" + t + ")", "gi");
                return e.replace(i, '<span class="highlight">$1</span>')
            }
            function l(e) {
                for (var t = e.toLowerCase().trim(), i = [], a = 0; a < F.length; a++) {
                    var r = F[a];
                    if ("make" === r.type)
                        r.make.toLowerCase().indexOf(t) !== -1 && i.push({
                            value: r.make,
                            obj: r,
                            label: o.trustAsHtml("<div>" + n(r.make, e) + "</div>")
                        });
                    else if ("makemodel" === r.type) {
                        var s = !1,
                            l = e;
                        r.make.toLowerCase().indexOf(l) === -1 && r.model.toLowerCase().indexOf(l) === -1 || (i.push({
                            value: r.make + " " + r.model,
                            obj: r,
                            label: o.trustAsHtml("<div>" + n(r.make, e) + " " + n(r.model, e) + "</div>")
                        }), s = !0);
                        var c = e.split(" ")[0],
                            d = e.split(" ")[1];
                        void 0 == d ? s || r.make.toLowerCase().indexOf(t) === -1 && r.model.toLowerCase().indexOf(t) === -1 || i.push({
                            value: r.make + " " + r.model,
                            obj: r,
                            label: o.trustAsHtml("<div>" + n(r.make, e) + " " + n(r.model, e) + "</div>")
                        }) : s || r.make.toLowerCase().indexOf(c) !== -1 && r.model.toLowerCase().indexOf(d) !== -1 && i.push({
                            value: r.make + " " + r.model,
                            obj: r,
                            label: o.trustAsHtml("<div>" + n(r.make + " " + r.model, e) + "</div>")
                        })
                    }
                }
                return i
            }
            function d() {
                var t = k(window.location.search),
                    i = t.styles,
                    a = t.make,
                    o = t.ticketprice;
                (i || a || o) && (e.filter.make = [], e.filter.ticketprice = "", e.filter.styles = [], s.put("botb-wac-make", e.filter.make.toString()), s.put("botb-wac-ticketprice", e.filter.ticketprice), s.put("botb-wac-styles", e.filter.styles.toString()), e.clearFilters()), a && $(".filter-makes-container").find(".checkbox-item").each(function() {
                    var t = this;
                    e.isItemInArray(a.split(","), $(t).val().toLowerCase()) ? (e.filter.make = a, s.put("botb-wac-make", e.filter.make.toString()), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
                }), o && (e.filter.ticketprice = o, s.put("botb-wac-ticketprice", e.filter.ticketprice), $('input[ng-model="filter.ticketprice"]').jslider("value", o.split(";")[0], o.split(";")[1])), i && $(".filter-styles-container").find(".checkbox-item").each(function() {
                    var t = this;
                    e.isItemInArray(i.split(","), $(t).val().toLowerCase()) ? (e.filter.styles = i.split(","), s.put("botb-wac-styles", e.filter.styles.toString()), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
                })
            }
            function v() {
                var t = s.get("botb-wac-styles");
                t ? $(".filter-styles-container").find(".checkbox-item").each(function() {
                    var i = this;
                    e.isItemInArray(t.split(","), $(i).val().toLowerCase()) ? (e.filter.styles = t.split(","), $(i).prop("checked", !0), $(i).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(i).prop("checked", !1), $(i).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
                }) : s.remove("botb-wac-styles");
                var i = s.get("botb-wac-make");
                i ? $(".filter-makes-container").find(".checkbox-item").each(function() {
                    var t = this;
                    e.isItemInArray(i.split(","), $(t).val().toLowerCase()) ? (e.filter.make = i.split(","), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
                }) : s.remove("botb-wac-make");
                var a = s.get("botb-wac-myfavourites");
                a && (e.filter.myfavourites = "true" == a);
                var o = s.get("botb-wac-retailprice");
                o && (e.filter.retailprice = o, $('input[ng-model="filter.retailprice"]').jslider("value", o.split(";")[0], o.split(";")[1]));
                var r = s.get("botb-wac-ticketprice");
                r && (e.filter.ticketprice = r, $('input[ng-model="filter.ticketprice"]').jslider("value", r.split(";")[0], r.split(";")[1]));
                var n = s.get("botb-wac-topspeed");
                n && (e.filter.topspeed = n, $('input[ng-model="filter.topspeed"]').jslider("value", n.split(";")[0], n.split(";")[1]));
                var l = s.get("botb-wac-zero60");
                l && (e.filter.zero60 = l, $('input[ng-model="filter.zero60"]').jslider("value", l.split(";")[0], l.split(";")[1]));
                var c = s.get("botb-wac-power");
                c && (e.filter.power = c, $('input[ng-model="filter.power"]').jslider("value", c.split(";")[0], c.split(";")[1]));
                var d = s.get("botb-wac-search"),
                    u = s.get("botb-wac-search-make");
                if (d && u) {
                    var p = e.autocomplete_options.suggest(u);
                    for (var f in p) {
                        var m = p[f];
                        m.value == d && ($(".wac-searchField").val(m.value), $(".wac-searchField").trigger("change"), e.autocomplete_options.on_select(m))
                    }
                }
                var h = s.get("botb-wac-scroll");
                if (h)
                    var v = setInterval(function() {
                        e.loadMore(), e.$apply(), $(document).height() >= h && (e.loadMore(), e.$apply(), e.loadMore(), e.$apply(), $(document).scrollTop(h), clearInterval(v))
                    }, 100);
                $(window).scroll(function() {
                    s.put("botb-wac-scroll", $(document).scrollTop())
                })
            }
            function b() {
                $(".wac-searchField").keyup(function(t) {
                    var i = t.which;
                    if (13 == i) {
                        var a = $(".wac-searchField").val(),
                            o = l(a);
                        return void 0 != o && (e.filter.keywordSearch = a), !1
                    }
                })
            }
            e.prizes = t.Results, e.prizes = c(e.prizes, ["Ordering"]), e.filterResults = !1, e.dirty = {};
            var g = m(t.Results, "RetailPriceGbp"),
                y = f(t.Results, "RetailPriceGbp");
            g = 1e3 * parseInt(Math.floor(parseFloat(g / 1e3)), 10), y = 1e3 * parseInt(Math.ceil(parseFloat(y / 1e3)), 10);
            var w = m(t.Results, "ActiveTicket.Price"),
                C = f(t.Results, "ActiveTicket.Price");
            w = 1 * parseInt(Math.floor(parseFloat(w / 1)), 10), C = 1 * parseInt(Math.ceil(parseFloat(C / 1)), 10);
            var T = m(t.Results, "TopSpeed"),
                x = f(t.Results, "TopSpeed");
            T = 10 * parseInt(Math.floor(parseFloat(T / 10)), 10), x = 10 * parseInt(Math.ceil(parseFloat(x / 10)), 10);
            var S = m(t.Results, "MphTime"),
                z = f(t.Results, "MphTime");
            S = 1 * parseInt(Math.floor(parseFloat(S / 1)), 10), z = 1 * parseInt(Math.ceil(parseFloat(z / 1)), 10);
            var M = m(t.Results, "Power"),
                I = f(t.Results, "Power");
            M = 10 * parseInt(Math.floor(parseFloat(M / 10)), 10), I = 10 * parseInt(Math.ceil(parseFloat(I / 10)), 10), p("filter.retailprice", g, y), C - w > 500 ? (C = 1 * parseInt(100 * Math.ceil(parseFloat(C / 100)), 10), p("filter.ticketprice", w, C, 100)) : p("filter.ticketprice", w, C), p("filter.topspeed", T, x), p("filter.zero60", S, z), p("filter.power", M, I), e.filter.styles = ["All Styles"], e.filter.make = ["All Makes"], e.filter.retailprice = u("filter.retailprice"), e.filter.ticketprice = u("filter.ticketprice"), e.filter.topspeed = u("filter.topspeed"), e.filter.zero60 = u("filter.zero60"), e.filter.power = u("filter.power"), 0 == t.Results.length && $(".filters-group").hide(), plugins.rangeSlider(), setTimeout(function() {
                $(window).resize()
            }, 100), e.master = angular.copy(e.filter), e.showFilters = !1, e.initialLoadFinished = !0;
            var P = 4,
                A = i > 0 ? i : 3 * P;
            if (e.loadMore = function() {
                A += P, e.repeatLimit += P
            }, e.isHidden = function(e) {
                if (e >= A)
                    return !0
            }, e.showFilters) {
                e.prizeFilter = function(t) {
                    if (e.filterResults = !1, "" != e.filter.keywordSearch) {
                        var i = e.filter.keywordSearch.split(" ")[0],
                            o = e.filter.keywordSearch.split(" ")[1];
                        if (void 0 == o) {
                            if (t.Make.toLowerCase().indexOf(e.filter.keywordSearch) !== -1 || t.Model.toLowerCase().indexOf(e.filter.keywordSearch) !== -1)
                                return !0
                        } else if (t.Make.toLowerCase().indexOf(i) !== -1 && t.Model.toLowerCase().indexOf(o) !== -1)
                            return !0;
                        return !1
                    }
                    return (!e.filter.acmake || !t.Make || t.Make.toLowerCase().indexOf(e.filter.acmake.toLowerCase()) !== -1) && ((!e.filter.acmodel || !t.Model || t.Model.toLowerCase().indexOf(e.filter.acmodel.toLowerCase()) !== -1) && (!(e.filter.make && t.Make && e.filter.make.toString().toLowerCase().indexOf(t.Make.toLowerCase()) === -1 && !e.isItemInArray(e.filter.make, "All Makes")) && (!(e.filter.myfavourites && !t.UserFavourite) && (!(e.filter.styles && "? undefined:undefined ?" !== e.filter.styles && !e.isItemInArray(e.filter.styles, "All Styles") && !e.arrayMatch(e.filter.styles, t.Styles)) && (!(e.filter.retailprice && !a(e.filter.retailprice, t.RetailPriceGbp)) && (!(e.filter.ticketprice && !a(e.filter.ticketprice, t.ActiveTicket.Price)) && (!(e.filter.topspeed && !a(e.filter.topspeed, t.TopSpeed)) && (!(e.filter.zero60 && !a(e.filter.zero60, t.MphTime)) && (!(e.filter.power && !a(e.filter.power, t.Power)) && (e.filterResults = !0, !0))))))))))
                }, e.arrayMatch = function(e, t) {
                    for (var i in e)
                        if (t.indexOf(e[i]) > -1)
                            return !0;
                    return !1
                };
                var F = r(e.prizes);
                e.autocomplete_options = {
                    suggest: l,
                    on_select: function(t) {
                        e.filter.keywordSearch = "", e.filter.acmake = t.obj.make, e.filter.acmodel = t.obj.model, e.selected_term = t, s.put("botb-wac-search", t.value), s.put("botb-wac-search-make", t.obj.model);
                        var i = $(".cars-tiles").find(".ng-scope.ng-hide");
                        "undefined" != typeof dataLayer && dataLayer.push({
                            event: "wacSearch",
                            promo_id: 7,
                            search_term: t.value
                        }), i.length > 0 && $(i).removeClass("ng-hide")
                    }
                }, d(), v(), b()
            }
            $(".cars-filter").find(".searchclear").click(function(t) {
                e.clearFilters()
            }), $(".more-filters .drop-btn").click(function(e) {
                $(window).resize()
            }), h()
        }
        function y() {
            var t = null;
            $(".our-cars .wac-row .icon-plus").unbind("mouseenter").mouseenter(function() {
                t = Date.now();
                var i = this,
                    a = i.getAttribute("prizeid");
                e.timeoutHandle[a] && (clearTimeout(e.timeoutHandle[a]), e.timeoutHandle[a] = null);
                var o = $(i).siblings(".ticket-slider"),
                    r = $(i).closest(".prize-style"),
                    n = $(r).find(".prize-multibuy"),
                    s = $(r).find(".prize-make");
                o.show();
                var l = $(r).find(".img-nest > .icon-wheel:not(.ng-hide)");
                o.hasClass("ng-hide") ? l.tooltipster("show") : ($(n).addClass("active"), $(s).removeClass("active")), $(r).unbind("mouseleave").mouseleave(function() {
                    var t = $(r).find(".icon-plus"),
                        i = $(t).siblings(".ticket-slider"),
                        a = t[0].getAttribute("prizeid"),
                        o = $(t).closest(".prize-style").find(".prize-multibuy"),
                        n = $(r).find(".prize-make");
                    e.timeoutHandle[a] = setTimeout(function() {
                        i.hide(), $(o).removeClass("active"), $(n).addClass("active")
                    }, 1e3)
                }), $(r).unbind("mouseenter").mouseenter(function() {
                    var t = $(r).find(".icon-plus"),
                        i = ($(t).siblings(".ticket-slider"), t[0].getAttribute("prizeid"));
                    e.timeoutHandle[i] && (clearTimeout(e.timeoutHandle[i]), e.timeoutHandle[i] = null)
                })
            }), $(".our-cars .icon-plus").unbind("mouseleave").mouseleave(function() {
                t = null, $(".icon-wheel").tooltipster("hide")
            }), $(".our-cars .icon-plus").unbind("click").click(function(e) {
                if (!(null != t && Date.now() - t < 500)) {
                    var i = this,
                        a = $(i).siblings(".ticket-slider"),
                        o = $(i).closest(".prize-style"),
                        r = $(o).find(".img-nest > .icon-wheel:not(.ng-hide)");
                    a.hasClass("ng-hide") && r.tooltipster("show"), $(a).is(":visible") ? $(a).hide() : $(a).show()
                }
            })
        }
        if (v = r, e.enableMultibuy = d, "undefined" !== n && 1 != n) {
            var w = angular.element('input[ng-model="filter.ticketprice"]'),
                C = w.attr("data-to"),
                T = (w.attr("value"), C * n);
            w.attr("data-to", T), w.attr("value", "0;" + T), e.filter.ticketprice = w.attr("value")
        }
        if ("undefined" !== l && (e.filter.currencySymbol = l), 0 !== Object.getOwnPropertyNames(b).length)
            for (var x in b)
                e.filter.hasOwnProperty(x) && ("boolean" == typeof e.filter[x] ? e.filter[x] = "true" == b[x] : e.filter[x] = b[x]);
        e.clearFilters = function() {
            var i = $(".our-cars").find(".clear-filters");
            $(i).find(".text").removeClass("active"), $(i).find(".loader").addClass("active"), e.dirty = {}, e.filter = angular.copy(e.master), e.prizes = c(e.prizes, ["Ordering"]), $(".range-input").each(function() {
                var e = this;
                $(e).jslider("prc", 0, 100)
            }), t.url(t.path()), e.ClearWACCookies(), $(".botb-multi-select-container").each(function() {
                var e = this,
                    t = $(e).find(".list-option-item.all"),
                    i = $(e).find(".list-option-item").not(".all");
                $(t).find(".faux-checkbox").addClass("checked").trigger("cssClassChanged"), $(i).find(".faux-checkbox").removeClass("checked"), $(i).find(".checkbox-item").prop("checked", !1)
            }), $(".mobile-filter").each(function() {
                var e = this;
                $(e).find("option").prop("selected", !1)
            }), setTimeout(function() {
                $(window).resize();
                var e = $(".our-cars").find(".clear-filters");
                $(e).find(".text").addClass("active"), $(e).find(".loader").removeClass("active")
            }, 100)
        }, v !== -1 ? a.prizeSearch(0, i, g) : g({
            Results: ""
        }), e.$on("prizeRepeatFinished", function(e) {
            y()
        })
    }
}]), botb.app.controller("BotB.RecentlyViewedPrizeController", ["$scope", "CarPrizeRepository", "$sce", "$q", "$http", function(e, t, i, a, o) {
    function r() {
        $(".you-might-also-like .icon-plus,.recently-viewed .icon-plus").unbind("mouseenter").mouseenter(function() {
            var t = this,
                i = t.getAttribute("prizeid");
            e.timeoutHandle[i] && (clearTimeout(e.timeoutHandle[i]), e.timeoutHandle[i] = null);
            var a = $(t).siblings(".ticket-slider"),
                o = $(t).closest(".prize-style");
            a.show();
            var r = $(o).find(".img-nest > .icon-wheel:not(.ng-hide)");
            a.hasClass("ng-hide") && r.tooltipster("show"), $(o).unbind("mouseleave").mouseleave(function() {
                var t = $(o).find(".icon-plus"),
                    i = $(t).siblings(".ticket-slider"),
                    a = t[0].getAttribute("prizeid");
                e.timeoutHandle[a] = setTimeout(function() {
                    i.hide()
                }, 1e3)
            }), $(o).unbind("mouseenter").mouseenter(function() {
                var t = $(o).find(".icon-plus"),
                    i = ($(t).siblings(".ticket-slider"), t[0].getAttribute("prizeid"));
                e.timeoutHandle[i] && (clearTimeout(e.timeoutHandle[i]), e.timeoutHandle[i] = null)
            })
        }), $(".you-might-also-like .icon-plus,.recently-viewed .icon-plus").unbind("mouseleave").mouseleave(function() {
            $(".icon-wheel").tooltipster("hide")
        }), $(".you-might-also-like .icon-plus,.recently-viewed .icon-plus").unbind("click").click(function(e) {
            var t = this,
                i = $(t).siblings(".ticket-slider"),
                a = $(t).closest(".prize-style"),
                o = $(a).find(".img-nest > .icon-wheel:not(.ng-hide)");
            i.hasClass("ng-hide") && o.tooltipster("show"), $(i).is(":visible") ? $(i).hide() : $(i).show()
        })
    }
    var n = -1;
    e.timeoutHandle = {}, e.init = function(i, a) {
        function o(t) {
            e.prizes = t.Results
        }
        n = a;
        var r = botb.cookie.getCarPrizeCookie();
        r = botb.cookie.removeCarPrizeFromCookie(i, r), a != -1 && null != r ? t.getPrizes(JSON.stringify(r), o) : o({
            Results: ""
        })
    }, e.addTickets = function(e, i) {
        t.addTickets(n, e, i, function(e) {})
    }, e.$watch("$includeContentLoaded", function() {
        setTimeout(function() {
            r()
        }, 5e3)
    })
}]), botb.app.controller("BotB.RecommendedPrizesController", ["$scope", "CarPrizeRepository", "$sce", "$q", "$http", function(e, t, i, a, o) {
    var r = -1;
    e.init = function(i, a) {
        function o(t) {
            e.prizes = t.Results
        }
        r = a, a != -1 ? t.getRecommendedPrizes(i, o) : o({
            Results: ""
        })
    }, e.addTickets = function(e, i) {
        t.addTickets(r, e, i, function(e) {})
    }
}]), botb.app.controller("BotB.WonPrizesController", ["$scope", "CarPrizeRepository", "$sce", "$q", "$http", function(e, t, i, a, o) {
    var r = -1;
    e.init = function(i, a) {
        function o(t) {
            e.prizes = t.Results
        }
        r = a, t.getPrizesIncludingUnpublished(i, o)
    }, e.addTickets = function(e, i) {
        t.addTickets(r, e, i, function(e) {})
    }
}]), botb.app.controller("BotB.UsersController", ["$scope", "UsersRepository", "$sce", "$q", "$http", function(e, t, i, a, o) {
    function r() {
        e.isFavourite = !e.isFavourite, void 0 !== e.favouriteCount && (e.favouriteCount += e.isFavourite ? 1 : -1)
    }
    e.addFavourite = function(e) {
        t.addFavourite(e, function(e) {
            e && r()
        })
    }, e.removeFavourite = function(e) {
        t.removeFavourite(e, function(e) {
            e && r()
        })
    }, e.addTickets = function(e, t) {
        CarPrizeRepository.addTickets(e, t, function(e) {})
    }
}]), botb.app.controller("BotB.PrizeTicketController", ["$scope", "$filter", "CarPrizeRepository", function(e, t, i) {
    e.ticketQuantity = 1, e.addTickets = function(e, t, a) {
        i.addTickets(t, e, a, function(e) {})
    }
}]), botb.app.controller("BotB.BlogRepositoryController", ["$scope", "$location", function(e, t) {
    function i() {
        var e = $(window).width();
        if (!(e > 750)) {
            var t = $(".other-blogs").find(".item");
            if (!(t.length <= 8 || ($(t).slice(8).hide(), $(".other-blogs").find(".more-blogs").length > 0))) {
                var i = $(t).eq(7),
                    a = '<button class="btn blue more-blogs" type="button">MORE</button>';
                $(a).insertAfter(i), $(".other-blogs").find(".more-blogs").click(function(e) {
                    var t = this;
                    $(t).remove(), $(".other-blogs").find(".item").show(), e.preventDefault()
                })
            }
        }
    }
    var a = t.search().tag;
    void 0 === a && (a = ""), e.blogFilter = {
        Tags: a
    }, e.defaultBlogFilter = angular.copy(e.blogFilter), e.clearFilters = function() {
        e.blogFilter = angular.copy(e.defaultBlogFilter)
    };
    var o = 4,
        r = 2 * o;
    e.repeatLimit = 4, e.loadMore = function() {
        r += o, e.repeatLimit += o
    }, e.isHidden = function(e) {
        if (e >= r)
            return !0
    }, e.$on("blogRepeatFinished", function(e) {
        i()
    })
}]), botb.app.controller("BotB.WinnerRepositoryController", ["$scope", "$location", "$filter", "$sce", "$cookies", "orderByFilter", function(e, t, i, a, o, r) {
    var n = 0,
        s = getUrlVars(!0);
    e.masterWinners = [], e.compTypeOptionChanged = function(t) {
        $(window).width();
        $(".botb-multi-select-container").each(function() {
            var e = this,
                t = $(e).find(".list-option-item.all"),
                i = $(e).find(".list-option-item").not(".all");
            $(t).find(".faux-checkbox").addClass("checked").trigger("cssClassChanged"), $(i).find(".faux-checkbox").removeClass("checked"), $(i).find(".checkbox-item").prop("checked", !1)
        }), $(".mobile-filter").each(function() {
            var e = this;
            $(e).find("option").prop("selected", !1)
        }), e.applyCompTypeReset(), e.UpdateWinnerCookies(), e.UpdateFiltersVisibility(), setTimeout(function() {
            angular.element($(".our-winners").get(0)).scope().$apply()
        }, 150)
    }, e.UpdateWinnerCookies = function() {
        o.put("botb-winner-comp-type", e.filters.compType), o.put("botb-winner-year", e.filters.year), o.put("botb-winner-car-styles", e.filters.styles), o.put("botb-winner-car-make", e.filters.make), o.put("botb-winner-categories", e.filters.categories)
    }, e.UpdateFiltersVisibility = function() {
        switch (e.filters.compType) {
        case "DreamCarWinner":
            $(".filter-car-styles-container").closest(".item").removeClass("filter-hide hide"), $(".filter-car-makes-container").closest(".item").removeClass("filter-hide hide"), $(".filter-lifestyle-categories-container").closest(".item").addClass("hide"), $(".filter-car-styles-container").find(".arrow").addClass("active"), $(".filter-car-makes-container").find(".arrow").addClass("active");
            break;
        case "SuperDrivesWinner":
            $(".filter-car-styles-container").closest(".item").addClass("filter-hide"), $(".filter-car-makes-container").closest(".item").addClass("filter-hide"), $(".filter-lifestyle-categories-container").closest(".item").addClass("filter-hide");
            break;
        case "CashCompetitionWinner":
            $(".filter-car-styles-container").closest(".item").addClass("filter-hide hide"), $(".filter-car-makes-container").closest(".item").addClass("filter-hide hide"), $(".filter-lifestyle-categories-container").closest(".item").removeClass("filter-hide hide"), $(".filter-lifestyle-categories-container").find(".arrow").addClass("active");
            break;
        default:
            $(".filter-car-styles-container").closest(".item").addClass("filter-hide"), $(".filter-car-makes-container").closest(".item").addClass("filter-hide"), $(".filter-lifestyle-categories-container").closest(".item").addClass("filter-hide")
        }
    }, e.ClearWinnerCookies = function() {
        o.remove("botb-winner-comp-type"), o.remove("botb-winner-year"), o.remove("botb-winner-car-styles"), o.remove("botb-winner-car-make"), o.remove("botb-winner-categories")
    }, e.setFiltersFromCookies = function() {
        var t = !1,
            i = o.get("botb-winner-comp-type");
        i && (e.filters.compType = i);
        var a = o.get("botb-winner-year");
        a && (e.filters.year = a);
        var r = o.get("botb-winner-car-styles");
        r ? (e.filters.styles = ["All Styles"], $(".filter-car-styles-container").find(".checkbox-item").each(function() {
            var t = this;
            e.isItemInArray(r.split(","), $(t).val().toLowerCase()) ? (e.filters.styles = r.split(","), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
        }), e.filters.styles = r) : o.remove("botb-winner-car-styles");
        var n = o.get("botb-winner-car-make");
        n ? (e.filters.make = ["All Makes"], $(".filter-car-makes-container").find(".checkbox-item").each(function() {
            var t = this;
            e.isItemInArray(n.split(","), $(t).val().toLowerCase()) ? (e.filters.make = n.split(","), $(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
        }), e.filters.make = n) : o.remove("botb-winner-car-make");
        var s = o.get("botb-winner-categories");
        s ? (e.filters.categories = ["All Categories"], $(".filter-lifestyle-categories-container").find(".checkbox-item").each(function() {
            var i = this;
            e.isItemInArray(s.split(","), $(i).val().toLowerCase()) ? (e.filters.categories = s.split(","), $(i).prop("checked", !0), $(i).closest(".list-option-item").find(".faux-checkbox").addClass("checked").trigger("cssClassChanged"), t = !0) : ($(i).prop("checked", !1), $(i).closest(".list-option-item").find(".faux-checkbox").removeClass("checked").trigger("cssClassChanged"))
        }), e.filters.categories = s) : o.remove("botb-winner-categories"), e.ensureFiltersDataType();
        var l = o.get("botb-winner-scroll");
        if (l)
            var c = setInterval(function() {
                e.loadMore(), e.$apply(), $(document).height() >= l && (e.loadMore(), e.$apply(), e.loadMore(), e.$apply(), $(document).scrollTop(l), clearInterval(c))
            }, 100);
        "lifestyle" === e.filters.compType && t && ($(".filter-car-styles-container").closest(".item").addClass("filter-hide hide"), $(".filter-car-makes-container").closest(".item").addClass("filter-hide"), $(".filter-lifestyle-categories-container").closest(".item").removeClass("hide"))
    }, e.ensureFiltersDataType = function() {
        var t = [];
        e.filters.styles.constructor !== Array && (t.push(e.filters.styles.toString()), e.filters.styles = t);
        var i = [];
        e.filters.make.constructor !== Array && (i.push(e.filters.make.toString()), e.filters.make = i);
        var a = [];
        e.filters.categories.constructor !== Array && (a.push(e.filters.categories.toString()), e.filters.categories = a)
    }, e.updateStylesFilter = function(t) {
        setTimeout(function() {
            $("." + t).find(".checkbox-item").each(function() {
                var t = this,
                    i = $(t).val(),
                    a = $(t).is(":checked");
                if (a) {
                    if ("All Styles" === i)
                        return void (e.filters.styles = ["All Styles"]);
                    e.filters.styles = e.addItemToArray(e.filters.styles, i)
                } else
                    e.filters.styles = e.removeItemFromArray(e.filters.styles, i)
            }), $(window).scroll(), angular.element($(".our-winners").get(0)).scope().$apply(), e.UpdateWinnerCookies(), e.UpdateFiltersVisibility()
        }, 150)
    }, e.updateMakesFilter = function(t) {
        setTimeout(function() {
            $("." + t).find(".checkbox-item").each(function() {
                var t = this,
                    i = $(t).val(),
                    a = $(t).is(":checked");
                if (a) {
                    if ("All Makes" === i)
                        return void (e.filters.make = ["All Makes"]);
                    e.filters.make = e.addItemToArray(e.filters.make, i)
                } else
                    e.filters.make = e.removeItemFromArray(e.filters.make, i)
            }), $(window).scroll(), angular.element($(".our-winners").get(0)).scope().$apply(), e.UpdateWinnerCookies(), e.UpdateFiltersVisibility()
        }, 150)
    }, e.updateCategoriesFilter = function(t) {
        setTimeout(function() {
            $("." + t).find(".checkbox-item").each(function() {
                var t = this,
                    i = $(t).val(),
                    a = $(t).is(":checked");
                if (a) {
                    if ("All Categories" === i)
                        return void (e.filters.categories = ["All Categories"]);
                    e.filters.categories = e.addItemToArray(e.filters.categories, i)
                } else
                    e.filters.categories = e.removeItemFromArray(e.filters.categories, i)
            }), $(window).scroll(), angular.element($(".our-winners").get(0)).scope().$apply(), e.UpdateWinnerCookies(), e.UpdateFiltersVisibility()
        }, 150)
    }, e.addItemToArray = function(t, i) {
        return e.isItemInArray(t, i) || t.push(i), t
    }, e.removeItemFromArray = function(e, t) {
        return jQuery.grep(e, function(e) {
            return e != t
        })
    }, e.isItemInArray = function(e, t) {
        var i = !1;
        if (e.constructor === String)
            t.toLowerCase() == e.toLowerCase() && (i = !0);
        else
            for (var a = 0; a < e.length; a++)
                if (e[a].toLowerCase() === t.toLowerCase()) {
                    i = !0;
                    break
                }
        return i
    }, e.arrayMatch = function(e, t) {
        var i = e.toString().toLowerCase();
        return i.indexOf(t.toString().toLowerCase()) > -1
    }, e.init = function(t) {
        function r(e) {
            var t = [],
                i = [];
            for (var a in e)
                i.indexOf(e[a].Name) == -1 && (i.push(e[a].Name), t.push({
                    type: "name",
                    name: e[a].Name,
                    prize: ""
                }));
            for (var a in e)
                i.indexOf(e[a].Prize) == -1 && (i.push(e[a].Prize), t.push({
                    type: "prize",
                    name: "",
                    prize: e[a].Prize
                }));
            return t
        }
        function l(e, t) {
            var i = new RegExp("(" + t + ")", "gi");
            return e.replace(i, '<span class="highlight">$1</span>')
        }
        function c(e) {
            for (var t = e.toLowerCase().trim(), i = [], o = 0; o < C.length; o++) {
                var r = C[o];
                "name" === r.type ? r.name.toLowerCase().indexOf(t) !== -1 && i.push({
                    value: r.name,
                    obj: r,
                    label: a.trustAsHtml("<div>" + l(r.name, e) + "</div>")
                }) : "prize" === r.type && (r.name.toLowerCase().indexOf(t) === -1 && r.prize.toLowerCase().indexOf(t) === -1 || i.push({
                    value: r.prize,
                    obj: r,
                    label: a.trustAsHtml("<div>" + l(r.prize, e) + "</div>")
                }))
            }
            return i
        }
        function d() {
            $(".winner-searchField").keypress(function(t) {
                var i = (t.currentTarget,
                t.which);
                if (13 === i) {
                    var a = $(".winner-searchField").val(),
                        o = c(a);
                    void 0 !== o && o.length > 0 && ($(".winner-searchField").val(o[0].value), e.autocomplete_options.on_select(o[0]), e.$apply())
                }
            })
        }
        var u = 20,
            p = 2,
            f = null,
            m = 0,
            h = 0;
        e.masterWinners = angular.copy(t), f = i("unique")(t, "Date.Year"), f = i("orderBy")(f, "-Date.Year"), m = f.length > u ? f.slice(u, f.length) : 0, h = m.length > 0 ? f.slice(0, f.length - m.length) : f, e.winners = i("orderBy")(t, "-Date.Year"), e.yearFilters = {
            acName: "",
            acPrize: "",
            yearsArchive: m,
            years: h
        }, e.filters = {
            sortType: "",
            year: "",
            styles: ["All Styles"],
            make: ["All Makes"],
            categories: ["All Categories"],
            compType: "All Competitions"
        };
        var v = t.reduce(function(e, t) {
            var i = e.filter(function(e) {
                return t.Make == e.Make || 0 == t.Make.length
            });
            return 0 == i.length && t.Make.length > 0 && e.push(t.Make), e.unshift("All Makes"), e
        }, []);
        if ($(".filter-car-makes-container .list-option-item:not(:first)").filter(function() {
            return $.inArray($(this).find(".checkbox-item").val(), v) == -1
        }).remove(), $(".mobile-filter-car-makes option").filter(function() {
            return $.inArray($(this).val(), v) == -1
        }).remove(), e.master = angular.copy(e.filters), e.filterYears = function(t) {
            n = 0, e.filters.year = t, e.maxItems = p, e.UpdateWinnerCookies(), setTimeout(function() {
                e.ensureScrollbar()
            }, 1e3)
        }, e.ensureScrollbar = function() {
            $("body").height() < $(window).height() && ($(window).scroll(), n++, n < 6 && e.ensureScrollbar()), e.UpdateFiltersVisibility()
        }, e.maxItems = p, e.loadMore = function() {
            e.maxItems++
        }, s.length > 0) {
            for (var b = 0; b < s.length; b++) {
                var g = s[b],
                    k = s[g];
                switch (g) {
                case "styles":
                    var y = [];
                    $(".filter-car-styles-container").find(".checkbox-item").each(function() {
                        var e = this,
                            t = $(e).val(),
                            i = k.split(",");
                        $(i).each(function() {
                            var e = this;
                            t.toLowerCase() == decodeURIComponent(e.toLowerCase()) && y.push(t)
                        })
                    }), y.length > 0 && (e.filters.styles = y);
                    break;
                case "make":
                    var y = [];
                    $(".filter-car-makes-container").find(".checkbox-item").each(function() {
                        var e = this,
                            t = $(e).val(),
                            i = k.split(",");
                        $(i).each(function() {
                            var e = this;
                            t.toLowerCase() == decodeURIComponent(e.toLowerCase()) && y.push(t)
                        })
                    }), y.length > 0 && (e.filters.make = y);
                    break;
                case "prize":
                    var y = [];
                    $(".filter-lifestyle-categories-container").find(".checkbox-item").each(function() {
                        var e = this,
                            t = $(e).val(),
                            i = k.split(",");
                        $(i).each(function() {
                            var e = this;
                            t.toLowerCase() == decodeURIComponent(e.toLowerCase()) && y.push(t)
                        })
                    }), y.length > 0 && (e.filters.categories = y);
                    break;
                case "comptype":
                    "dreamcar" == k ? k = "DreamCarWinner" : "superdrives" == k ? k = "SuperDrivesWinner" : "lifestyle" == k && (k = "CashCompetitionWinner"), e.filters.compType = k;
                    break;
                case "sort":
                    var w = null;
                    $(".filter-sort-container").find("select").find("option").each(function() {
                        var e = this,
                            t = $(e).val();
                        t.toLowerCase() == decodeURIComponent(k.toLowerCase()) && (w = t)
                    }), null != w && (e.filters.sortType = w)
                }
            }
            e.UpdateWinnerCookies(), e.UpdateFiltersVisibility()
        }
        e.clearFilters = function() {
            angular.copy(e.master, e.filters), $(".winner-searchField").val(""), e.ClearWinnerCookies(), $(".winner-search-container").find(".searchclear").addClass("ng-hide"), $(".primary-filter.competition-type").find(".remove").remove(), $(".primary-filter.competition-type").find(".chosen-single").find("div").removeClass("hide"), $(".botb-multi-select-container").each(function() {
                var e = this,
                    t = $(e).find(".list-option-item.all"),
                    i = $(e).find(".list-option-item").not(".all");
                $(t).find(".faux-checkbox").addClass("checked").trigger("cssClassChanged"), $(i).find(".faux-checkbox").removeClass("checked"), $(i).find(".checkbox-item").prop("checked", !1)
            }), $(".mobile-filter").each(function() {
                var e = this;
                $(e).find("option").prop("selected", !1)
            }), $(".filter-car-styles-container").closest(".item").removeClass("hide").addClass("filter-hide"), $(".filter-car-makes-container").closest(".item").removeClass("hide").addClass("filter-hide"), $(".filter-lifestyle-categories-container").closest(".item").addClass("hide filter-hide")
        }, e.showWinner = function(t) {
            return !(e.filters.acName && e.filters.acName.length > 0 && 0 == t.Name.length) && (!(e.filters.acPrize && e.filters.acPrize.length > 0 && 0 == t.Prize.length) && ((!e.filters.acName || !t.Name || t.Name.toLowerCase().indexOf(e.filters.acName.toLowerCase()) !== -1) && ((!e.filters.acPrize || !t.Prize || t.Prize.toLowerCase().indexOf(e.filters.acPrize.toLowerCase()) !== -1) && (!("Archive" === e.filters.year && parseInt(t.Date.Year) > parseInt(m[0].Date.Year)) && (("Archive" === e.filters.year || !e.filters.year || t.Date.Year === e.filters.year) && (!(e.filters.styles && !e.isItemInArray(e.filters.styles, "All Styles") && !e.arrayMatch(e.filters.styles, t.Styles)) && (!(e.filters.make && !e.isItemInArray(e.filters.make, "All Makes") && !e.arrayMatch(e.filters.make, t.Make)) && (!(e.filters.categories && !e.isItemInArray(e.filters.categories, "All Categories") && !e.arrayMatch(e.filters.categories, t.Category)) && (!e.filters.compType || "All Competitions" === e.filters.compType || t.CompType.indexOf(e.filters.compType) !== -1)))))))))
        }, setTimeout(function() {
            e.setFiltersFromCookies(), e.UpdateFiltersVisibility()
        }, 700), $(window).scroll(function() {
            o.put("botb-winner-scroll", $(document).scrollTop())
        }), e.winnerPhotoClick = function(e) {
            var t = e.target;
            $(t).hasClass("img-nest") || (t = $(t).closest(".img-nest"));
            var i = $(t).attr("data-video");
            if (void 0 != i && "" != i)
                if ("true" == $(t).attr("data-iskiosk").toLowerCase())
                    botb.videoPopup.play($(t));
                else {
                    var a = $(t).closest(".has-video");
                    botb.videoInElement.play($(t), a)
                }
        };
        var C = r(e.winners);
        e.autocomplete_options = {
            suggest: c,
            on_select: function(t) {
                e.filters.acName = t.obj.name, e.filters.acPrize = t.obj.prize, e.selected_term = t, $(".winner-search-container").find(".searchclear").unbind("click").click(function(t) {
                    e.selected_term = "", e.filters.acName = "", e.filters.acPrize = "", $(".winner-searchField").val("")
                })
            }
        }, e.syncMobileAndDesktopFilters(), d()
    }, e.syncMobileAndDesktopFilters = function() {
        $(window).resize(function() {
            $(".mobile-filter:visible").length > 0 && (e.updateMobileMakesFilter(), e.updateMobileStylesFilter(), e.updateMobileCategoriesFilter())
        })
    }, e.updateMobileMakesFilter = function() {
        setTimeout(function() {
            e.filters.make = $(".makes-filter-dropdown").val(), e.ensureFiltersDataType(), e.UpdateWinnerCookies(), $(".filter-car-makes-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filters.make, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-car-makes-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-car-makes-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element($(".our-winners").get(0)).scope().$apply()
        }, 750)
    }, e.updateMobileStylesFilter = function() {
        setTimeout(function() {
            e.filters.styles = $(".styles-filter-dropdown").val(), e.ensureFiltersDataType(), e.UpdateWinnerCookies(), $(".filter-car-styles-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filters.styles, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-car-styles-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-car-styles-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element($(".our-winners").get(0)).scope().$apply()
        }, 750)
    }, e.updateMobileCategoriesFilter = function() {
        setTimeout(function() {
            e.filters.categories = $(".category-filter-dropdown").val(), e.ensureFiltersDataType(), e.UpdateWinnerCookies(), $(".filter-lifestyle-categories-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filters.categories, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-lifestyle-categories-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-lifestyle-categories-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element($(".our-winners").get(0)).scope().$apply()
        }, 750)
    }, e.syncMobileAndDesktopFilters = function() {
        $(window).resize(function() {
            $(".mobile-filter:visible").length > 0 && (e.updateMobileMakesFilter(), e.updateMobileStylesFilter(), e.updateMobileCategoriesFilter())
        })
    }, e.updateMobileMakesFilter = function() {
        setTimeout(function() {
            e.filters.make = $(".makes-filter-dropdown").val(), e.ensureFiltersDataType(), e.UpdateWinnerCookies(), $(".filter-car-makes-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filters.make, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-car-makes-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-car-makes-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element($(".our-winners").get(0)).scope().$apply()
        }, 750)
    }, e.updateMobileStylesFilter = function() {
        setTimeout(function() {
            e.filters.styles = $(".styles-filter-dropdown").val(), e.ensureFiltersDataType(), e.UpdateWinnerCookies(), $(".filter-car-styles-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filters.styles, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-car-styles-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-car-styles-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element($(".our-winners").get(0)).scope().$apply()
        }, 750)
    }, e.updateMobileCategoriesFilter = function() {
        setTimeout(function() {
            e.filters.categories = $(".category-filter-dropdown").val(), e.ensureFiltersDataType(), e.UpdateWinnerCookies(), $(".filter-lifestyle-categories-container").find(".checkbox-item").each(function() {
                var t = this;
                e.isItemInArray(e.filters.categories, $(t).val().toLowerCase()) ? ($(t).prop("checked", !0), $(t).closest(".list-option-item").find(".faux-checkbox").addClass("checked")) : ($(t).prop("checked", !1), $(t).closest(".list-option-item").find(".faux-checkbox").removeClass("checked"))
            }), $(".filter-lifestyle-categories-container").find(".list-option-item:not(.all)").find(".checkbox-item:checked").length > 0 && $(".filter-lifestyle-categories-container").find(".arrow").addClass("active"), $(window).scroll(), angular.element($(".our-winners").get(0)).scope().$apply()
        }, 750)
    }, e.applyCompTypeReset = function() {
        var t = ".primary-filter.competition-type",
            i = '<div class="remove active"><b></b></div>';
        $(i).insertBefore($(t).find(".chosen-drop")), $(t).find(".chosen-single").find("div").addClass("hide"), $(t).find(".remove").unbind("click").click(function(i) {
            $(".chosen-select").val("").trigger("chosen:updated"), $(t).find(".chosen-single").find("div").removeClass("hide"), $(t).find(".remove").remove(), e.clearFilters(), e.$apply()
        })
    }
}]), botb.app.controller("BotB.DreamCarWinnerCollectionRepositoryController", ["$scope", "$location", "$filter", "$cookies", function(e, t, i, a) {
    var o = null;
    e.init = function(t) {
        var r = 8,
            n = 2,
            s = null,
            l = 0,
            c = 0;
        s = i("unique")(t, "PickupDate.Year"), s = i("orderBy")(s, "-PickupDate.Year"), l = s.length > r ? s.slice(0, s.length - r) : 0, c = l.length > 0 ? s.slice(l.length, s.length) : s, e.winners = i("orderBy")(t, "-PickupDate.Ticks"), e.yearFilters = {
            yearsArchive: l,
            years: c
        }, e.filters = {
            year: "",
            styles: "All Styles",
            make: "All Makes"
        }, e.master = angular.copy(e.filters), e.filterYears = function(t) {
            e.filters.year = t, e.maxItems = n, null != o && clearTimeout(o), o = setTimeout(function() {
                var e = $(window).height(),
                    t = $(".timeline .fullwidth-container").height();
                t < e / 3 && ($(window).scroll(), o = null)
            }, 1e3)
        }, e.maxItems = n, e.loadMore = function() {
            e.maxItems++
        }, $(window).scroll(function() {
            a.put("botb-car-collection-scroll", $(document).scrollTop())
        });
        var d = a.get("botb-car-collection-scroll");
        if (d)
            var u = setInterval(function() {
                e.loadMore(), e.$apply(), $(document).height() >= d && (e.loadMore(), e.$apply(), e.loadMore(), e.$apply(), $(document).scrollTop(d), clearInterval(u))
            }, 100);
        e.clearFilters = function() {
            angular.copy(e.master, e.filters)
        }, e.showWinner = function(t) {
            return !("Archive" === e.filters.year && parseInt(t.PickupDate.Year) > parseInt(l[l.length - 1].PickupDate.Year)) && ("Archive" === e.filters.year || !e.filters.year || t.PickupDate.Year === e.filters.year)
        }, e.winnerPhotoClick = function(e) {
            var t = e.target;
            $(t).hasClass("watch-car-collection-link") && (t = $(t).siblings(".img-nest")), $(t).hasClass("img-nest") || (t = $(t).closest(".img-nest"));
            var i = $(t).attr("data-video");
            if (void 0 != i && "" != i)
                if ("true" == $(t).attr("data-iskiosk").toLowerCase())
                    botb.videoPopup.play($(t));
                else {
                    var a = $(t).closest(".has-video");
                    botb.videoInElement.play($(t), a)
                }
        }
    }
}]), botb.app.controller("BotB.ArticleRepositoryController", ["$scope", "$location", "$filter", function(e, t, i) {
    var a = null;
    e.init = function(t) {
        var o = 15,
            r = 2,
            n = null,
            s = 0,
            l = 0;
        n = i("unique")(t, "Date.Year"), n = i("orderBy")(n, "-Date.Year"), s = n.length > o ? n.slice(0, n.length - o) : 0, l = s.length > 0 ? n.slice(s.length, n.length) : n, e.articles = i("orderBy")(t, "-Date.Ticks"), e.yearFilters = {
            yearsArchive: s,
            years: l
        }, e.filters = {
            year: ""
        }, e.filterYears = function(t) {
            e.filters.year = t, e.maxItems = r, null != a && clearTimeout(a), a = setTimeout(function() {
                var e = $(window).height(),
                    t = $(".timeline .fullwidth-container").height();
                t < e / 3 && ($(window).scroll(), a = null)
            }, 1e3)
        }, e.maxItems = r, e.loadMore = function() {
            e.maxItems++
        }, e.showArticle = function(t) {
            return !("Archive" === e.filters.year && parseInt(t.Date.Year) > parseInt(s[s.length - 1].Date.Year)) && ("Archive" === e.filters.year || !e.filters.year || t.Date.Year === e.filters.year)
        }
    }
}]), botb.app.controller("BotB.PromoHelperController", ["$scope", "$filter", function(e, t) {
    e.init = function(t) {
        e.promo = t
    }
}]), botb.app.controller("BotB.ImpersonateController", ["$scope", "$http", "$timeout", function(e, t, i) {
    e.searchemail = "", e.searchsurname = "", e.searchpostcode = "", e.searchfirstname = "", e.searchtelephone = "", e.users = [], e.findUser = function(a, o, r, n, s) {
        t({
            method: "GET",
            url: "/Umbraco/api/Customers/FindCustomers?email=" + encodeURIComponent(a) + "&postcode=" + encodeURIComponent(o) + "&surname=" + encodeURIComponent(r) + "&firstname=" + encodeURIComponent(n) + "&telephone=" + encodeURIComponent(s)
        }).success(function(t) {
            $.Notify.clear(), void 0 != t && null != t && 0 != t.length || $.Notify({
                message: "User not found",
                etype: "error"
            }), e.users = t, 1 == t.length && i(function() {
                $("#UserName").val($("#UserName option:first").val())
            }, 250)
        }).error(function(e, t, i, a) {
            console.log("findUser Error:" + JSON.stringify(e))
        })
    }, e.postImpersonate = function(i) {
        t({
            method: "POST",
            url: "/Umbraco/api/Customers/ImpersonateSubmit?email=" + email
        }).success(function(t) {
            console.log("success:" + JSON.stringify(t)), e.users = t
        }).error(function(e, t, i, a) {
            console.log("findUser Error:" + JSON.stringify(e))
        })
    }, e.resetSearchFields = function() {
        e.searchemail = "", e.searchsurname = "", e.searchpostcode = "", e.searchfirstname = "", e.searchtelephone = "", e.users = [], e.$apply()
    }
}]), botb.app.controller("CartTotalController", ["$scope", "$http", "$rootScope", function(e, t, i) {
    t({
        method: "GET",
        url: "/umbraco/botb/cart/GetCartTotal"
    }).success(function(t) {
        e.SetupData(t)
    }).error(function(e, t, i, a) {
        console.log("error:" + JSON.stringify(e))
    }), e.SetupData = function(t) {
        e.CurrencySymbol = t.CurrencySymbol, e.GrandTotal = t.GrandTotal, e.IsCartEmpty = t.IsCartEmpty, e.TotalTicketCount = t.TotalTicketCount, e.FormattedGrandTotal = t.FormattedGrandTotal
    }, i.$on("rootScope:GrandTotal", function(t, i) {
        e.SetupData(i)
    })
}]), botb.app.controller("ShoppingCartController", ["$scope", "$http", "$rootScope", "CarPrizeRepository", "$sce", "$cookies", function(e, t, i, a, o, r) {
    e.showCart = !1, e.loading = !1, e.TotalTicketCount = 0, e.ExpandCartItemId = -1, e.ShowVoucher = !1, e.toggleDiscount = function() {
        e.showvoucher = !e.showvoucher, e.showvoucher ? ($(".toggleDiscountLink").text("Don't have a voucher code?"), setTimeout(function() {
            $("#VoucherCode").focus()
        }, 500)) : $(".toggleDiscountLink").text("Got a voucher code?")
    }, e.toggle = function() {
        e.showCart = !e.showCart, e.showCart && e.FetchCartData(!1)
    }, e.ShowTickets = function() {
        e.showTickets = !e.showTickets
    }, e.addTickets = function(t, i, o) {
        for (var r = null, n = 0; n < e.cart.CartItems.length; n++) {
            var s = e.cart.CartItems[n];
            if (s.CartItemId == t) {
                r = s.PrizeContentNodeId;
                break
            }
        }
        null != r && a.addTickets(o, r, i, function(e) {
            var t = $(window).width();
            t <= 640 && $(".notifications-panel").find(".notifications").addClass("active")
        }, !0)
    }, e.AddProduct = function(i) {
        t({
            method: "GET",
            url: "/umbraco/botb/cart/AddProduct?sku=" + i
        }).success(function(t) {
            e.SetupData(t), t && !t.ValidationPassed && $.Notify({
                message: "We have removed some items from your basket that are no longer available. Please check your basket.",
                etype: "warning"
            })
        }).error(function(e, t, i, a) {
            console.log("AddProduct Error:" + JSON.stringify(e))
        })
    }, e.removeUnplayedTicket = function(t, i, o, r) {
        for (var n = r.target, s = null, l = 0; l < e.cart.CartItems.length; l++) {
            var c = e.cart.CartItems[l];
            if (c.CartItemId == t) {
                s = c.PrizeContentNodeId;
                break
            }
        }
        null != s && a.removeUnplayedTicket(t, o, s, i, function(e) {
            switch (e.data.RemoveUnplayedTicketStatusResult) {
            case 1:
                botb && botb.spotTheBall && botb.spotTheBall.controller && botb.spotTheBall.controller.reloadBasket();
                break;
            case 2:
                var t = $(n).closest("table").next("table"),
                    i = $(t).is(":visible");
                i || $(t).removeClass("ng-hide"), alert("You are attempting to delete a played ticket with coordinates already selected. Please use the drop-down arrow to the right of the prize in your basket to choose which ticket to delete.")
            }
        })
    }, e.RemoveProduct = function(i) {
        confirm("Please confirm if you want to remove this line item?") && t({
            method: "GET",
            url: "/umbraco/botb/cart/RemoveProduct?cartItemId=" + i
        }).success(function(t) {
            e.SetupData(t), t && !t.ValidationPassed && $.Notify({
                message: "We have removed some items from your basket that are no longer available. Please check your basket.",
                etype: "warning"
            }), botb && botb.spotTheBall && botb.spotTheBall.controller && botb.spotTheBall.controller.reloadBasket()
        }).error(function(e, t, i, a) {
            console.log("RemoveProduct Error:" + JSON.stringify(e))
        })
    }, e.RemoveTicket = function(i, a) {
        t({
            method: "GET",
            url: "/umbraco/botb/cart/RemoveTicket?ticketId=" + i
        }).success(function(t) {
            e.SetupData(t), e.ExpandCartItemId = a, t && !t.ValidationPassed && $.Notify({
                message: "We have removed some items from your basket that are no longer available. Please check your basket.",
                etype: "warning"
            }), botb && botb.spotTheBall && botb.spotTheBall.controller && botb.spotTheBall.controller.reloadBasket()
        }).error(function(e, t, i, a) {
            console.log("RemoveProduct Error:" + JSON.stringify(e))
        })
    }, e.FetchCartData = function(i) {
        e.loading = !0, i || (i = "false"), t({
            method: "GET",
            url: "/umbraco/botb/cart/CartGet?validateCart=" + i
        }).success(function(t) {
            e.SetupData(t), t && !t.ValidationPassed && $.Notify({
                message: "We have removed some items from your basket that are no longer available. Please check your basket.",
                etype: "warning"
            }), t && t.FreeTicketsAdded && $.Notify({
                message: "Free tickets have been added to your cart. Please check your basket.",
                etype: "info"
            }), e.loading = !1, BOTBapp.isTouchDevice() || setTimeout(function() {
                var e = $(".basket-discounts").find(".info-icon.as-html");
                $(e).tooltipster({
                    content: $($(e).attr("tooltip-content")).html(),
                    multiple: !1,
                    position: "bottom",
                    delay: 0,
                    contentAsHTML: !0
                });
                var t = $(".basket-game-credit").find(".info-icon.as-html");
                $(t).tooltipster({
                    content: $($(t).attr("tooltip-content")).html(),
                    multiple: !1,
                    position: "bottom",
                    delay: 0,
                    contentAsHTML: !0
                });
                var i = $(".add-btn").find(".info-icon").not(".as-html");
                $(i).tooltipster({
                    content: $(i).attr("title"),
                    multiple: !1,
                    position: "bottom",
                    delay: 0
                });
                var a = $(".add-btn").find(".info-icon.as-html");
                $(a).tooltipster({
                    content: $($(a).attr("tooltip-content")).html(),
                    multiple: !1,
                    position: "bottom",
                    delay: 0,
                    contentAsHTML: !0
                })
            }, 1e3)
        }).error(function(t, i, a, o) {
            console.log("error:" + JSON.stringify(t)), e.loading = !1
        })
    }, e.SetupData = function(t) {
        e.cart = t, e.TotalTicketCount = t.TotalTicketCount, e.TotalTicketValue = t.TotalTicketValue, e.FormattedTotalTicketValue = t.FormattedTotalTicketValue, e.TotalValueOfTicketsAndExtensions = t.TotalValueOfTicketsAndExtensions, e.FormattedTotalValueOfTicketsAndExtensions = t.FormattedTotalValueOfTicketsAndExtensions, e.PrizeExtensionTotal = t.PrizeExtensionTotal, e.MultiBuyDiscountTotal = t.MultiBuyDiscountTotal, e.FormattedMultiBuyDiscountTotal = t.FormattedMultiBuyDiscountTotal, e.MultiBuyDiscountText = t.MultiBuyDiscountText, e.SuperchargedDiscount = t.SuperchargedDiscountTotal, e.FormattedSuperchargedDiscountTotal = t.FormattedSuperchargedDiscountTotal, e.CurrencySymbol = t.CurrencySymbol, e.DiscountCodeTotal = t.DiscountCodeTotal, e.FormattedDiscountCodeTotal = t.FormattedDiscountCodeTotal, e.GameCreditAvailable = t.GameCreditAvailable, e.GameCreditUsed = t.GameCreditUsedTotal, e.FormattedGameCreditUsed = t.FormattedGameCreditUsedTotal, e.TotalValue = t.TotalValue, e.Subtotal = t.Subtotal, e.FormattedSubtotal = t.FormattedSubtotal, e.GrandTotal = t.GrandTotal, e.VoucherCode = t.VoucherCode, e.TotalTicketsPaid = t.TotalTicketsPaid, e.UseNewMultiBuyWording = e.ShouldUseNewMultiBuyWording(), e.FormattedGrandTotal = t.FormattedGrandTotal, i.$broadcast("rootScope:GrandTotal", t), setTimeout(function() {
            var e = $(".add-btn").find(".info-icon").not(".as-html");
            $(e).tooltipster({
                content: $(e).attr("title"),
                multiple: !1,
                position: "bottom",
                delay: 0
            });
            var e = $(".add-btn").find(".info-icon.as-html");
            $(e).tooltipster({
                content: $($(e).attr("tooltip-content")).html(),
                multiple: !1,
                position: "bottom",
                delay: 0,
                contentAsHTML: !0
            })
        }, 1e3)
    }, e.ToggleShowTickets = function(t, i) {
        e.ExpandCartItemId = -1, t.showTickets = !t.showTickets;
        var a = i.target;
        t.showTickets ? $(a).addClass("active") : $(a).removeClass("active")
    }, e.AddVoucherCode = function(i) {
        t({
            method: "GET",
            url: "/umbraco/botb/cart/AddVoucherCode?voucherCode=" + i
        }).success(function(t) {
            var i = "",
                a = "",
                o = !1;
            1 == t.Status && (i = "Voucher code applied", a = "info", o = !0), 2 == t.Status && (i = "Dream Car credits voucher applied", a = "info", $("#gameCreditHeader").text(t.FormattedTotalGameCredits), o = !0), 3 == t.Status && (i = t.Message, a = "info", $("#gameCreditHeader").text(t.FormattedTotalGameCredits), o = !0), t.Status == -2 && (i = "Voucher code not accepted: Voucher already redeemed", a = "error"), t.Status == -1 && (i = "Voucher code not accepted: Voucher code invalid", a = "error"), t.Status == -3 && (i = "Voucher code not accepted: User must log in to redeem this voucher", a = "error"), $.Notify({
                message: i,
                etype: a
            }), $("#VoucherMessage").text(i), e.SetupData(t.Cart), o && setTimeout(function() {
                e.FetchCartData(!0)
            }, 700)
        }).error(function(e, t, i, a) {
            console.log("AddVoucherCode Error:" + JSON.stringify(e)), $("#VoucherMessage").text("Error applying voucher code"), $.Notify({
                message: "Error applying voucher code",
                etype: "error"
            })
        })
    }, e.HandleVoucherCode = function() {
        var t = getUrlVars(!0),
            i = t.vouchercode;
        i && e.AddVoucherCode(i)
    }, e.HandleVoucherCode(), e.showSelectFreeTicket = function(i, a) {
        e.prizes = null, t({
            method: "GET",
            url: "/umbraco/api/dreamcar/getfreeticketsbylevel"
        }).success(function(t) {
            e.prizes = t.Results
        }), e.ShowFreePrizeListModal = !0, $(".free-prize-container").addClass("active"), $("body").addClass("no-scroll"), e.redirectToStb = i, e.redirectToCheckout = a, BOTBapp.hideCart();
        var o = $(".currency-menu");
        o.css("position", "relative"), o.css("z-index", "-1"), o.removeClass("active")
    }, e.confirmFreeTicket = function(i) {
        t({
            method: "GET",
            url: "/umbraco/botb/cart/choosefreeticket?contentNodeId=" + i
        }).success(function(e) {}), setTimeout(function() {
            return e.closeSelectFreeTicket(), e.prizes = null, angular.element(document.getElementById("cartId")).scope().FetchCartData(!0), 1 == e.redirectToStb ? window.location.replace(e.cart.SpotTheBallUrl) : 1 == e.redirectToCheckout ? window.location.replace("/checkout") : botb && botb.spotTheBall && botb.spotTheBall.controller ? botb.spotTheBall.controller.reloadBasket() : BOTBapp.showCart(!0), !0
        }, 1e3)
    }, e.closeSelectFreeTicket = function() {
        e.ShowFreePrizeListModal = !1, $(".free-prize-container").removeClass("active"), $("body").removeClass("no-scroll");
        var t = $(".currency-menu");
        t.css("z-index", "0")
    }, e.chooseFreeTicket = function(t) {
        var i;
        e.lastFreeTicket && (i = $("#choosePrize-" + e.lastFreeTicket), i.css("border", "3px solid #ffffff"), i.parent().children(".quick-view").css("display", "none")), i = $("#choosePrize-" + t), i.css("border", "3px solid #ff8200"), i.parent().children(".quick-view").css("display", "block"), e.lastFreeTicket = t
    }, e.rotateImage = function(e) {
        var t = "#cartimage-" + e,
            i = $(t)[0];
        i.naturalWidth - i.naturalHeight < 0 && $(t).addClass("rotated-basket-thumbnail")
    }, e.ShouldUseNewMultiBuyWording = function() {
        var e = $(".cartParent").find(".multibuy-mode").val();
        switch (e.length > 0 && (e = e.toLocaleLowerCase()), e) {
        case "old":
            return !1;
        case "new":
            return !0;
        case "abtest":
        }
        var t = r.get("botb-multibuy-wording");
        if (!(void 0 != t && t.length > 0)) {
            var i = new Date;
            i.setMonth(i.getMonth() + 12);
            var a = Math.floor(2 * Math.random()) + 1;
            return 1 == a ? (botb.cookie.setCookie("botb-multibuy-wording", "No MultiBuy CTA", 365), !1) : (botb.cookie.setCookie("botb-multibuy-wording", "MultiBuy Pricing", 365), !0)
        }
        switch (t) {
        case "Legacy MultiBuy":
            return !1;
        case "MultiBuy Pricing":
            return !0
        }
    }, e.showPrizeExtensionPopup = function(e) {
        var t = $(".tooltip-templates").find(e);
        botb.messagePopup.show($(t).text())
    }
}]), botb.app.controller("CheckoutController", ["$scope", "$http", "CartRepository", function(e, t, i) {
    e.showCart = !1, e.checkingOut = !1, e.oldVoucherText = "", e.TotalTicketCount = 0, e.ExpandCartItemId = -1, e.OriginalGameCredit = 0, e.VoucherCode = "", e.toggleDiscount = function() {
        e.showvoucher = !e.showvoucher, e.showvoucher ? (e.oldVoucherText = $(".toggleDiscountLinkCheckout").text(), $(".toggleDiscountLinkCheckout").text("Don't have a voucher code")) : $(".toggleDiscountLinkCheckout").text(e.oldVoucherText)
    }, e.AddProduct = function(i) {
        t({
            method: "GET",
            url: "/umbraco/botb/cart/AddProduct?sku=" + i
        }).success(function(t) {
            e.cart = t, e.FetchCartData()
        }).error(function(e, t, i, a) {
            console.log("AddProduct Error:" + JSON.stringify(e))
        })
    }, e.RemoveProduct = function(i, a) {
        a.preventDefault(), confirm("Please confirm if you want to remove this line item?") && t({
            method: "GET",
            url: "/umbraco/botb/cart/RemoveProduct?cartItemId=" + i
        }).success(function(t) {
            e.cart = t, e.FetchCartData()
        }).error(function(e, t, i, a) {
            console.log("RemoveProduct Error:" + JSON.stringify(e))
        })
    }, e.RemoveTicket = function(i, a) {
        t({
            method: "GET",
            url: "/umbraco/botb/cart/RemoveTicket?ticketId=" + i
        }).success(function(t) {
            e.cart = t, e.ExpandCartItemId = a, e.FetchCartData()
        }).error(function(e, t, i, a) {
            console.log("RemoveProduct Error:" + JSON.stringify(e))
        })
    }, e.FetchCartData = function() {
        i.getCart(function(t) {
            if (e.cart = t, e.OriginalGameCredit = e.cart.GameCreditUsedTotal, $("#UserSpecifiedGameCreditHidden").val(Math.abs(e.cart.GameCreditUsedTotal)), $("#gameCreditHeader").text(t.FormattedTotalGameCredits), e.cart.GrandTotal > 0 ? ($("#cartPaymentMethod").show(), $("#cartBillingAddress").show(), $("#cartCardDetails").show()) : ($("#cartPaymentMethod").hide(), $("#cartBillingAddress").hide(), $("#cartCardDetails").hide()), !BOTBapp.isTouchDevice()) {
                var i = $(".checkoutLink").find(".info-icon").not(".as-html");
                $(i).tooltipster({
                    content: $(i).attr("title"),
                    multiple: !1,
                    position: "bottom",
                    delay: 0
                })
            }
        }), $("#addressfieldserror") && "" !== $("#addressfieldserror").text() && setTimeout(function() {
            $("html, body").animate({
                scrollTop: $("#addressfieldserror").offset().top - 250
            }, 1e3)
        }, 2e3), $("#cardfieldserror") && "" !== $("#cardfieldserror").text() && setTimeout(function() {
            $("html, body").animate({
                scrollTop: $("#cardfieldserror").offset().top - 250
            }, 1e3)
        }, 2e3), $("#cardpayingerror") && "" !== $("#cardpayingerror").text() && setTimeout(function() {
            $("html, body").animate({
                scrollTop: $("#cardpayingerror").offset().top - 250
            }, 1e3)
        }, 2e3), $("#cardsavingerror") && "" !== $("#cardsavingerror").text() && setTimeout(function() {
            $("html, body").animate({
                scrollTop: $("#cardsavingerror").offset().top - 250
            }, 1e3)
        }, 2e3), $("#OpenAddressPanel") && "" !== $("#OpenAddressPanel").text() && "True" == $("#OpenAddressPanel").text() && ($("#div-billingDetails").show(), $("#billing-address").hide())
    }, e.ToggleShowCoords = function(t, i) {
        e.ExpandCartItemId = -1, t.showCoords = !t.showCoords;
        var a = i.target;
        t.showCoords ? ($(a).html('<span class="checkout-chevron"></span>'), $(a).addClass("active"), $(".coordinates-row").fadeIn("slow")) : ($(a).html('<span class="checkout-chevron"></span>'), $(a).removeClass("active"), $(".coordinates-row").fadeOut("slow"))
    }, e.KioskToggleShowCoords = function(e, t) {
        var i = t.target,
            a = $(i).closest(".details-table").siblings(".entries-table");
        $(a).is(":visible") ? ($(i).html($(i).attr("data-text-show") + '<span class="checkout-chevron"></span>'), $(i).removeClass("active"), $(a).fadeOut("fast")) : ($(i).html($(i).attr("data-text-hide") + '<span class="checkout-chevron"></span>'), $(i).addClass("active"), $(a).fadeIn("fast"))
    }, e.AddVoucherCode = function(i) {
        t({
            method: "GET",
            url: "/umbraco/botb/cart/AddVoucherCode?voucherCode=" + i
        }).success(function(t) {
            var i = "",
                a = "",
                o = "";
            1 == t.Status && (i = "Voucher code applied", a = "info"), 2 == t.Status && (i = "Dream Car credits voucher applied", a = "info", t.Cart.GrandTotal <= 0 && ($("#UserSpecifiedGameCreditHidden").val(Math.abs(t.Cart.GameCreditUsedTotal)), $(".payment-methods-container").hide(), $("#cartPaymentMethod").hide(), $("#cartBillingAddress").hide(), $("#cartCardDetails").hide()), e.UpdatePaymentTypesKiosk(t)), t.Status == -2 && (i = "Voucher code not accepted: Voucher already redeemed", a = "error", o = "error"), t.Status == -1 && (i = "Voucher code not accepted: Voucher code invalid", a = "error", o = "error"), t.status == -3 && (i = "Voucher code not accepted: User must log in to redeem this voucher", a = "error", o = "error"), $.Notify({
                message: i,
                etype: a
            }), $("#VoucherMessageForm").text(i), "" != o && $("#VoucherMessageForm").addClass(o), e.FetchCartData()
        }).error(function(e, t, i, a) {
            console.log("AddVoucherCode Error:" + JSON.stringify(e)), $("#VoucherMessageForm").text("Error applying voucher code").addClass("error"), $.Notify({
                message: "Error applying voucher code",
                type: "error"
            })
        })
    }, e.UpdateTotalWithGameCredit = function(t) {
        if ("" == e.cart.UserSpecifiedGameCreditTotal) {
            var i = $(".edit-gc-input").attr("data-preplaceholder");
            isNaN(parseFloat(i)) || (e.cart.UserSpecifiedGameCreditTotal = Math.abs(i).toFixed(2))
        }
        var a = e.cart.FormattedGrandTotal.substring(0, 1),
            o = e.cart.FormattedGrandTotal.indexOf(","),
            r = e.cart.FormattedGrandTotal.indexOf(".");
        o == -1 && r == -1 && (o = 1);
        var n = e.cart.UserSpecifiedGameCreditTotal,
            s = Number(n);
        if (isNaN(s) || s < 0)
            switch (t) {
            case 0:
                $.Notify({
                    message: "Dream Car credit entered must be a valid, positive number with no decimal places.",
                    etype: "error"
                });
                break;
            default:
                $.Notify({
                    message: "Dream Car credit entered must be a valid, positive number with up to " + t + " decimal places.",
                    etype: "error"
                })
            }
        else {
            var l = e.cart.GameCreditAvailable;
            if (s > l)
                return void $.Notify({
                    message: "Dream Car credit entered cannot be more than available Dream Car Credit.",
                    etype: "error"
                });
            var c = e.cart.GameCreditUsedTotal,
                d = e.cart.GrandTotal;
            s = Math.round(100 * s) / 100, e.cart.UserSpecifiedGameCreditTotal = s;
            var u = d - c - s;
            if (u < e.cart.GameCreditNotRedeemableTicketValue)
                return void $.Notify({
                    message: "Dream Car Credit can only be redeemed against Dream Car competition tickets.  The total cost of your Dream Car Tickets is " + e.cart.FormattedGCRedeemableTotal + ".  If you wish to reduce the amount of Dream Car Credit you use in this order, you can amend the amount in the box below.",
                    etype: "error"
                });
            o >= 0 && (e.cart.FormattedGrandTotal = a + u.toFixed(t).replace(".", ",")), r >= 0 && (e.cart.FormattedGrandTotal = a + u.toFixed(t)), $("#UserSpecifiedGameCreditHidden").val(s), e.cart.FormattedGameCreditUsedTotal = "-" + a + s.toFixed(t), u > 0 ? ($("#cartPaymentMethod").show(), $("#cartBillingAddress").show(), $("#cartCardDetails").show()) : ($("#cartPaymentMethod").hide(), $("#cartBillingAddress").hide(), $("#cartCardDetails").hide()), e.CancelEditGameCredit(), e.UpdateUiIfKiosk()
        }
    }, e.EditGameCredit = function() {
        var e = $(".checkout");
        $(e).find("#display-gc").removeClass("active"), $(e).find("#edit-gc").addClass("active"), setTimeout(function() {
            $(".edit-gc-input").focus().setCursorPosition(0)
        }, 500);
        var t = $(".edit-gc-input").attr("data-preplaceholder");
        isNaN(parseFloat(t)) || $(".edit-gc-input").attr("placeholder", Math.abs(t).toFixed(2)), $(".edit-gc-input").val("")
    }, e.CancelEditGameCredit = function() {
        var e = $(".checkout");
        $(e).find("#display-gc").addClass("active"), $(e).find("#edit-gc").removeClass("active");
    }, e.UpdateUiIfKiosk = function() {
        var t = $(".checkout"),
            i = $(t).hasClass("kiosk-checkout");
        if (i && e.cart.UserSpecifiedGameCreditTotal >= 0) {
            $(t).find(".payment-method-row").addClass("hide");
            var a = $.ajax({
                type: "POST",
                url: "/umbraco/surface/CheckoutSurface/GetPaymentTypesForGameCredit?gameCreditToUse=" + e.cart.UserSpecifiedGameCreditTotal,
                dataType: "json",
                contentType: "application/json",
                cache: !1,
                processData: !1
            });
            a.done(function(e) {
                if (!(e.CartAmount <= 0)) {
                    for (var i = "", a = 0; a < e.PaymentTypes.length; a++) {
                        var o = e.PaymentTypes[a];
                        i += '<option data-paytype="' + o.PayType + '" data-amount="' + o.Amount + '" value="' + o.ValueText + '">' + o.DisplayText + "</option>"
                    }
                    $(t).find("#PaymentType").html(i), $(t).find(".payment-method-row").removeClass("hide"), $(t).find(".txn-row").removeClass("hide"), $.Notify.clear(), $.Notify({
                        message: "Your cart has been updated. Please check the payment method",
                        etype: "info"
                    })
                }
            }), a.fail(function(e, t, i) {
                $.Notify.clear(), $.Notify({
                    message: "An error occurred while trying to calculate your cart. Please try again",
                    etype: "error"
                })
            })
        }
    }, e.UpdatePaymentTypesKiosk = function(e) {
        var t = $(".checkout"),
            i = $(t).hasClass("kiosk-checkout");
        if (i && void 0 != e.PaymentTypes) {
            for (var a = "", o = 0; o < e.PaymentTypes.length; o++) {
                var r = e.PaymentTypes[o];
                a += '<option data-paytype="' + r.PayType + '" data-amount="' + r.Amount + '" value="' + r.ValueText + '">' + r.DisplayText + "</option>"
            }
            $(t).find("#PaymentType").html(a)
        }
    }, e.FetchCartData(), e.showPrizeExtensionPopup = function(e) {
        var t = $(".tooltip-templates").find(e);
        botb.messagePopup.show($(t).text())
    }, e.$watch("cart.GameCreditUsedTotal", function(e, t) {
        var i = $(".checkout"),
            a = $(i).find("#edit-gc").hasClass("active");
        if (a) {
            isNaN(parseFloat(e)) || $(".edit-gc-input").attr("placeholder", Math.abs(e).toFixed(2))
        }
    }), e.showPrizeExtensionPopup = function(e) {
        var t = $(".tooltip-templates").find(e);
        botb.messagePopup.show($(t).text())
    }, angular.element(document).ready(function() {
        BOTBapp.hideCartTotal(), /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) && $(".checkout").find(".tooltip").unbind("mouseenter").unbind("mouseleave").tooltipster("destroy"), BOTBapp.isTouchDevice() || setTimeout(function() {
            var e = $(".checkoutLink").find(".tooltip-delay").not(".as-html");
            $(e).tooltipster({
                content: $(e).attr("title"),
                multiple: !1,
                position: "bottom",
                delay: 0
            });
            var t = $(".checkoutLink").find(".tooltip-delay.as-html");
            $(t).tooltipster({
                content: $($(t).attr("tooltip-content")).html(),
                multiple: !1,
                position: "bottom",
                delay: 0,
                contentAsHTML: !0
            })
        }, 1e3)
    })
}]), botb.app.controller("CheckoutCompleteController", ["$scope", "$http", "OrderRepository", function(e, t, i) {
    e.showCart = !1, e.TotalTicketCount = 0, e.ExpandCartItemId = -1, e.VoucherCode = "", e.FetchOrderData = function(t) {
        i.getLastOrder(t, function(t) {
            e.order = t
        })
    }, e.ToggleShowCoords = function(t, i) {
        e.ExpandCartItemId = -1, t.showCoords = !t.showCoords;
        var a = i.target;
        t.showCoords ? ($(a).html('&nbsp;&nbsp;HIDE DETAILS&nbsp;<span class="checkout-chevron"></span>'), $(a).addClass("active"), $(".coordinates-row").fadeIn("slow")) : ($(a).html('SHOW DETAILS<span class="checkout-chevron"></span>'), $(a).removeClass("active"), $(".coordinates-row").fadeOut("slow"))
    }, angular.element(document).ready(function() {
        BOTBapp.hideCartTotal()
    })
}]), botb.app.filter("slice", function() {
    return function(e, t, i) {
        return e.slice(t, i)
    }
}), botb.app.controller("BotB.MultipleChoiceController", ["$scope", "$location", "$filter", "$sce", "$q", "$http", "$cookies", "$window", "orderByFilter", function(e, t, i, a, o, r, n, s, l) {
    var c = new URLSearchParams(window.location.search),
        d = c.get("cguid");
    e.questionAnswered = !1, e.SetAnswerOnTickets = function(t, i) {
        r({
            method: "GET",
            url: "/umbraco/botb/multiplechoice/SetAnswerOnTickets?answerid=" + i + "&competitionguid=" + d
        }).success(function(a) {
            1 === a.ResponseType && (console.log("success:" + JSON.stringify(a)), $(".multiple_choice_answers div").removeClass("selected"), $("#Answer_" + i).addClass("selected"), e.questionAnswered = !0, $.Notify({
                message: "The answer " + t + " has been set",
                etype: "info"
            }))
        }).error(function(e, t, i, a) {
            console.log("AddProduct Error:" + JSON.stringify(e))
        })
    }, e.ManageUnplayedTicketsModal = function(t) {
        e.questionAnswered || ($("#popup_Container").css("display", "block"), t.stopPropagation(), t.preventDefault())
    }, e.CloseUnplayedTicketsModal = function() {
        $("#popup_Container").css("display", "none")
    }
}]);
var HEADER_NAME = "Botb-Handle-Errors-Generically",
    specificallyHandleInProgress = !1;
String.format = function() {
    for (var e = arguments[0], t = 1; t < arguments.length; t++) {
        var i = new RegExp("\\{" + (t - 1) + "\\}", "gm");
        e = e.replace(i, arguments[t])
    }
    return e
}, angular.module("botb").factory("RequestsErrorHandler", ["$q", function(e) {
    return {
        specificallyHandled: function(e) {
            specificallyHandleInProgress = !0;
            try {
                return e()
            } finally {
                specificallyHandleInProgress = !1
            }
        },
        responseError: function(t) {
            var i = t && t.config && t.config.headers && t.config.headers[HEADER_NAME];
            return i && (console.log(t), $.Notify({
                message: t.data.MessageDetail,
                etype: "error"
            })), e.reject(t)
        }
    }
}]), angular.module("botb").config(["$provide", "$httpProvider", function(e, t) {
    function i(e) {
        return e = e || {}, e.headers = e.headers || {}, specificallyHandleInProgress || (e.headers[HEADER_NAME] = !0), e
    }
    t.interceptors.push("RequestsErrorHandler"), e.decorator("$http", ["$delegate", function(e) {
        function t(t) {
            return function(a, o) {
                return e[t](a, i(o))
            }
        }
        function a(t) {
            return function(a, o, r) {
                return e[t](a, o, i(r))
            }
        }
        function o(t) {
            for (var i in e)
                t.hasOwnProperty(i) || ("function" == typeof e[i] ? t[i] = function() {
                    return e[i].apply(e, arguments)
                } : t[i] = e[i])
        }
        var r = function(t) {
            return e(i(t))
        };
        return r.get = t("get"), r["delete"] = t("delete"), r.head = t("head"), r.jsonp = t("jsonp"), r.post = a("post"), r.put = a("put"), o(r), r
    }])
}]), angular.module("botb").factory("CarPrizeRepository", ["$http", "RequestsErrorHandler", function(e, t) {
    return {
        prizeSearch: function(t, i, a) {
            e.get("/umbraco/api/dreamcar/prizesearch", {
                params: {
                    sortOrder: t,
                    quantityOfResults: i
                }
            }).success(function(e) {
                a(e)
            })
        },
        getPrizes: function(t, i) {
            e.get("/umbraco/api/dreamcar/getprizes", {
                params: {
                    prizeIds: t
                }
            }).success(function(e) {
                i(e)
            })
        },
        getPrizesIncludingUnpublished: function(t, i) {
            e.get("/umbraco/api/dreamcar/getprizesincludingunpublished", {
                params: {
                    prizeIds: t
                }
            }).success(function(e) {
                i(e)
            })
        },
        getRecommendedPrizes: function(t, i) {
            e.get("/umbraco/api/dreamcar/getrecommendedprizes", {
                params: {
                    prizeId: t
                }
            }).success(function(e) {
                i(e)
            })
        },
        getPopularPrizes: function(t, i) {
            e.get("/umbraco/api/dreamcar/getpopularprizes", {
                params: {
                    competitionId: t
                }
            }).success(function(e) {
                i(e)
            })
        },
        addTickets: function(i, a, o, r, n) {
            t.specificallyHandled(function() {
                e.post("/umbraco/botb/cart/addtickets?competitionId=" + i + "&prizeContentNodeId=" + a + "&quantityToAdd=" + o, {}).then(function(e) {
                    if (r(e), e.data.CartValid || $.Notify({
                        message: "We have removed some items from your basket that are no longer available. Please check your basket.",
                        etype: "warning"
                    }), angular.element(document.getElementById("cartId")).scope().FetchCartData(!0), "undefined" !== e && null != e)
                        switch (e.data.AddTicketStatusResult) {
                        case 1:
                            var t = e.data.TicketsAdded,
                                i = "{number_of_tickets} added to the basket.";
                            1 == t ? i = i.replace("{number_of_tickets}", t + " ticket") : t > 1 && (i = i.replace("{number_of_tickets}", t + " tickets")), $.Notify({
                                message: i,
                                etype: "info"
                            });
                            try {
                                angular.element(document.getElementById("our-cars-controller-container")).scope().showKioskPopupConfirmation()
                            } catch (o) {}
                            "undefined" != typeof dataLayer && dataLayer.push({
                                event: "ticketAdded",
                                promo_id: 6,
                                product_id: e.data.PrizeName
                            }), botb && botb.spotTheBall && botb.spotTheBall.controller && botb.spotTheBall.controller.reloadBasket();
                            break;
                        case 2:
                            $.Notify({
                                message: String.format("You have reached the maximum permitted quantity of {0} tickets for this competition. For the avoidance of doubt, each individual is limited to {0} tickets and you may not exceed this number by using additional accounts. Abuse of this limit will lead to disqualification of all entries without compensation.", e.data.TicketLimit),
                                etype: "error"
                            }), n = !0;
                            break;
                        case 3:
                            $.Notify({
                                message: "Your loyalty level is too low to add tickets for this prize.",
                                etype: "error"
                            })
                        }
                    void 0 != n && n || BOTBapp && BOTBapp.showCart(!1, a)
                }, function(e) {
                    console.log(e), $.Notify({
                        message: 'We have been unable to add tickets to your basket, please try again or <a href="/contact-us">get in touch.</a>',
                        etype: "error"
                    })
                })
            })
        },
        removeUnplayedTicket: function(i, a, o, r, n) {
            t.specificallyHandled(function() {
                var t = {
                    cartItemId: i,
                    competitionId: a,
                    prizeContentNodeId: o,
                    quantityToRemove: r
                };
                e.post("/umbraco/botb/cart/removeunplayedtickets?cartItemId=" + i + "&competitionId=" + a + "&prizeContentNodeId=" + o + "&quantityToRemove=" + r, t).then(function(e) {
                    if (n(e), "undefined" !== e && null != e)
                        switch (e.data.RemoveUnplayedTicketStatusResult) {
                        case 1:
                            var t = e.data.TicketsRemoved,
                                i = "{number_of_tickets} removed from the basket.";
                            1 == t ? i = i.replace("{number_of_tickets}", t + " ticket") : t > 1 && (i = i.replace("{number_of_tickets}", t + " tickets")), $.Notify({
                                message: i,
                                etype: "info"
                            }), angular.element(document.getElementById("cartId")).scope().FetchCartData(!0);
                            try {
                                angular.element(document.getElementById("our-cars-controller-container")).scope().showKioskPopupConfirmation()
                            } catch (a) {}
                            break;
                        case 2:
                        }
                }, function(e) {
                    $.Notify({
                        message: 'We have been unable to remove ticket from your basket, please try again or <a href="/contact-us">get in touch.</a>',
                        etype: "error"
                    })
                })
            })
        }
    }
}]).factory("MidweekPrizeRepository", ["$http", "RequestsErrorHandler", function(e, t) {
    return {
        prizeSearch: function(t, i, a) {
            e.get("/umbraco/api/midweek/prizesearch", {
                params: {
                    sortOrder: t,
                    quantityOfResults: i
                }
            }).success(function(e) {
                a(e)
            })
        },
        getPrizes: function(t, i) {
            e.get("/umbraco/api/midweek/getprizes", {
                params: {
                    prizeIds: t
                }
            }).success(function(e) {
                i(e)
            })
        },
        getPrizesIncludingUnpublished: function(t, i) {
            e.get("/umbraco/api/midweek/getprizesincludingunpublished", {
                params: {
                    prizeIds: t
                }
            }).success(function(e) {
                i(e)
            })
        },
        getRecommendedPrizes: function(t, i) {
            e.get("/umbraco/api/midweek/getrecommendedprizes", {
                params: {
                    prizeId: t
                }
            }).success(function(e) {
                i(e)
            })
        },
        getPopularPrizes: function(t, i) {
            e.get("/umbraco/api/midweek/getpopularprizes", {
                params: {
                    competitionId: t
                }
            }).success(function(e) {
                i(e)
            })
        },
        addTickets: function(i, a, o, r, n) {
            t.specificallyHandled(function() {
                e.post("/umbraco/botb/cart/addtickets?competitionId=" + i + "&prizeContentNodeId=" + a + "&quantityToAdd=" + o, {}).then(function(e) {
                    if (r(e), e.data.CartValid || $.Notify({
                        message: "We have removed some items from your basket that are no longer available. Please check your basket.",
                        etype: "warning"
                    }), angular.element(document.getElementById("cartId")).scope().FetchCartData(!0), "undefined" !== e && null != e)
                        switch (e.data.AddTicketStatusResult) {
                        case 1:
                            var t = e.data.TicketsAdded,
                                i = "{number_of_tickets} added to the basket.";
                            1 == t ? i = i.replace("{number_of_tickets}", t + " ticket") : t > 1 && (i = i.replace("{number_of_tickets}", t + " tickets")), $.Notify({
                                message: i,
                                etype: "info"
                            });
                            try {
                                angular.element(document.getElementById("our-cars-controller-container")).scope().showKioskPopupConfirmation()
                            } catch (o) {}
                            "undefined" != typeof dataLayer && dataLayer.push({
                                event: "ticketAdded",
                                promo_id: 6,
                                product_id: e.data.PrizeName
                            }), botb && botb.spotTheBall && botb.spotTheBall.controller && botb.spotTheBall.controller.reloadBasket();
                            break;
                        case 2:
                            $.Notify({
                                message: String.format("You have reached the maximum permitted quantity of {0} tickets for this competition. For the avoidance of doubt, each individual is limited to {0} tickets and you may not exceed this number by using additional accounts. Abuse of this limit will lead to disqualification of all entries without compensation.", e.data.TicketLimit),
                                etype: "error"
                            }), n = !0;
                            break;
                        case 3:
                            $.Notify({
                                message: "Your loyalty level is too low to add tickets for this prize.",
                                etype: "error"
                            })
                        }
                    void 0 != n && n || BOTBapp && BOTBapp.showCart(!1, a)
                }, function(e) {
                    console.log(e), $.Notify({
                        message: 'We have been unable to add tickets to your basket, please try again or <a href="/contact-us">get in touch.</a>',
                        etype: "error"
                    })
                })
            })
        },
        removeUnplayedTicket: function(i, a, o, r, n) {
            t.specificallyHandled(function() {
                var t = {
                    cartItemId: i,
                    competitionId: a,
                    prizeContentNodeId: o,
                    quantityToRemove: r
                };
                e.post("/umbraco/botb/cart/removeunplayedtickets?cartItemId=" + i + "&competitionId=" + a + "&prizeContentNodeId=" + o + "&quantityToRemove=" + r, t).then(function(e) {
                    if (n(e), "undefined" !== e && null != e)
                        switch (e.data.RemoveUnplayedTicketStatusResult) {
                        case 1:
                            var t = e.data.TicketsRemoved,
                                i = "{number_of_tickets} removed from the basket.";
                            1 == t ? i = i.replace("{number_of_tickets}", t + " ticket") : t > 1 && (i = i.replace("{number_of_tickets}", t + " tickets")), $.Notify({
                                message: i,
                                etype: "info"
                            }), angular.element(document.getElementById("cartId")).scope().FetchCartData(!0);
                            try {
                                angular.element(document.getElementById("our-cars-controller-container")).scope().showKioskPopupConfirmation()
                            } catch (a) {}
                            break;
                        case 2:
                        }
                }, function(e) {
                    $.Notify({
                        message: 'We have been unable to remove ticket from your basket, please try again or <a href="/contact-us">get in touch.</a>',
                        etype: "error"
                    })
                })
            })
        }
    }
}]).factory("CashPrizeRepository", ["$http", "RequestsErrorHandler", function(e, t) {
    return {
        prizeSearch: function(t, i, a) {
            e.get("/umbraco/api/cashcomp/prizesearch", {
                params: {
                    sortOrder: t,
                    quantityOfResults: i
                }
            }).success(function(e) {
                a(e)
            })
        }
    }
}]).factory("LifestylePrizeRepository", ["$http", "RequestsErrorHandler", function(e, t) {
    return {
        prizeSearch: function(t, i, a, o) {
            e.get("/umbraco/api/lifestylecomp/prizesearch", {
                params: {
                    prizeCategory: t,
                    sortOrder: i,
                    quantityOfResults: a
                }
            }).success(function(e) {
                o(e)
            })
        },
        registerVote: function(i, a) {
            t.specificallyHandled(function() {
                e.post("/umbraco/api/lifestylecomp/registervote?prizeTitle=" + encodeURIComponent(i), {}, {
                    headers: {
                        "Content-Type": "multipart/form-data"
                    }
                }).then(function(e) {
                    a(e)
                }, function(e) {
                    console.log(e), $.Notify({
                        message: 'an error occurred while registering your vote, please try again or <a href="/contact-us">get in touch.</a>',
                        etype: "error"
                    })
                })
            })
        }
    }
}]).factory("UsersRepository", ["$http", "RequestsErrorHandler", function(e, t) {
    return {
        addFavourite: function(t, i) {
            e.get("/umbraco/botb/users/addfavourite", {
                params: {
                    contentNodeId: t
                }
            }).success(function(e) {
                i(e)
            })
        },
        removeFavourite: function(t, i) {
            e.get("/umbraco/botb/users/removefavourite", {
                params: {
                    contentNodeId: t
                }
            }).success(function(e) {
                i(e)
            })
        }
    }
}]).factory("CartRepository", ["$http", "RequestsErrorHandler", function(e, t) {
    return {
        addPromotion: function(t, i) {
            e({
                method: "GET",
                url: "/umbraco/botb/cart/AddProduct?competitionId=" + competitionId + "&sku=" + t
            }).success(function(e) {
                i(e)
            })
        },
        removePromotion: function(t, i) {
            e({
                method: "GET",
                url: "/umbraco/botb/cart/RemoveProduct?competitionId=" + competitionId + "&sku=" + t
            }).success(function(e) {
                i(e)
            })
        },
        getCart: function(t) {
            e({
                method: "GET",
                url: "/umbraco/botb/cart/CartGet?validateCart=true"
            }).success(function(e) {
                t(e)
            })
        }
    }
}]).factory("OrderRepository", ["$http", "RequestsErrorHandler", function(e, t) {
    return {
        getLastOrder: function(t, i) {
            e({
                method: "GET",
                url: "/umbraco/botb/order/GetLastOrder?longOrderId=" + t
            }).success(function(e) {
                i(e)
            })
        }
    }
}]), botb.app.directive("carRepeatDirective", function() {
    return function(e, t, i) {
        e.$last && plugins.carsCarousel(t.parent())
    }
}), botb.app.directive("onFinishRender", function() {
    return {
        restrict: "A",
        link: function(e, t, i) {
            e.$emit(i.onFinishRender)
        }
    }
}), botb.app.directive("showTickets", function() {
    return {
        restrict: "A",
        link: function(e, t, i) {
            var a = i.evetName || "click";
            t.on(a, function() {
                var e = $(t),
                    i = e.parents("h4"),
                    a = i.find(".ticket-slider");
                e.hasClass("active") ? (e.removeClass("active"), a.slideUp(200, "easeInOutExpo")) : (e.addClass("active"), a.slideDown(200, "easeInOutExpo"))
            })
        }
    }
}), botb.app.directive("tooltip", function() {
    return {
        restrict: "C",
        link: function(e, t, i) {
            t.tooltipster({
                content: t.attr("title"),
                multiple: !1,
                position: "bottom",
                delay: 0
            }), t.bind("mouseenter", function(e) {
                t.tooltipster("show")
            }).bind("mouseleave", function(e) {
                hideTooltipster(t)
            })
        }
    }
}), botb.app.directive("selectTicket", function() {
    return {
        restrict: "A",
        link: function(e, t, i) {
            var a = i.evetName || "click";
            t.on(a, function() {
                var e = $(t),
                    i = e.parents(".ticket-slider"),
                    a = i.find("a");
                a.removeClass("active"), e.addClass("active")
            })
        }
    }
}), botb.app.directive("toggleFavourite", ["UsersRepository", function(e) {
    return {
        restrict: "A",
        link: function(t, i, a) {
            var o = a.evetName || "click";
            i.on(o, function() {
                $(i);
                t.prize.UserFavourite ? e.removeFavourite(t.prize.ContentNodeId, function(e) {
                    e && (t.prize.UserFavourite = !1)
                }) : e.addFavourite(t.prize.ContentNodeId, function(e) {
                    e && (e.Result && (t.prize.UserFavourite = !0), void 0 != e.Message && $.Notify({
                        message: e.Message,
                        etype: "error"
                    }))
                })
            })
        }
    }
}]), botb.app.directive("timelineBlock", function() {
    return {
        restrict: "A",
        link: function(e, t, i) {
            t.ready(function() {
                $(this).find(".cd-timeline-img, .cd-timeline-content").removeClass("is-hidden").addClass("bounce-in")
            })
        }
    }
}), botb.app.directive("regexinput", function() {
    return {
        restrict: "A",
        scope: {},
        replace: !1,
        link: function(e, t, i, a) {
            t.bind("keyup paste change", function(e) {
                var t = new RegExp(i.regexinput),
                    a = $(this).val(),
                    o = a.replace(t, "");
                a !== o && $(this).val(o)
            }), t.bind("keypress", function(e) {
                var t = new RegExp(i.regexinput),
                    a = String.fromCharCode(e.charCode ? e.charCode : e.which);
                if (t.test(a))
                    return e.preventDefault(), !1
            })
        }
    }
});

